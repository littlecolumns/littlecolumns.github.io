<!doctype html>
<html lang="en-US">

<head>
  <meta charset="utf-8">
  <title>NYT Takata (Decision Tree) (Completed)</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" rel="stylesheet">
  <!-- <link href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Raleway:400,700|Open+Sans:400,700&display=swap" rel="stylesheet"> -->
  <link rel="stylesheet" href="/ds4j/css/spectre.min.css">
  <link rel="stylesheet" href="/ds4j/css/spectre-exp.min.css">
  <link rel="stylesheet" href="/ds4j/css/spectre-icons.min.css">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="/ds4j/css/style.css" rel="stylesheet">
  <link href="/ds4j/css/highlight.css" rel="stylesheet">
</head>

<body>
  <div class="nav-holder bg-secondary">
  <div class='content'>
    <header class="navbar">
      <section class="navbar-section">
        <a href="/ds4j/" class="navbar-brand mr-2">DS4J</a>
      </section>
      <section class="navbar-section">
        <a href="/ds4j/projects" class="btn btn-link">Projects</a>
        <a href="/ds4j/topics" class="btn btn-link">Topics</a>
        <a href="/ds4j/curriculum" class="btn btn-link">Curriculum</a>
        <a href="/ds4j/about" class="btn btn-link">About</a>
      </section>
    </header>
  </div>
</div>
  
<div class="content text-based">
  <div class="columns">
    <div class="column col-12 notebook">
      <ul class="breadcrumb">
        <li class="breadcrumb-item">
          <a href="#">Projects</a>
        </li>
        <li class="breadcrumb-item">
          <a href="/ds4j/nyt-takata-airbags/">Searching for faulty airbags in vehicle complaints</a>
        </li>
        <li class="breadcrumb-item">
          <a href="/ds4j/nyt-takata-airbags/nyt-takata-decision-tree-completed">NYT Takata (Decision Tree) (Completed)</a>
        </li>
      </ul>

      <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Faulty-Takata-Airbags-using-Decision-Trees">Faulty Takata Airbags using Decision Trees<a class="anchor-link" href="#Faulty-Takata-Airbags-using-Decision-Trees">#</a></h1><p><strong>The story:</strong></p>
<ul>
<li><a href="https://www.nytimes.com/2014/09/12/business/air-bag-flaw-long-known-led-to-recalls.html">https://www.nytimes.com/2014/09/12/business/air-bag-flaw-long-known-led-to-recalls.html</a></li>
<li><a href="https://www.nytimes.com/2014/11/07/business/airbag-maker-takata-is-said-to-have-conducted-secret-tests.html">https://www.nytimes.com/2014/11/07/business/airbag-maker-takata-is-said-to-have-conducted-secret-tests.html</a></li>
<li><a href="https://www.nytimes.com/interactive/2015/06/22/business/international/takata-airbag-recall-list.html">https://www.nytimes.com/interactive/2015/06/22/business/international/takata-airbag-recall-list.html</a></li>
<li><a href="https://www.nytimes.com/2016/08/27/business/takata-airbag-recall-crisis.html">https://www.nytimes.com/2016/08/27/business/takata-airbag-recall-crisis.html</a></li>
</ul>
<p>This story, done by The New York Times, investigates the content in complaints made to National Highway Traffic Safety Administration (NHTSA) by customers who had bad experiences with Takata airbags in their cars. Eventually, car companies had to recall airbags made by the airbag supplier that promised a cheaper alternative.</p>
<p><strong>Author:</strong> Daeil Kim did a more complex version of this particular analysis - <a href="https://www.slideshare.net/mortardata/daeil-kim-at-the-nyc-data-science-meetup">presentation here</a></p>
<p><strong>Topics:</strong> Decision Trees, Random Forests</p>
<p><strong>Datasets</strong></p>
<ul>
<li><strong>sampled-labeled.csv:</strong> a sample of vehicle complaints, labeled with being suspicious or not</li>
</ul>
<h2 id="What's-the-goal?">What's the goal?<a class="anchor-link" href="#What's-the-goal?">#</a></h2><p>It was too much work to read twenty years of vehicle comments to find the ones related to dangerous airbags! Because we're lazy, we wanted the computer to do this for us. We did this before with a classifier that used logistic regression, now we're going to try a different one.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="reading-options">
  <a class="btn" href="/ds4j/nyt-takata-airbags/nyt-takata-decision-tree-completed">
    <i class="fa fa-sm fa-book"></i>
    Read online
  </a>
  <a class="btn" href="/ds4j/nyt-takata-airbags/notebooks/NYT Takata (Decision Tree) (Completed).ipynb">
    <i class="fa fa-sm fa-download"></i>
    Download notebook
  </a>
  <a class="btn" href="#">
    <i class="fa fa-sm fa-laptop"></i>
    Interactive version
  </a>
</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Our-code">Our code<a class="anchor-link" href="#Our-code">#</a></h1><h2 id="Setup">Setup<a class="anchor-link" href="#Setup">#</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Allow us to display 100 columns at a time, and 100 characters in each column (instead of ...)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_columns&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_colwidth&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Read-in-our-labeled-data">Read in our labeled data<a class="anchor-link" href="#Read-in-our-labeled-data">#</a></h2><p>We aren't going to be using the unlabeled dataset this time, we're only going to look at <strong>how our classifier works.</strong> We'll start by reading in our complaints that have labeled attached to them.</p>
<p><strong>Read in <code>sampled-labeled.csv</code> and check how many suspicious/not suspicious complaints we have.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">labeled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/sampled-labeled.csv&quot;</span><span class="p">)</span>
<span class="n">labeled</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>is_suspicious</th>
      <th>CDESCR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>ALTHOUGH I LOVED THE CAR OVERALL AT THE TIME I DECIDED TO OWN, , MY DREAM CAR CADILLAC CTS HAS T...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>CONSUMER SHUT SLIDING DOOR WHEN ALL POWER LOCKS ON ALL DOORS LOCKED BY ITSELF, TRAPPING INFANT I...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>DRIVERS SEAT BACK COLLAPSED AND BENT WHEN REAR ENDED. PLEASE DESCRIBE DETAILS.  TT</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>TL* THE CONTACT OWNS A 2009 NISSAN ALTIMA. THE CONTACT STATED THAT THE START BUTTON FOR THE IGNI...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>THE FRONT MIDDLE SEAT DOESN'T LOCK IN PLACE.  *AK</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">labeled</span><span class="o">.</span><span class="n">is_suspicious</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.0    150
1.0     15
Name: is_suspicious, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>150 non-suspicious and 15 suspicious is a pretty terrible ratio, but we're remarkably lazy and not very many of the comments are actually suspicious.</p>
<p>Now that we've read a few, let's train our classifier</p>
<h2 id="Creating-features">Creating features<a class="anchor-link" href="#Creating-features">#</a></h2><h3 id="Selecting-our-features-and-building-a-features-dataframe">Selecting our features and building a features dataframe<a class="anchor-link" href="#Selecting-our-features-and-building-a-features-dataframe">#</a></h3><p>Last time, we can thought of some words or phrases that might make a comment interesting or not interesting. We came up with this list:</p>
<ul>
<li>airbag</li>
<li>air bag</li>
<li>failed</li>
<li>did not deploy</li>
<li>violent</li>
<li>explode</li>
<li>shrapnel</li>
</ul>
<p>These <strong>features</strong> are the things that the machine learning algorithm is going to look for when it's reading. There are lots of words in each complaint, but these are the only ones we'll tell the classifier to pay attention to!</p>
<p>To determine if a word is in <code>CDESCR</code>, we can use <code>.str.contains</code>. Because computers only like numbers, though, we need to use <code>.astype(int)</code> to change it from <code>True</code>/<code>False</code> to <code>1</code>/<code>0</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;is_suspicious&#39;</span><span class="p">:</span> <span class="n">labeled</span><span class="o">.</span><span class="n">is_suspicious</span><span class="p">,</span>
    <span class="s1">&#39;airbag&#39;</span><span class="p">:</span> <span class="n">labeled</span><span class="o">.</span><span class="n">CDESCR</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;AIRBAG&quot;</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span>
    <span class="s1">&#39;air bag&#39;</span><span class="p">:</span> <span class="n">labeled</span><span class="o">.</span><span class="n">CDESCR</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;AIR BAG&quot;</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span>
    <span class="s1">&#39;failed&#39;</span><span class="p">:</span> <span class="n">labeled</span><span class="o">.</span><span class="n">CDESCR</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;FAILED&quot;</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span>
    <span class="s1">&#39;did not deploy&#39;</span><span class="p">:</span> <span class="n">labeled</span><span class="o">.</span><span class="n">CDESCR</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;DID NOT DEPLOY&quot;</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span>
    <span class="s1">&#39;violent&#39;</span><span class="p">:</span> <span class="n">labeled</span><span class="o">.</span><span class="n">CDESCR</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;VIOLENT&quot;</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span>
    <span class="s1">&#39;explode&#39;</span><span class="p">:</span> <span class="n">labeled</span><span class="o">.</span><span class="n">CDESCR</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;EXPLODE&quot;</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span>
    <span class="s1">&#39;shrapnel&#39;</span><span class="p">:</span> <span class="n">labeled</span><span class="o">.</span><span class="n">CDESCR</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;SHRAPNEL&quot;</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span>
<span class="p">})</span>
<span class="n">train_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>is_suspicious</th>
      <th>airbag</th>
      <th>air bag</th>
      <th>failed</th>
      <th>did not deploy</th>
      <th>violent</th>
      <th>explode</th>
      <th>shrapnel</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's see how big our dataset is, and then remove any rows that are missing data (not all of them are labeled).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(350, 8)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_df</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">train_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(165, 8)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Creating-our-classifier">Creating our classifier<a class="anchor-link" href="#Creating-our-classifier">#</a></h2><p>Any time you're bulding a classifier, doing regression, or most anything with machine learning, you're using a <strong>model</strong>. It <strong>models</strong> the relationship between the inputs and the outputs.</p>
<h3 id="Classification-with-Decision-Trees">Classification with Decision Trees<a class="anchor-link" href="#Classification-with-Decision-Trees">#</a></h3><p>Last time we used a classifier based on <strong>Logistic Regression</strong>. First we split into <code>X</code> (our features) and <code>y</code> (our labels), and trained the classifier on them.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;is_suspicious&#39;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">is_suspicious</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mf">1e9</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;lbfgs&#39;</span><span class="p">)</span>

<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>LogisticRegression(C=1000000000.0, class_weight=None, dual=False,
                   fit_intercept=True, intercept_scaling=1, l1_ratio=None,
                   max_iter=100, multi_class=&#39;warn&#39;, n_jobs=None, penalty=&#39;l2&#39;,
                   random_state=None, solver=&#39;lbfgs&#39;, tol=0.0001, verbose=0,
                   warm_start=False)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>After we built our classifier, we tested it and found it didn't work very well.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>

<span class="n">y_true</span> <span class="o">=</span> <span class="n">y</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">label_names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;not suspicious&#39;</span><span class="p">,</span> <span class="s1">&#39;suspicious&#39;</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span>
     <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Predicted &#39;</span> <span class="o">+</span> <span class="n">label_names</span><span class="p">,</span>
     <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Is &#39;</span> <span class="o">+</span> <span class="n">label_names</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Predicted not suspicious</th>
      <th>Predicted suspicious</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Is not suspicious</th>
      <td>150</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Is suspicious</th>
      <td>13</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To understand a logisic regression classifier, we looked at the coefficients and the odds ratios.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">feature_names</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">coefficients</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;feature&#39;</span><span class="p">:</span> <span class="n">feature_names</span><span class="p">,</span>
    <span class="s1">&#39;coefficient (log odds ratio)&#39;</span><span class="p">:</span> <span class="n">coefficients</span><span class="p">,</span>
    <span class="s1">&#39;odds ratio&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">coefficients</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;odds ratio&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature</th>
      <th>coefficient (log odds ratio)</th>
      <th>odds ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>violent</td>
      <td>41.423096</td>
      <td>9.768364e+17</td>
    </tr>
    <tr>
      <th>5</th>
      <td>explode</td>
      <td>1.269048</td>
      <td>3.557500e+00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>air bag</td>
      <td>1.268123</td>
      <td>3.554200e+00</td>
    </tr>
    <tr>
      <th>0</th>
      <td>airbag</td>
      <td>0.945612</td>
      <td>2.574400e+00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>failed</td>
      <td>-27.175214</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>did not deploy</td>
      <td>-37.906428</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>6</th>
      <td>shrapnel</td>
      <td>-13.204894</td>
      <td>0.000000e+00</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Classification-with-Decision-Trees">Classification with Decision Trees<a class="anchor-link" href="#Classification-with-Decision-Trees">#</a></h3><p>We can also use a classifier called a <strong>decision tree</strong>. All you need to do is have one new import and change the line where you create your classifier.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#from sklearn.linear_model import LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;is_suspicious&#39;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">is_suspicious</span>

<span class="c1">#clf = LogisticRegression(C=1e9, solver=&#39;lbfgs&#39;)</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">()</span>

<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>DecisionTreeClassifier(class_weight=None, criterion=&#39;gini&#39;, max_depth=None,
                       max_features=None, max_leaf_nodes=None,
                       min_impurity_decrease=0.0, min_impurity_split=None,
                       min_samples_leaf=1, min_samples_split=2,
                       min_weight_fraction_leaf=0.0, presort=False,
                       random_state=None, splitter=&#39;best&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Confusion matrix code looks exactly the same.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>

<span class="n">y_true</span> <span class="o">=</span> <span class="n">y</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">label_names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;not suspicious&#39;</span><span class="p">,</span> <span class="s1">&#39;suspicious&#39;</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span>
     <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Predicted &#39;</span> <span class="o">+</span> <span class="n">label_names</span><span class="p">,</span>
     <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Is &#39;</span> <span class="o">+</span> <span class="n">label_names</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Predicted not suspicious</th>
      <th>Predicted suspicious</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Is not suspicious</th>
      <td>150</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Is suspicious</th>
      <td>13</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When using a decision tree, <strong>using the classifier is the same, but the code to understand the classifier is a bit different.</strong> Instead of coefficients, we're going to look at <strong>feature importance.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">feature_names</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">importances</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">feature_importances_</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;feature&#39;</span><span class="p">:</span> <span class="n">feature_names</span><span class="p">,</span>
    <span class="s1">&#39;feature importance&#39;</span><span class="p">:</span> <span class="n">importances</span><span class="p">,</span>
<span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;feature importance&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature</th>
      <th>feature importance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>airbag</td>
      <td>0.343968</td>
    </tr>
    <tr>
      <th>4</th>
      <td>violent</td>
      <td>0.202552</td>
    </tr>
    <tr>
      <th>1</th>
      <td>air bag</td>
      <td>0.152875</td>
    </tr>
    <tr>
      <th>5</th>
      <td>explode</td>
      <td>0.144037</td>
    </tr>
    <tr>
      <th>3</th>
      <td>did not deploy</td>
      <td>0.120469</td>
    </tr>
    <tr>
      <th>2</th>
      <td>failed</td>
      <td>0.026592</td>
    </tr>
    <tr>
      <th>6</th>
      <td>shrapnel</td>
      <td>0.009506</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The most fun part of using a decision tree is <strong>visualizing it.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">graphviz</span>

<span class="n">label_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;not suspicious&#39;</span><span class="p">,</span> <span class="s1">&#39;suspicious&#39;</span><span class="p">]</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>

<span class="n">dot_data</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">export_graphviz</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span>
                    <span class="n">feature_names</span><span class="o">=</span><span class="n">feature_names</span><span class="p">,</span>  
                    <span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">class_names</span><span class="o">=</span><span class="n">label_names</span><span class="p">)</span>  
<span class="n">graph</span> <span class="o">=</span> <span class="n">graphviz</span><span class="o">.</span><span class="n">Source</span><span class="p">(</span><span class="n">dot_data</span><span class="p">)</span>  
<span class="n">graph</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Tree Pages: 1 -->
<svg width="770pt" height="870pt"
 viewBox="0.00 0.00 769.84 870.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 866)">
<title>Tree</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-866 765.8369,-866 765.8369,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<polygon fill="#e88e4d" stroke="#000000" points="599.7555,-862 462.0814,-862 462.0814,-784 599.7555,-784 599.7555,-862"/>
<text text-anchor="middle" x="530.9185" y="-846.8" font-family="Times,serif" font-size="14.00" fill="#000000">violent &lt;= 0.5</text>
<text text-anchor="middle" x="530.9185" y="-832.8" font-family="Times,serif" font-size="14.00" fill="#000000">gini = 0.165</text>
<text text-anchor="middle" x="530.9185" y="-818.8" font-family="Times,serif" font-size="14.00" fill="#000000">samples = 165</text>
<text text-anchor="middle" x="530.9185" y="-804.8" font-family="Times,serif" font-size="14.00" fill="#000000">value = [150, 15]</text>
<text text-anchor="middle" x="530.9185" y="-790.8" font-family="Times,serif" font-size="14.00" fill="#000000">class = not suspicious</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<polygon fill="#e78d4b" stroke="#000000" points="527.7555,-748 390.0814,-748 390.0814,-670 527.7555,-670 527.7555,-748"/>
<text text-anchor="middle" x="458.9185" y="-732.8" font-family="Times,serif" font-size="14.00" fill="#000000">did not deploy &lt;= 0.5</text>
<text text-anchor="middle" x="458.9185" y="-718.8" font-family="Times,serif" font-size="14.00" fill="#000000">gini = 0.156</text>
<text text-anchor="middle" x="458.9185" y="-704.8" font-family="Times,serif" font-size="14.00" fill="#000000">samples = 164</text>
<text text-anchor="middle" x="458.9185" y="-690.8" font-family="Times,serif" font-size="14.00" fill="#000000">value = [150, 14]</text>
<text text-anchor="middle" x="458.9185" y="-676.8" font-family="Times,serif" font-size="14.00" fill="#000000">class = not suspicious</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0&#45;&gt;1</title>
<path fill="none" stroke="#000000" d="M506.1401,-783.7677C500.6531,-775.0798 494.7796,-765.7801 489.1041,-756.794"/>
<polygon fill="#000000" stroke="#000000" points="492.0416,-754.8906 483.7424,-748.3046 486.1232,-758.6285 492.0416,-754.8906"/>
<text text-anchor="middle" x="478.2359" y="-768.4907" font-family="Times,serif" font-size="14.00" fill="#000000">True</text>
</g>
<!-- 20 -->
<g id="node21" class="node">
<title>20</title>
<polygon fill="#399de5" stroke="#000000" points="662.3666,-741 545.4703,-741 545.4703,-677 662.3666,-677 662.3666,-741"/>
<text text-anchor="middle" x="603.9185" y="-725.8" font-family="Times,serif" font-size="14.00" fill="#000000">gini = 0.0</text>
<text text-anchor="middle" x="603.9185" y="-711.8" font-family="Times,serif" font-size="14.00" fill="#000000">samples = 1</text>
<text text-anchor="middle" x="603.9185" y="-697.8" font-family="Times,serif" font-size="14.00" fill="#000000">value = [0, 1]</text>
<text text-anchor="middle" x="603.9185" y="-683.8" font-family="Times,serif" font-size="14.00" fill="#000000">class = suspicious</text>
</g>
<!-- 0&#45;&gt;20 -->
<g id="edge20" class="edge">
<title>0&#45;&gt;20</title>
<path fill="none" stroke="#000000" d="M556.0409,-783.7677C563.0702,-772.7904 570.7251,-760.8362 577.8101,-749.772"/>
<polygon fill="#000000" stroke="#000000" points="580.9019,-751.434 583.3471,-741.1252 575.0069,-747.6591 580.9019,-751.434"/>
<text text-anchor="middle" x="588.7012" y="-761.3451" font-family="Times,serif" font-size="14.00" fill="#000000">False</text>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<polygon fill="#e99254" stroke="#000000" points="449.7555,-634 312.0814,-634 312.0814,-556 449.7555,-556 449.7555,-634"/>
<text text-anchor="middle" x="380.9185" y="-618.8" font-family="Times,serif" font-size="14.00" fill="#000000">air bag &lt;= 0.5</text>
<text text-anchor="middle" x="380.9185" y="-604.8" font-family="Times,serif" font-size="14.00" fill="#000000">gini = 0.212</text>
<text text-anchor="middle" x="380.9185" y="-590.8" font-family="Times,serif" font-size="14.00" fill="#000000">samples = 116</text>
<text text-anchor="middle" x="380.9185" y="-576.8" font-family="Times,serif" font-size="14.00" fill="#000000">value = [102, 14]</text>
<text text-anchor="middle" x="380.9185" y="-562.8" font-family="Times,serif" font-size="14.00" fill="#000000">class = not suspicious</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1&#45;&gt;2</title>
<path fill="none" stroke="#000000" d="M432.0753,-669.7677C426.131,-661.0798 419.768,-651.7801 413.6196,-642.794"/>
<polygon fill="#000000" stroke="#000000" points="416.3466,-640.5813 407.8111,-634.3046 410.5694,-644.5341 416.3466,-640.5813"/>
</g>
<!-- 19 -->
<g id="node20" class="node">
<title>19</title>
<polygon fill="#e58139" stroke="#000000" points="605.7555,-627 468.0814,-627 468.0814,-563 605.7555,-563 605.7555,-627"/>
<text text-anchor="middle" x="536.9185" y="-611.8" font-family="Times,serif" font-size="14.00" fill="#000000">gini = 0.0</text>
<text text-anchor="middle" x="536.9185" y="-597.8" font-family="Times,serif" font-size="14.00" fill="#000000">samples = 48</text>
<text text-anchor="middle" x="536.9185" y="-583.8" font-family="Times,serif" font-size="14.00" fill="#000000">value = [48, 0]</text>
<text text-anchor="middle" x="536.9185" y="-569.8" font-family="Times,serif" font-size="14.00" fill="#000000">class = not suspicious</text>
</g>
<!-- 1&#45;&gt;19 -->
<g id="edge19" class="edge">
<title>1&#45;&gt;19</title>
<path fill="none" stroke="#000000" d="M485.7616,-669.7677C493.3468,-658.6817 501.6136,-646.5994 509.2465,-635.4436"/>
<polygon fill="#000000" stroke="#000000" points="512.1798,-637.3547 514.9381,-627.1252 506.4026,-633.4019 512.1798,-637.3547"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<polygon fill="#e78d4b" stroke="#000000" points="371.7555,-520 234.0814,-520 234.0814,-442 371.7555,-442 371.7555,-520"/>
<text text-anchor="middle" x="302.9185" y="-504.8" font-family="Times,serif" font-size="14.00" fill="#000000">airbag &lt;= 0.5</text>
<text text-anchor="middle" x="302.9185" y="-490.8" font-family="Times,serif" font-size="14.00" fill="#000000">gini = 0.156</text>
<text text-anchor="middle" x="302.9185" y="-476.8" font-family="Times,serif" font-size="14.00" fill="#000000">samples = 94</text>
<text text-anchor="middle" x="302.9185" y="-462.8" font-family="Times,serif" font-size="14.00" fill="#000000">value = [86, 8]</text>
<text text-anchor="middle" x="302.9185" y="-448.8" font-family="Times,serif" font-size="14.00" fill="#000000">class = not suspicious</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2&#45;&gt;3</title>
<path fill="none" stroke="#000000" d="M354.0753,-555.7677C348.131,-547.0798 341.768,-537.7801 335.6196,-528.794"/>
<polygon fill="#000000" stroke="#000000" points="338.3466,-526.5813 329.8111,-520.3046 332.5694,-530.5341 338.3466,-526.5813"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<polygon fill="#efb083" stroke="#000000" points="527.7555,-520 390.0814,-520 390.0814,-442 527.7555,-442 527.7555,-520"/>
<text text-anchor="middle" x="458.9185" y="-504.8" font-family="Times,serif" font-size="14.00" fill="#000000">explode &lt;= 0.5</text>
<text text-anchor="middle" x="458.9185" y="-490.8" font-family="Times,serif" font-size="14.00" fill="#000000">gini = 0.397</text>
<text text-anchor="middle" x="458.9185" y="-476.8" font-family="Times,serif" font-size="14.00" fill="#000000">samples = 22</text>
<text text-anchor="middle" x="458.9185" y="-462.8" font-family="Times,serif" font-size="14.00" fill="#000000">value = [16, 6]</text>
<text text-anchor="middle" x="458.9185" y="-448.8" font-family="Times,serif" font-size="14.00" fill="#000000">class = not suspicious</text>
</g>
<!-- 2&#45;&gt;12 -->
<g id="edge12" class="edge">
<title>2&#45;&gt;12</title>
<path fill="none" stroke="#000000" d="M407.7616,-555.7677C413.7059,-547.0798 420.0689,-537.7801 426.2173,-528.794"/>
<polygon fill="#000000" stroke="#000000" points="429.2675,-530.5341 432.0258,-520.3046 423.4903,-526.5813 429.2675,-530.5341"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<polygon fill="#e58139" stroke="#000000" points="215.7555,-399 78.0814,-399 78.0814,-335 215.7555,-335 215.7555,-399"/>
<text text-anchor="middle" x="146.9185" y="-383.8" font-family="Times,serif" font-size="14.00" fill="#000000">gini = 0.0</text>
<text text-anchor="middle" x="146.9185" y="-369.8" font-family="Times,serif" font-size="14.00" fill="#000000">samples = 49</text>
<text text-anchor="middle" x="146.9185" y="-355.8" font-family="Times,serif" font-size="14.00" fill="#000000">value = [49, 0]</text>
<text text-anchor="middle" x="146.9185" y="-341.8" font-family="Times,serif" font-size="14.00" fill="#000000">class = not suspicious</text>
</g>
<!-- 3&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>3&#45;&gt;4</title>
<path fill="none" stroke="#000000" d="M249.2321,-441.7677C233.0207,-429.9209 215.2525,-416.9364 199.1382,-405.1606"/>
<polygon fill="#000000" stroke="#000000" points="201.0183,-402.1995 190.8793,-399.1252 196.8881,-407.8513 201.0183,-402.1995"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<polygon fill="#eb9c64" stroke="#000000" points="371.7555,-406 234.0814,-406 234.0814,-328 371.7555,-328 371.7555,-406"/>
<text text-anchor="middle" x="302.9185" y="-390.8" font-family="Times,serif" font-size="14.00" fill="#000000">failed &lt;= 0.5</text>
<text text-anchor="middle" x="302.9185" y="-376.8" font-family="Times,serif" font-size="14.00" fill="#000000">gini = 0.292</text>
<text text-anchor="middle" x="302.9185" y="-362.8" font-family="Times,serif" font-size="14.00" fill="#000000">samples = 45</text>
<text text-anchor="middle" x="302.9185" y="-348.8" font-family="Times,serif" font-size="14.00" fill="#000000">value = [37, 8]</text>
<text text-anchor="middle" x="302.9185" y="-334.8" font-family="Times,serif" font-size="14.00" fill="#000000">class = not suspicious</text>
</g>
<!-- 3&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>3&#45;&gt;5</title>
<path fill="none" stroke="#000000" d="M302.9185,-441.7677C302.9185,-433.6172 302.9185,-424.9283 302.9185,-416.4649"/>
<polygon fill="#000000" stroke="#000000" points="306.4186,-416.3046 302.9185,-406.3046 299.4186,-416.3047 306.4186,-416.3046"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<polygon fill="#eb9f68" stroke="#000000" points="215.7555,-292 78.0814,-292 78.0814,-214 215.7555,-214 215.7555,-292"/>
<text text-anchor="middle" x="146.9185" y="-276.8" font-family="Times,serif" font-size="14.00" fill="#000000">explode &lt;= 0.5</text>
<text text-anchor="middle" x="146.9185" y="-262.8" font-family="Times,serif" font-size="14.00" fill="#000000">gini = 0.308</text>
<text text-anchor="middle" x="146.9185" y="-248.8" font-family="Times,serif" font-size="14.00" fill="#000000">samples = 42</text>
<text text-anchor="middle" x="146.9185" y="-234.8" font-family="Times,serif" font-size="14.00" fill="#000000">value = [34, 8]</text>
<text text-anchor="middle" x="146.9185" y="-220.8" font-family="Times,serif" font-size="14.00" fill="#000000">class = not suspicious</text>
</g>
<!-- 5&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>5&#45;&gt;6</title>
<path fill="none" stroke="#000000" d="M249.2321,-327.7677C236.1674,-318.2204 222.0916,-307.9342 208.6852,-298.1373"/>
<polygon fill="#000000" stroke="#000000" points="210.5784,-295.1858 200.4394,-292.1115 206.4483,-300.8375 210.5784,-295.1858"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<polygon fill="#e58139" stroke="#000000" points="371.7555,-285 234.0814,-285 234.0814,-221 371.7555,-221 371.7555,-285"/>
<text text-anchor="middle" x="302.9185" y="-269.8" font-family="Times,serif" font-size="14.00" fill="#000000">gini = 0.0</text>
<text text-anchor="middle" x="302.9185" y="-255.8" font-family="Times,serif" font-size="14.00" fill="#000000">samples = 3</text>
<text text-anchor="middle" x="302.9185" y="-241.8" font-family="Times,serif" font-size="14.00" fill="#000000">value = [3, 0]</text>
<text text-anchor="middle" x="302.9185" y="-227.8" font-family="Times,serif" font-size="14.00" fill="#000000">class = not suspicious</text>
</g>
<!-- 5&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>5&#45;&gt;11</title>
<path fill="none" stroke="#000000" d="M302.9185,-327.7677C302.9185,-317.3338 302.9185,-306.0174 302.9185,-295.4215"/>
<polygon fill="#000000" stroke="#000000" points="306.4186,-295.1252 302.9185,-285.1252 299.4186,-295.1252 306.4186,-295.1252"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<polygon fill="#eba069" stroke="#000000" points="215.7555,-178 78.0814,-178 78.0814,-100 215.7555,-100 215.7555,-178"/>
<text text-anchor="middle" x="146.9185" y="-162.8" font-family="Times,serif" font-size="14.00" fill="#000000">shrapnel &lt;= 0.5</text>
<text text-anchor="middle" x="146.9185" y="-148.8" font-family="Times,serif" font-size="14.00" fill="#000000">gini = 0.314</text>
<text text-anchor="middle" x="146.9185" y="-134.8" font-family="Times,serif" font-size="14.00" fill="#000000">samples = 41</text>
<text text-anchor="middle" x="146.9185" y="-120.8" font-family="Times,serif" font-size="14.00" fill="#000000">value = [33, 8]</text>
<text text-anchor="middle" x="146.9185" y="-106.8" font-family="Times,serif" font-size="14.00" fill="#000000">class = not suspicious</text>
</g>
<!-- 6&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>6&#45;&gt;7</title>
<path fill="none" stroke="#000000" d="M146.9185,-213.7677C146.9185,-205.6172 146.9185,-196.9283 146.9185,-188.4649"/>
<polygon fill="#000000" stroke="#000000" points="150.4186,-188.3046 146.9185,-178.3046 143.4186,-188.3047 150.4186,-188.3046"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<polygon fill="#e58139" stroke="#000000" points="371.7555,-171 234.0814,-171 234.0814,-107 371.7555,-107 371.7555,-171"/>
<text text-anchor="middle" x="302.9185" y="-155.8" font-family="Times,serif" font-size="14.00" fill="#000000">gini = 0.0</text>
<text text-anchor="middle" x="302.9185" y="-141.8" font-family="Times,serif" font-size="14.00" fill="#000000">samples = 1</text>
<text text-anchor="middle" x="302.9185" y="-127.8" font-family="Times,serif" font-size="14.00" fill="#000000">value = [1, 0]</text>
<text text-anchor="middle" x="302.9185" y="-113.8" font-family="Times,serif" font-size="14.00" fill="#000000">class = not suspicious</text>
</g>
<!-- 6&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>6&#45;&gt;10</title>
<path fill="none" stroke="#000000" d="M200.6048,-213.7677C216.8162,-201.9209 234.5845,-188.9364 250.6987,-177.1606"/>
<polygon fill="#000000" stroke="#000000" points="252.9488,-179.8513 258.9577,-171.1252 248.8187,-174.1995 252.9488,-179.8513"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<polygon fill="#eca06a" stroke="#000000" points="137.7555,-64 .0814,-64 .0814,0 137.7555,0 137.7555,-64"/>
<text text-anchor="middle" x="68.9185" y="-48.8" font-family="Times,serif" font-size="14.00" fill="#000000">gini = 0.32</text>
<text text-anchor="middle" x="68.9185" y="-34.8" font-family="Times,serif" font-size="14.00" fill="#000000">samples = 40</text>
<text text-anchor="middle" x="68.9185" y="-20.8" font-family="Times,serif" font-size="14.00" fill="#000000">value = [32, 8]</text>
<text text-anchor="middle" x="68.9185" y="-6.8" font-family="Times,serif" font-size="14.00" fill="#000000">class = not suspicious</text>
</g>
<!-- 7&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>7&#45;&gt;8</title>
<path fill="none" stroke="#000000" d="M118.317,-99.7647C111.8591,-90.9057 104.9907,-81.4838 98.4936,-72.571"/>
<polygon fill="#000000" stroke="#000000" points="101.1227,-70.236 92.4037,-64.2169 95.4661,-74.3595 101.1227,-70.236"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<polygon fill="#e58139" stroke="#000000" points="293.7555,-64 156.0814,-64 156.0814,0 293.7555,0 293.7555,-64"/>
<text text-anchor="middle" x="224.9185" y="-48.8" font-family="Times,serif" font-size="14.00" fill="#000000">gini = 0.0</text>
<text text-anchor="middle" x="224.9185" y="-34.8" font-family="Times,serif" font-size="14.00" fill="#000000">samples = 1</text>
<text text-anchor="middle" x="224.9185" y="-20.8" font-family="Times,serif" font-size="14.00" fill="#000000">value = [1, 0]</text>
<text text-anchor="middle" x="224.9185" y="-6.8" font-family="Times,serif" font-size="14.00" fill="#000000">class = not suspicious</text>
</g>
<!-- 7&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>7&#45;&gt;9</title>
<path fill="none" stroke="#000000" d="M175.5199,-99.7647C181.9778,-90.9057 188.8462,-81.4838 195.3433,-72.571"/>
<polygon fill="#000000" stroke="#000000" points="198.3708,-74.3595 201.4333,-64.2169 192.7142,-70.236 198.3708,-74.3595"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<polygon fill="#eda877" stroke="#000000" points="527.7555,-406 390.0814,-406 390.0814,-328 527.7555,-328 527.7555,-406"/>
<text text-anchor="middle" x="458.9185" y="-390.8" font-family="Times,serif" font-size="14.00" fill="#000000">airbag &lt;= 0.5</text>
<text text-anchor="middle" x="458.9185" y="-376.8" font-family="Times,serif" font-size="14.00" fill="#000000">gini = 0.363</text>
<text text-anchor="middle" x="458.9185" y="-362.8" font-family="Times,serif" font-size="14.00" fill="#000000">samples = 21</text>
<text text-anchor="middle" x="458.9185" y="-348.8" font-family="Times,serif" font-size="14.00" fill="#000000">value = [16, 5]</text>
<text text-anchor="middle" x="458.9185" y="-334.8" font-family="Times,serif" font-size="14.00" fill="#000000">class = not suspicious</text>
</g>
<!-- 12&#45;&gt;13 -->
<g id="edge13" class="edge">
<title>12&#45;&gt;13</title>
<path fill="none" stroke="#000000" d="M458.9185,-441.7677C458.9185,-433.6172 458.9185,-424.9283 458.9185,-416.4649"/>
<polygon fill="#000000" stroke="#000000" points="462.4186,-416.3046 458.9185,-406.3046 455.4186,-416.3047 462.4186,-416.3046"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<polygon fill="#399de5" stroke="#000000" points="662.3666,-399 545.4703,-399 545.4703,-335 662.3666,-335 662.3666,-399"/>
<text text-anchor="middle" x="603.9185" y="-383.8" font-family="Times,serif" font-size="14.00" fill="#000000">gini = 0.0</text>
<text text-anchor="middle" x="603.9185" y="-369.8" font-family="Times,serif" font-size="14.00" fill="#000000">samples = 1</text>
<text text-anchor="middle" x="603.9185" y="-355.8" font-family="Times,serif" font-size="14.00" fill="#000000">value = [0, 1]</text>
<text text-anchor="middle" x="603.9185" y="-341.8" font-family="Times,serif" font-size="14.00" fill="#000000">class = suspicious</text>
</g>
<!-- 12&#45;&gt;18 -->
<g id="edge18" class="edge">
<title>12&#45;&gt;18</title>
<path fill="none" stroke="#000000" d="M508.8192,-441.7677C523.7493,-430.0296 540.1,-417.1745 554.9683,-405.485"/>
<polygon fill="#000000" stroke="#000000" points="557.3594,-408.0573 563.0575,-399.1252 553.0329,-402.5544 557.3594,-408.0573"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<polygon fill="#fae6d7" stroke="#000000" points="527.7555,-285 390.0814,-285 390.0814,-221 527.7555,-221 527.7555,-285"/>
<text text-anchor="middle" x="458.9185" y="-269.8" font-family="Times,serif" font-size="14.00" fill="#000000">gini = 0.494</text>
<text text-anchor="middle" x="458.9185" y="-255.8" font-family="Times,serif" font-size="14.00" fill="#000000">samples = 9</text>
<text text-anchor="middle" x="458.9185" y="-241.8" font-family="Times,serif" font-size="14.00" fill="#000000">value = [5, 4]</text>
<text text-anchor="middle" x="458.9185" y="-227.8" font-family="Times,serif" font-size="14.00" fill="#000000">class = not suspicious</text>
</g>
<!-- 13&#45;&gt;14 -->
<g id="edge14" class="edge">
<title>13&#45;&gt;14</title>
<path fill="none" stroke="#000000" d="M458.9185,-327.7677C458.9185,-317.3338 458.9185,-306.0174 458.9185,-295.4215"/>
<polygon fill="#000000" stroke="#000000" points="462.4186,-295.1252 458.9185,-285.1252 455.4186,-295.1252 462.4186,-295.1252"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<polygon fill="#e78c4b" stroke="#000000" points="683.7555,-292 546.0814,-292 546.0814,-214 683.7555,-214 683.7555,-292"/>
<text text-anchor="middle" x="614.9185" y="-276.8" font-family="Times,serif" font-size="14.00" fill="#000000">failed &lt;= 0.5</text>
<text text-anchor="middle" x="614.9185" y="-262.8" font-family="Times,serif" font-size="14.00" fill="#000000">gini = 0.153</text>
<text text-anchor="middle" x="614.9185" y="-248.8" font-family="Times,serif" font-size="14.00" fill="#000000">samples = 12</text>
<text text-anchor="middle" x="614.9185" y="-234.8" font-family="Times,serif" font-size="14.00" fill="#000000">value = [11, 1]</text>
<text text-anchor="middle" x="614.9185" y="-220.8" font-family="Times,serif" font-size="14.00" fill="#000000">class = not suspicious</text>
</g>
<!-- 13&#45;&gt;15 -->
<g id="edge15" class="edge">
<title>13&#45;&gt;15</title>
<path fill="none" stroke="#000000" d="M512.6048,-327.7677C525.6695,-318.2204 539.7453,-307.9342 553.1517,-298.1373"/>
<polygon fill="#000000" stroke="#000000" points="555.3887,-300.8375 561.3975,-292.1115 551.2585,-295.1858 555.3887,-300.8375"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<polygon fill="#e88e4d" stroke="#000000" points="605.7555,-171 468.0814,-171 468.0814,-107 605.7555,-107 605.7555,-171"/>
<text text-anchor="middle" x="536.9185" y="-155.8" font-family="Times,serif" font-size="14.00" fill="#000000">gini = 0.165</text>
<text text-anchor="middle" x="536.9185" y="-141.8" font-family="Times,serif" font-size="14.00" fill="#000000">samples = 11</text>
<text text-anchor="middle" x="536.9185" y="-127.8" font-family="Times,serif" font-size="14.00" fill="#000000">value = [10, 1]</text>
<text text-anchor="middle" x="536.9185" y="-113.8" font-family="Times,serif" font-size="14.00" fill="#000000">class = not suspicious</text>
</g>
<!-- 15&#45;&gt;16 -->
<g id="edge16" class="edge">
<title>15&#45;&gt;16</title>
<path fill="none" stroke="#000000" d="M588.0753,-213.7677C580.4901,-202.6817 572.2233,-190.5994 564.5904,-179.4436"/>
<polygon fill="#000000" stroke="#000000" points="567.4343,-177.4019 558.8989,-171.1252 561.6572,-181.3547 567.4343,-177.4019"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<polygon fill="#e58139" stroke="#000000" points="761.7555,-171 624.0814,-171 624.0814,-107 761.7555,-107 761.7555,-171"/>
<text text-anchor="middle" x="692.9185" y="-155.8" font-family="Times,serif" font-size="14.00" fill="#000000">gini = 0.0</text>
<text text-anchor="middle" x="692.9185" y="-141.8" font-family="Times,serif" font-size="14.00" fill="#000000">samples = 1</text>
<text text-anchor="middle" x="692.9185" y="-127.8" font-family="Times,serif" font-size="14.00" fill="#000000">value = [1, 0]</text>
<text text-anchor="middle" x="692.9185" y="-113.8" font-family="Times,serif" font-size="14.00" fill="#000000">class = not suspicious</text>
</g>
<!-- 15&#45;&gt;17 -->
<g id="edge17" class="edge">
<title>15&#45;&gt;17</title>
<path fill="none" stroke="#000000" d="M641.7616,-213.7677C649.3468,-202.6817 657.6136,-190.5994 665.2465,-179.4436"/>
<polygon fill="#000000" stroke="#000000" points="668.1798,-181.3547 670.9381,-171.1252 662.4026,-177.4019 668.1798,-181.3547"/>
</g>
</g>
</svg>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And the best part is: almost everything you can do with a logistic regression classifier you can do with a decision tree. Most of the time you can just <strong>change your classifier to see if it does better.</strong></p>
<p>Decision trees also have a lot of simple options.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;is_suspicious&#39;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">is_suspicious</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>DecisionTreeClassifier(class_weight=None, criterion=&#39;gini&#39;, max_depth=2,
                       max_features=None, max_leaf_nodes=None,
                       min_impurity_decrease=0.0, min_impurity_split=None,
                       min_samples_leaf=1, min_samples_split=2,
                       min_weight_fraction_leaf=0.0, presort=False,
                       random_state=None, splitter=&#39;best&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">graphviz</span>

<span class="n">label_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;not suspicious&#39;</span><span class="p">,</span> <span class="s1">&#39;suspicious&#39;</span><span class="p">]</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>

<span class="n">dot_data</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">export_graphviz</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span>
                    <span class="n">feature_names</span><span class="o">=</span><span class="n">feature_names</span><span class="p">,</span>  
                    <span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">class_names</span><span class="o">=</span><span class="n">label_names</span><span class="p">)</span>  
<span class="n">graph</span> <span class="o">=</span> <span class="n">graphviz</span><span class="o">.</span><span class="n">Source</span><span class="p">(</span><span class="n">dot_data</span><span class="p">)</span>  
<span class="n">graph</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Tree Pages: 1 -->
<svg width="358pt" height="300pt"
 viewBox="0.00 0.00 358.14 300.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 296)">
<title>Tree</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-296 354.1421,-296 354.1421,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<polygon fill="#e88e4d" stroke="#000000" points="287.7555,-292 150.0814,-292 150.0814,-214 287.7555,-214 287.7555,-292"/>
<text text-anchor="middle" x="218.9185" y="-276.8" font-family="Times,serif" font-size="14.00" fill="#000000">violent &lt;= 0.5</text>
<text text-anchor="middle" x="218.9185" y="-262.8" font-family="Times,serif" font-size="14.00" fill="#000000">gini = 0.165</text>
<text text-anchor="middle" x="218.9185" y="-248.8" font-family="Times,serif" font-size="14.00" fill="#000000">samples = 165</text>
<text text-anchor="middle" x="218.9185" y="-234.8" font-family="Times,serif" font-size="14.00" fill="#000000">value = [150, 15]</text>
<text text-anchor="middle" x="218.9185" y="-220.8" font-family="Times,serif" font-size="14.00" fill="#000000">class = not suspicious</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<polygon fill="#e78d4b" stroke="#000000" points="215.7555,-178 78.0814,-178 78.0814,-100 215.7555,-100 215.7555,-178"/>
<text text-anchor="middle" x="146.9185" y="-162.8" font-family="Times,serif" font-size="14.00" fill="#000000">did not deploy &lt;= 0.5</text>
<text text-anchor="middle" x="146.9185" y="-148.8" font-family="Times,serif" font-size="14.00" fill="#000000">gini = 0.156</text>
<text text-anchor="middle" x="146.9185" y="-134.8" font-family="Times,serif" font-size="14.00" fill="#000000">samples = 164</text>
<text text-anchor="middle" x="146.9185" y="-120.8" font-family="Times,serif" font-size="14.00" fill="#000000">value = [150, 14]</text>
<text text-anchor="middle" x="146.9185" y="-106.8" font-family="Times,serif" font-size="14.00" fill="#000000">class = not suspicious</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0&#45;&gt;1</title>
<path fill="none" stroke="#000000" d="M194.1401,-213.7677C188.6531,-205.0798 182.7796,-195.7801 177.1041,-186.794"/>
<polygon fill="#000000" stroke="#000000" points="180.0416,-184.8906 171.7424,-178.3046 174.1232,-188.6285 180.0416,-184.8906"/>
<text text-anchor="middle" x="166.2359" y="-198.4907" font-family="Times,serif" font-size="14.00" fill="#000000">True</text>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<polygon fill="#399de5" stroke="#000000" points="350.3666,-171 233.4703,-171 233.4703,-107 350.3666,-107 350.3666,-171"/>
<text text-anchor="middle" x="291.9185" y="-155.8" font-family="Times,serif" font-size="14.00" fill="#000000">gini = 0.0</text>
<text text-anchor="middle" x="291.9185" y="-141.8" font-family="Times,serif" font-size="14.00" fill="#000000">samples = 1</text>
<text text-anchor="middle" x="291.9185" y="-127.8" font-family="Times,serif" font-size="14.00" fill="#000000">value = [0, 1]</text>
<text text-anchor="middle" x="291.9185" y="-113.8" font-family="Times,serif" font-size="14.00" fill="#000000">class = suspicious</text>
</g>
<!-- 0&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>0&#45;&gt;4</title>
<path fill="none" stroke="#000000" d="M244.0409,-213.7677C251.0702,-202.7904 258.7251,-190.8362 265.8101,-179.772"/>
<polygon fill="#000000" stroke="#000000" points="268.9019,-181.434 271.3471,-171.1252 263.0069,-177.6591 268.9019,-181.434"/>
<text text-anchor="middle" x="276.7012" y="-191.3451" font-family="Times,serif" font-size="14.00" fill="#000000">False</text>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<polygon fill="#e99254" stroke="#000000" points="137.7555,-64 .0814,-64 .0814,0 137.7555,0 137.7555,-64"/>
<text text-anchor="middle" x="68.9185" y="-48.8" font-family="Times,serif" font-size="14.00" fill="#000000">gini = 0.212</text>
<text text-anchor="middle" x="68.9185" y="-34.8" font-family="Times,serif" font-size="14.00" fill="#000000">samples = 116</text>
<text text-anchor="middle" x="68.9185" y="-20.8" font-family="Times,serif" font-size="14.00" fill="#000000">value = [102, 14]</text>
<text text-anchor="middle" x="68.9185" y="-6.8" font-family="Times,serif" font-size="14.00" fill="#000000">class = not suspicious</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1&#45;&gt;2</title>
<path fill="none" stroke="#000000" d="M118.317,-99.7647C111.8591,-90.9057 104.9907,-81.4838 98.4936,-72.571"/>
<polygon fill="#000000" stroke="#000000" points="101.1227,-70.236 92.4037,-64.2169 95.4661,-74.3595 101.1227,-70.236"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<polygon fill="#e58139" stroke="#000000" points="293.7555,-64 156.0814,-64 156.0814,0 293.7555,0 293.7555,-64"/>
<text text-anchor="middle" x="224.9185" y="-48.8" font-family="Times,serif" font-size="14.00" fill="#000000">gini = 0.0</text>
<text text-anchor="middle" x="224.9185" y="-34.8" font-family="Times,serif" font-size="14.00" fill="#000000">samples = 48</text>
<text text-anchor="middle" x="224.9185" y="-20.8" font-family="Times,serif" font-size="14.00" fill="#000000">value = [48, 0]</text>
<text text-anchor="middle" x="224.9185" y="-6.8" font-family="Times,serif" font-size="14.00" fill="#000000">class = not suspicious</text>
</g>
<!-- 1&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>1&#45;&gt;3</title>
<path fill="none" stroke="#000000" d="M175.5199,-99.7647C181.9778,-90.9057 188.8462,-81.4838 195.3433,-72.571"/>
<polygon fill="#000000" stroke="#000000" points="198.3708,-74.3595 201.4333,-64.2169 192.7142,-70.236 198.3708,-74.3595"/>
</g>
</g>
</svg>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="A-random-forest-is-usually-even-better">A random forest is usually even better<a class="anchor-link" href="#A-random-forest-is-usually-even-better">#</a></h3><p>Although in this case our inputs are terrible so it's still not very good. Garbage in, garbage out.</p>
<p>We'l change our classifier to be</p>
<div class="highlight"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
<p>and it will use 100 decision <strong>trees</strong> to make a <strong>forest</strong>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;is_suspicious&#39;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">is_suspicious</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>RandomForestClassifier(bootstrap=True, class_weight=None, criterion=&#39;gini&#39;,
                       max_depth=None, max_features=&#39;auto&#39;, max_leaf_nodes=None,
                       min_impurity_decrease=0.0, min_impurity_split=None,
                       min_samples_leaf=1, min_samples_split=2,
                       min_weight_fraction_leaf=0.0, n_estimators=100,
                       n_jobs=None, oob_score=False, random_state=None,
                       verbose=0, warm_start=False)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>

<span class="n">y_true</span> <span class="o">=</span> <span class="n">y</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">label_names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;not suspicious&#39;</span><span class="p">,</span> <span class="s1">&#39;suspicious&#39;</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span>
     <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Predicted &#39;</span> <span class="o">+</span> <span class="n">label_names</span><span class="p">,</span>
     <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Is &#39;</span> <span class="o">+</span> <span class="n">label_names</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Predicted not suspicious</th>
      <th>Predicted suspicious</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Is not suspicious</th>
      <td>150</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Is suspicious</th>
      <td>13</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">feature_names</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">importances</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">feature_importances_</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;feature&#39;</span><span class="p">:</span> <span class="n">feature_names</span><span class="p">,</span>
    <span class="s1">&#39;feature importance&#39;</span><span class="p">:</span> <span class="n">importances</span><span class="p">,</span>
<span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;feature importance&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature</th>
      <th>feature importance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>did not deploy</td>
      <td>0.253355</td>
    </tr>
    <tr>
      <th>1</th>
      <td>air bag</td>
      <td>0.229982</td>
    </tr>
    <tr>
      <th>0</th>
      <td>airbag</td>
      <td>0.213717</td>
    </tr>
    <tr>
      <th>4</th>
      <td>violent</td>
      <td>0.139143</td>
    </tr>
    <tr>
      <th>5</th>
      <td>explode</td>
      <td>0.124212</td>
    </tr>
    <tr>
      <th>2</th>
      <td>failed</td>
      <td>0.033846</td>
    </tr>
    <tr>
      <th>6</th>
      <td>shrapnel</td>
      <td>0.005744</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Review">Review<a class="anchor-link" href="#Review">#</a></h2><p>In our previous two attempts to tackle Takata airbag investigation, we used a <strong>logistic regression classifier</strong>. This time we're trying a new type called a <strong>random forest</strong>, which performed <em>slightly</em> better (although it could have just been chance).</p>
<p>Despite this slight improvement, its predictions were still very off.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Discussion-topics">Discussion topics<a class="anchor-link" href="#Discussion-topics">#</a></h2><p>What's wrong here? Why does nothing work for us, even though we keep throwing more machine learning tools at it?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
 


    </div>
  </div>
</div>

<script>
  [...document.querySelectorAll(".code_cell")].filter(cell => cell.innerText.trim().length === 0).forEach(cell => cell.remove())
</script>

  <div class="footer bg-secondary">
  <div class="content">
    <div class="columns">
      <div class="column col-6 col-sm-12">
        <p><strong>Hi, welcome to Data Science for Journalism!</strong></p>
        <p>There's been a lot of buzz about machine learning and "artificial intelligence" being used in stories over
          the past few years. It's mostly not that complicated - a little stats, a classifier here or there - but it's
          hard to know where to start without a little help.</p>
        <p>Hopefully this site can be that help! <a href="/ds4j/about">Learn more about this project here.</a></p>
      </div>
      <div class="column col-3 col-sm-6">
        <p><strong>Quick links</strong></p>
        <!-- <p><a href="#">Something here</a></p>
        <p><a href="#">Something here</a></p>
        <p><a href="#">Something here</a></p> -->
      </div>
      <div class="column col-3 col-sm6">
        <p><strong>Contact</strong></p>
        <p><a href="mailto:hello@littlecolumns.com">hello@littlecolumns.com</a></p>
      </div>
    </div>
  </div>
</div>
  <script src="/ds4j/js/tocbot.js"></script>

  <script>
    try {
      let toc = document.createElement("div")
      toc.setAttribute('class', 'js-toc')
      document.querySelector(".reading-options").parentNode.appendChild(toc)
    } catch (err) {

    }

    tocbot.init({
      // Where to render the table of contents.
      tocSelector: '.js-toc',
      // Where to grab the headings to build the table of contents.
      contentSelector: '.notebook',
      // Which headings to grab inside of the contentSelector element.
      headingSelector: 'h1, h2, h3, h4',
      activeLinkClass: 'active',
      listClass: 'nav',
      listItemClass: 'nav-item',
      headingLabelCallback: function (label) {
        return label.replace("#", "")
      }
    });
  </script>

</body>

</html>
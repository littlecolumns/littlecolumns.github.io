<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6.1 Leaving out our best feature | _main.utf8.md</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="6.1 Leaving out our best feature | _main.utf8.md" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.1 Leaving out our best feature | _main.utf8.md" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="feature-selection-and-engineering.html"/>
<link rel="next" href="explaining-predictions.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i><b>2</b> Preface</a><ul>
<li class="chapter" data-level="2.1" data-path="the-original-story.html"><a href="the-original-story.html"><i class="fa fa-check"></i><b>2.1</b> The original story</a></li>
<li class="chapter" data-level="2.2" data-path="what-it-does.html"><a href="what-it-does.html"><i class="fa fa-check"></i><b>2.2</b> What it does</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="our-data.html"><a href="our-data.html"><i class="fa fa-check"></i><b>3</b> Our data</a><ul>
<li class="chapter" data-level="3.1" data-path="data-foia-requests.html"><a href="data-foia-requests.html"><i class="fa fa-check"></i><b>3.1</b> Data: FOIA Requests</a></li>
<li class="chapter" data-level="3.2" data-path="success-metrics-editorial-choice.html"><a href="success-metrics-editorial-choice.html"><i class="fa fa-check"></i><b>3.2</b> Success metrics (editorial choice)</a></li>
<li class="chapter" data-level="3.3" data-path="features-editorial-choice.html"><a href="features-editorial-choice.html"><i class="fa fa-check"></i><b>3.3</b> Features (editorial choice)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="analysis.html"><a href="analysis.html"><i class="fa fa-check"></i><b>4</b> Analysis</a><ul>
<li class="chapter" data-level="4.1" data-path="designing-our-model.html"><a href="designing-our-model.html"><i class="fa fa-check"></i><b>4.1</b> Designing our model</a><ul>
<li class="chapter" data-level="4.1.1" data-path="designing-our-model.html"><a href="designing-our-model.html#classification-problems"><i class="fa fa-check"></i><b>4.1.1</b> Classification problems</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="selecting-an-algorithm.html"><a href="selecting-an-algorithm.html"><i class="fa fa-check"></i><b>4.2</b> Selecting an algorithm</a></li>
<li class="chapter" data-level="4.3" data-path="training-our-algorithm.html"><a href="training-our-algorithm.html"><i class="fa fa-check"></i><b>4.3</b> Training our algorithm</a></li>
<li class="chapter" data-level="4.4" data-path="evaluation-metrics.html"><a href="evaluation-metrics.html"><i class="fa fa-check"></i><b>4.4</b> Evaluation metrics</a><ul>
<li class="chapter" data-level="4.4.1" data-path="evaluation-metrics.html"><a href="evaluation-metrics.html#accuracy"><i class="fa fa-check"></i><b>4.4.1</b> Accuracy</a></li>
<li class="chapter" data-level="4.4.2" data-path="evaluation-metrics.html"><a href="evaluation-metrics.html#dummy-classifier"><i class="fa fa-check"></i><b>4.4.2</b> Dummy classifier</a></li>
<li class="chapter" data-level="4.4.3" data-path="evaluation-metrics.html"><a href="evaluation-metrics.html#confusion-matrix"><i class="fa fa-check"></i><b>4.4.3</b> Confusion matrix</a></li>
<li class="chapter" data-level="4.4.4" data-path="evaluation-metrics.html"><a href="evaluation-metrics.html#explainability"><i class="fa fa-check"></i><b>4.4.4</b> Explainability</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="other-classifiers.html"><a href="other-classifiers.html"><i class="fa fa-check"></i><b>5</b> Other classifiers</a><ul>
<li class="chapter" data-level="5.1" data-path="logisic-regression.html"><a href="logisic-regression.html"><i class="fa fa-check"></i><b>5.1</b> Logisic Regression</a></li>
<li class="chapter" data-level="5.2" data-path="decision-trees.html"><a href="decision-trees.html"><i class="fa fa-check"></i><b>5.2</b> Decision Trees</a></li>
<li class="chapter" data-level="5.3" data-path="random-forest.html"><a href="random-forest.html"><i class="fa fa-check"></i><b>5.3</b> Random Forest</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="feature-selection-and-engineering.html"><a href="feature-selection-and-engineering.html"><i class="fa fa-check"></i><b>6</b> Feature selection and engineering</a><ul>
<li class="chapter" data-level="6.1" data-path="leaving-out-our-best-feature.html"><a href="leaving-out-our-best-feature.html"><i class="fa fa-check"></i><b>6.1</b> Leaving out our best feature</a><ul>
<li class="chapter" data-level="6.1.1" data-path="leaving-out-our-best-feature.html"><a href="leaving-out-our-best-feature.html#setting-up-our-features"><i class="fa fa-check"></i><b>6.1.1</b> Setting up our features</a></li>
<li class="chapter" data-level="6.1.2" data-path="leaving-out-our-best-feature.html"><a href="leaving-out-our-best-feature.html#k-nearest-neighbors"><i class="fa fa-check"></i><b>6.1.2</b> K-nearest neighbors</a></li>
<li class="chapter" data-level="6.1.3" data-path="leaving-out-our-best-feature.html"><a href="leaving-out-our-best-feature.html#logistic-regression"><i class="fa fa-check"></i><b>6.1.3</b> Logistic Regression</a></li>
<li class="chapter" data-level="6.1.4" data-path="leaving-out-our-best-feature.html"><a href="leaving-out-our-best-feature.html#decision-tree"><i class="fa fa-check"></i><b>6.1.4</b> Decision tree</a></li>
<li class="chapter" data-level="6.1.5" data-path="leaving-out-our-best-feature.html"><a href="leaving-out-our-best-feature.html#random-forest-1"><i class="fa fa-check"></i><b>6.1.5</b> Random forest</a></li>
<li class="chapter" data-level="6.1.6" data-path="leaving-out-our-best-feature.html"><a href="leaving-out-our-best-feature.html#summary"><i class="fa fa-check"></i><b>6.1.6</b> Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="explaining-predictions.html"><a href="explaining-predictions.html"><i class="fa fa-check"></i><b>7</b> Explaining predictions</a></li>
<li class="chapter" data-level="8" data-path="percent-probability.html"><a href="percent-probability.html"><i class="fa fa-check"></i><b>8</b> Percent probability</a></li>
<li class="chapter" data-level="9" data-path="review.html"><a href="review.html"><i class="fa fa-check"></i><b>9</b> Review</a></li>
<li class="chapter" data-level="10" data-path="discussion-topics.html"><a href="discussion-topics.html"><i class="fa fa-check"></i><b>10</b> Discussion topics</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="leaving-out-our-best-feature" class="section level2">
<h2><span class="header-section-number">6.1</span> Leaving out our best feature</h2>
<p>Even though <code>high_success_rate_agency</code> is a great feature in terms of predicting success or failure, it’s so powerful that it seems like cheating. We don’t want to hear that we’re being rejected just because we’re sending a FOIA to the CIA - we want to build the best predictor we can!</p>
<p>What happens if we ignore the agency completely? <strong>Let’s remove <code>high_success_rate_agency</code> from our feaure set and see how our classifiers perform.</strong></p>
<blockquote>
<p>We’re saying our current classifiers are useless, but are they really? It’s an open question! Knowing that we can be lazy with our request to the EPA, but need more effort when applying to the CIA might actually be useful.</p>
</blockquote>
<div id="setting-up-our-features" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Setting up our features</h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="leaving-out-our-best-feature.html#cb45-1"></a><span class="co"># Remove high_success_rate_agency</span></span>
<span id="cb45-2"><a href="leaving-out-our-best-feature.html#cb45-2"></a>X <span class="op">=</span> df[[</span>
<span id="cb45-3"><a href="leaving-out-our-best-feature.html#cb45-3"></a>  <span class="st">&#39;word_count&#39;</span>, <span class="st">&#39;avg_sen_len&#39;</span>, </span>
<span id="cb45-4"><a href="leaving-out-our-best-feature.html#cb45-4"></a>  <span class="st">&#39;ref_foia&#39;</span>, <span class="st">&#39;ref_fees&#39;</span>, <span class="st">&#39;hyperlink&#39;</span>, </span>
<span id="cb45-5"><a href="leaving-out-our-best-feature.html#cb45-5"></a>  <span class="st">&#39;email_address&#39;</span>, <span class="st">&#39;specificity&#39;</span></span>
<span id="cb45-6"><a href="leaving-out-our-best-feature.html#cb45-6"></a>]]</span>
<span id="cb45-7"><a href="leaving-out-our-best-feature.html#cb45-7"></a>y <span class="op">=</span> df.successful</span>
<span id="cb45-8"><a href="leaving-out-our-best-feature.html#cb45-8"></a></span>
<span id="cb45-9"><a href="leaving-out-our-best-feature.html#cb45-9"></a><span class="co"># Train/test split</span></span>
<span id="cb45-10"><a href="leaving-out-our-best-feature.html#cb45-10"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y)</span></code></pre></div>
</div>
<div id="k-nearest-neighbors" class="section level3">
<h3><span class="header-section-number">6.1.2</span> K-nearest neighbors</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="leaving-out-our-best-feature.html#cb46-1"></a><span class="co"># Train a knn classifier</span></span>
<span id="cb46-2"><a href="leaving-out-our-best-feature.html#cb46-2"></a>knn <span class="op">=</span> KNeighborsClassifier()</span>
<span id="cb46-3"><a href="leaving-out-our-best-feature.html#cb46-3"></a>knn.fit(X_train, y_train)</span>
<span id="cb46-4"><a href="leaving-out-our-best-feature.html#cb46-4"></a></span>
<span id="cb46-5"><a href="leaving-out-our-best-feature.html#cb46-5"></a><span class="co"># Build a confusion matrix</span></span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="leaving-out-our-best-feature.html#cb47-1"></a>y_true <span class="op">=</span> y_test</span>
<span id="cb47-2"><a href="leaving-out-our-best-feature.html#cb47-2"></a>y_pred <span class="op">=</span> knn.predict(X_test)</span>
<span id="cb47-3"><a href="leaving-out-our-best-feature.html#cb47-3"></a>matrix <span class="op">=</span> confusion_matrix(y_true, y_pred)</span>
<span id="cb47-4"><a href="leaving-out-our-best-feature.html#cb47-4"></a></span>
<span id="cb47-5"><a href="leaving-out-our-best-feature.html#cb47-5"></a>label_names <span class="op">=</span> pd.Series([<span class="st">&#39;unsuccessful&#39;</span>, <span class="st">&#39;successful&#39;</span>])</span>
<span id="cb47-6"><a href="leaving-out-our-best-feature.html#cb47-6"></a>pd.DataFrame(matrix,</span>
<span id="cb47-7"><a href="leaving-out-our-best-feature.html#cb47-7"></a>     columns<span class="op">=</span><span class="st">&#39;Predicted &#39;</span> <span class="op">+</span> label_names,</span>
<span id="cb47-8"><a href="leaving-out-our-best-feature.html#cb47-8"></a>     index<span class="op">=</span><span class="st">&#39;Is &#39;</span> <span class="op">+</span> label_names)</span></code></pre></div>
<div class='table-wrapper'>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Predicted unsuccessful
</th>
<th style="text-align:right;">
Predicted successful
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Is unsuccessful
</td>
<td style="text-align:right;">
1319
</td>
<td style="text-align:right;">
271
</td>
</tr>
<tr>
<td style="text-align:left;">
Is successful
</td>
<td style="text-align:right;">
470
</td>
<td style="text-align:right;">
214
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="logistic-regression" class="section level3">
<h3><span class="header-section-number">6.1.3</span> Logistic Regression</h3>
<div class="sourceCode" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="leaving-out-our-best-feature.html#cb48-1"></a><span class="co"># Train a logistic regression classifier</span></span>
<span id="cb48-2"><a href="leaving-out-our-best-feature.html#cb48-2"></a>logreg <span class="op">=</span> LogisticRegression(C<span class="op">=</span><span class="fl">1e9</span>, solver<span class="op">=</span><span class="st">&#39;lbfgs&#39;</span>, max_iter<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb48-3"><a href="leaving-out-our-best-feature.html#cb48-3"></a>logreg.fit(X_train, y_train)</span>
<span id="cb48-4"><a href="leaving-out-our-best-feature.html#cb48-4"></a></span>
<span id="cb48-5"><a href="leaving-out-our-best-feature.html#cb48-5"></a><span class="co"># Build a confusion matrix</span></span></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="leaving-out-our-best-feature.html#cb49-1"></a>y_true <span class="op">=</span> y_test</span>
<span id="cb49-2"><a href="leaving-out-our-best-feature.html#cb49-2"></a>y_pred <span class="op">=</span> logreg.predict(X_test)</span>
<span id="cb49-3"><a href="leaving-out-our-best-feature.html#cb49-3"></a>matrix <span class="op">=</span> confusion_matrix(y_true, y_pred)</span>
<span id="cb49-4"><a href="leaving-out-our-best-feature.html#cb49-4"></a></span>
<span id="cb49-5"><a href="leaving-out-our-best-feature.html#cb49-5"></a>label_names <span class="op">=</span> pd.Series([<span class="st">&#39;unsuccessful&#39;</span>, <span class="st">&#39;successful&#39;</span>])</span>
<span id="cb49-6"><a href="leaving-out-our-best-feature.html#cb49-6"></a>pd.DataFrame(matrix,</span>
<span id="cb49-7"><a href="leaving-out-our-best-feature.html#cb49-7"></a>     columns<span class="op">=</span><span class="st">&#39;Predicted &#39;</span> <span class="op">+</span> label_names,</span>
<span id="cb49-8"><a href="leaving-out-our-best-feature.html#cb49-8"></a>     index<span class="op">=</span><span class="st">&#39;Is &#39;</span> <span class="op">+</span> label_names)</span></code></pre></div>
<div class='table-wrapper'>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Predicted unsuccessful
</th>
<th style="text-align:right;">
Predicted successful
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Is unsuccessful
</td>
<td style="text-align:right;">
1584
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
Is successful
</td>
<td style="text-align:right;">
679
</td>
<td style="text-align:right;">
5
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="decision-tree" class="section level3">
<h3><span class="header-section-number">6.1.4</span> Decision tree</h3>
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="leaving-out-our-best-feature.html#cb50-1"></a><span class="co"># Train a decision tree</span></span>
<span id="cb50-2"><a href="leaving-out-our-best-feature.html#cb50-2"></a>dec_tree <span class="op">=</span> tree.DecisionTreeClassifier(max_depth<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb50-3"><a href="leaving-out-our-best-feature.html#cb50-3"></a>dec_tree.fit(X_train, y_train)</span>
<span id="cb50-4"><a href="leaving-out-our-best-feature.html#cb50-4"></a></span>
<span id="cb50-5"><a href="leaving-out-our-best-feature.html#cb50-5"></a><span class="co"># Build a confusion matrix</span></span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="leaving-out-our-best-feature.html#cb51-1"></a>y_true <span class="op">=</span> y_test</span>
<span id="cb51-2"><a href="leaving-out-our-best-feature.html#cb51-2"></a>y_pred <span class="op">=</span> dec_tree.predict(X_test)</span>
<span id="cb51-3"><a href="leaving-out-our-best-feature.html#cb51-3"></a>matrix <span class="op">=</span> confusion_matrix(y_true, y_pred)</span>
<span id="cb51-4"><a href="leaving-out-our-best-feature.html#cb51-4"></a></span>
<span id="cb51-5"><a href="leaving-out-our-best-feature.html#cb51-5"></a>label_names <span class="op">=</span> pd.Series([<span class="st">&#39;unsuccessful&#39;</span>, <span class="st">&#39;successful&#39;</span>])</span>
<span id="cb51-6"><a href="leaving-out-our-best-feature.html#cb51-6"></a>pd.DataFrame(matrix,</span>
<span id="cb51-7"><a href="leaving-out-our-best-feature.html#cb51-7"></a>     columns<span class="op">=</span><span class="st">&#39;Predicted &#39;</span> <span class="op">+</span> label_names,</span>
<span id="cb51-8"><a href="leaving-out-our-best-feature.html#cb51-8"></a>     index<span class="op">=</span><span class="st">&#39;Is &#39;</span> <span class="op">+</span> label_names)</span></code></pre></div>
<div class='table-wrapper'>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Predicted unsuccessful
</th>
<th style="text-align:right;">
Predicted successful
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Is unsuccessful
</td>
<td style="text-align:right;">
1562
</td>
<td style="text-align:right;">
28
</td>
</tr>
<tr>
<td style="text-align:left;">
Is successful
</td>
<td style="text-align:right;">
660
</td>
<td style="text-align:right;">
24
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="random-forest-1" class="section level3">
<h3><span class="header-section-number">6.1.5</span> Random forest</h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="leaving-out-our-best-feature.html#cb52-1"></a><span class="co"># Train a decision tree</span></span>
<span id="cb52-2"><a href="leaving-out-our-best-feature.html#cb52-2"></a>forest <span class="op">=</span> RandomForestClassifier(n_estimators<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb52-3"><a href="leaving-out-our-best-feature.html#cb52-3"></a>forest.fit(X_train, y_train)</span>
<span id="cb52-4"><a href="leaving-out-our-best-feature.html#cb52-4"></a></span>
<span id="cb52-5"><a href="leaving-out-our-best-feature.html#cb52-5"></a><span class="co"># Build a confusion matrix</span></span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="leaving-out-our-best-feature.html#cb53-1"></a>y_true <span class="op">=</span> y_test</span>
<span id="cb53-2"><a href="leaving-out-our-best-feature.html#cb53-2"></a>y_pred <span class="op">=</span> forest.predict(X_test)</span>
<span id="cb53-3"><a href="leaving-out-our-best-feature.html#cb53-3"></a>matrix <span class="op">=</span> confusion_matrix(y_true, y_pred)</span>
<span id="cb53-4"><a href="leaving-out-our-best-feature.html#cb53-4"></a></span>
<span id="cb53-5"><a href="leaving-out-our-best-feature.html#cb53-5"></a>label_names <span class="op">=</span> pd.Series([<span class="st">&#39;unsuccessful&#39;</span>, <span class="st">&#39;successful&#39;</span>])</span>
<span id="cb53-6"><a href="leaving-out-our-best-feature.html#cb53-6"></a>pd.DataFrame(matrix,</span>
<span id="cb53-7"><a href="leaving-out-our-best-feature.html#cb53-7"></a>     columns<span class="op">=</span><span class="st">&#39;Predicted &#39;</span> <span class="op">+</span> label_names,</span>
<span id="cb53-8"><a href="leaving-out-our-best-feature.html#cb53-8"></a>     index<span class="op">=</span><span class="st">&#39;Is &#39;</span> <span class="op">+</span> label_names)</span></code></pre></div>
<div class='table-wrapper'>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Predicted unsuccessful
</th>
<th style="text-align:right;">
Predicted successful
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Is unsuccessful
</td>
<td style="text-align:right;">
1373
</td>
<td style="text-align:right;">
217
</td>
</tr>
<tr>
<td style="text-align:left;">
Is successful
</td>
<td style="text-align:right;">
474
</td>
<td style="text-align:right;">
210
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="summary" class="section level3">
<h3><span class="header-section-number">6.1.6</span> Summary</h3>
<p>Was it shocking? Looking at our confusion matrices, it becomes clear that some algorithms relied heavily on <code>high_success_rate_agency</code> while others could be flexible once it was removed.</p>
<ul>
<li>The <strong>KNN</strong> did worse, but still got a decent number correct</li>
<li>The <strong>logistic regression</strong> is almost as bad</li>
<li>The <strong>decision tree</strong> does about as well as k-nearest neighbors</li>
<li>The <strong>random forest</strong> performed slightly better than the KNN</li>
</ul>
<p>Random forests are generally thought of as a good “general purpose” classification algorithm. They’re flexible, they’re interpretable, and they usually work pretty well. We’ll see some problems with them in other chapters - they can be super slow, for example - but they get the job done.</p>
</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="feature-selection-and-engineering.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="explaining-predictions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 1
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

</body>

</html>

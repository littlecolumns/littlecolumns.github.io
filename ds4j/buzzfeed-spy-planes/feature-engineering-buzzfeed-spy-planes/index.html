<!doctype html>
<html lang="en-US">

<head>
  <meta charset="utf-8">
  <title>Feature engineering - Buzzfeed spy planes</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" rel="stylesheet">
  <!-- <link href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Raleway:400,700|Open+Sans:400,700&display=swap" rel="stylesheet"> -->
  <link rel="stylesheet" href="/ds4j/css/spectre.min.css">
  <link rel="stylesheet" href="/ds4j/css/spectre-exp.min.css">
  <link rel="stylesheet" href="/ds4j/css/spectre-icons.min.css">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="/ds4j/css/style.css" rel="stylesheet">
  <link href="/ds4j/css/highlight.css" rel="stylesheet">
</head>

<body>
  <div class="nav-holder bg-secondary">
  <div class='content'>
    <header class="navbar">
      <section class="navbar-section">
        <a href="/ds4j/" class="navbar-brand mr-2">DS4J</a>
      </section>
      <section class="navbar-section">
        <a href="/ds4j/projects" class="btn btn-link">Projects</a>
        <a href="/ds4j/topics" class="btn btn-link">Topics</a>
        <a href="/ds4j/curriculum" class="btn btn-link">Curriculum</a>
        <a href="/ds4j/about" class="btn btn-link">About</a>
      </section>
    </header>
  </div>
</div>
  
<div class="content text-based">
  <div class="columns">
    <div class="column col-12 notebook">
      <ul class="breadcrumb">
        <li class="breadcrumb-item">
          <a href="#">Projects</a>
        </li>
        <li class="breadcrumb-item">
          <a href="/ds4j/buzzfeed-spy-planes/">Uncovering surveillance planes with Buzzfeed</a>
        </li>
        <li class="breadcrumb-item">
          <a href="/ds4j/buzzfeed-spy-planes/feature-engineering-buzzfeed-spy-planes">Feature engineering - Buzzfeed spy planes</a>
        </li>
      </ul>

      <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Feature-engineering-with-Buzzfeed-planes">Feature engineering with Buzzfeed planes<a class="anchor-link" href="#Feature-engineering-with-Buzzfeed-planes">#</a></h1><p>When you're working on flight data, you don't get a nice description of where and how the plane flies - you're stuck with a series of individual measurements. In this notebook we'll work on engineering some descriptive features about each plane's "normal" way of flying.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="reading-options">
  <a class="btn" href="/ds4j/buzzfeed-spy-planes/feature-engineering-buzzfeed-spy-planes">
    <i class="fa fa-sm fa-book"></i>
    Read online
  </a>
  <a class="btn" href="/ds4j/buzzfeed-spy-planes/notebooks/Feature engineering - Buzzfeed spy planes.ipynb">
    <i class="fa fa-sm fa-download"></i>
    Download notebook
  </a>
  <a class="btn" href="#">
    <i class="fa fa-sm fa-laptop"></i>
    Interactive version
  </a>
</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You might need to install <code>pyproj</code> and <code>shapely</code> libraries for this one. You can uncomment the lines below and run them to (hopefully) get the installation done.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># !pip install pyproj</span>
<span class="c1"># !pip install shapely</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Imports">Imports<a class="anchor-link" href="#Imports">#</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Normal imports for data analysis</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> 
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Extra geographic bits, only used for for calculating fly zone area</span>
<span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">Polygon</span>
<span class="kn">from</span> <span class="nn">pyproj</span> <span class="kn">import</span> <span class="n">Transformer</span>                                                                                                                

<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Read-in-our-dataset">Read in our dataset<a class="anchor-link" href="#Read-in-our-dataset">#</a></h1><p>First we'll read in the dataset. Each organization you can get data from - OpenSky, FlightRadar24, etc - comes with slightly different columns. This set is from OpenSky.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/flights_data4-1529539200-cleaned.csv&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;icao24&#39;</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">})</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>icao24</th>
      <th>callsign</th>
      <th>day</th>
      <th>firstseen</th>
      <th>lastseen</th>
      <th>estdepartureairport</th>
      <th>estarrivalairport</th>
      <th>time</th>
      <th>altitude</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>heading</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a09909</td>
      <td>NaN</td>
      <td>1529539200</td>
      <td>1.529574e+09</td>
      <td>1529574562</td>
      <td>KPWK</td>
      <td>IN93</td>
      <td>1529574561</td>
      <td>609.6</td>
      <td>41.702100</td>
      <td>-86.469939</td>
      <td>88.232170</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a09909</td>
      <td>NaN</td>
      <td>1529539200</td>
      <td>1.529574e+09</td>
      <td>1529574562</td>
      <td>KPWK</td>
      <td>IN93</td>
      <td>1529574559</td>
      <td>609.6</td>
      <td>41.702042</td>
      <td>-86.472140</td>
      <td>88.253716</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a09909</td>
      <td>NaN</td>
      <td>1529539200</td>
      <td>1.529574e+09</td>
      <td>1529574562</td>
      <td>KPWK</td>
      <td>IN93</td>
      <td>1529574490</td>
      <td>914.4</td>
      <td>41.700657</td>
      <td>-86.553040</td>
      <td>88.451843</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a09909</td>
      <td>NaN</td>
      <td>1529539200</td>
      <td>1.529574e+09</td>
      <td>1529574562</td>
      <td>KPWK</td>
      <td>IN93</td>
      <td>1529574466</td>
      <td>1219.2</td>
      <td>41.703683</td>
      <td>-86.587595</td>
      <td>111.037514</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a09909</td>
      <td>NaN</td>
      <td>1529539200</td>
      <td>1.529574e+09</td>
      <td>1529574562</td>
      <td>KPWK</td>
      <td>IN93</td>
      <td>1529574465</td>
      <td>1219.2</td>
      <td>41.703962</td>
      <td>-86.588681</td>
      <td>111.037514</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When we sit down to do our machine learning, our question is going to be: <strong>is this plane a surveillance plane or not?</strong> Probably a bunch of rows, one per plane, each one having a prediction of <code>0</code> (not surveillance) or <code>1</code> (surveillance). It seems like a silly thing to call out, but... take a look at our data.</p>
<p><strong>Each row isn't a plane, it's a single reading from that plane in flight!</strong> This is going to cause some trouble. We can't predict whether each reading is a spy plane or not, because each reading doesn't have enough information in it. Each row has a time, altitude, coordinates, a heading, and a few other columns, but saying "you're flying north at these coordinates" is definitely not good enough to say whether something is a surveillance plane or not.</p>
<p>We'll somehow need to summarize all of these readings into a single row, to illustrate how the plane flies in a way that we can tell apart surveillance and non-surveillance planes. This calls for <strong>feature engineering!</strong></p>
<h1 id="Feature-engineering">Feature engineering<a class="anchor-link" href="#Feature-engineering">#</a></h1><p>Most of the time when we're doing machine learning, we have a list of columns we can plug into our machine learning algorithm. Maybe we divide a column by a thousand, or turn it into a percent instead of a raw number, but nothing really too crazy. Our main goal is <strong>feature selection</strong>, which is picking which columns to use.</p>
<p>In this case, though, we need to actually design all of these features. We'll pick apart each plane's flight paths using the coordinates, and turn it into a single row.</p>
<h2 id="Picking-features-to-engineer-for-surveillance-plane-detection">Picking features to engineer for surveillance plane detection<a class="anchor-link" href="#Picking-features-to-engineer-for-surveillance-plane-detection">#</a></h2><p><strong>What might make a spy plane unique?</strong> Buzzfeed had some ideas:</p>
<ul>
<li>How fast thep plane goes</li>
<li>Where the plane flies</li>
<li>How large of an area the plane flies over</li>
<li>How often the plane changes direction</li>
<li>How high each flight usually is</li>
<li>How long each flight is</li>
<li>What type of plane it is</li>
</ul>
<p>Your first instinct might be to calculate an average for each one of these. For example, how long is an average flight? and how fast does the plane usually go? Instead of sticking at this level, Peter went a bit further.</p>
<h2 id="Feature-engineering-example:-Altitude-quantiles">Feature engineering example: Altitude quantiles<a class="anchor-link" href="#Feature-engineering-example:-Altitude-quantiles">#</a></h2><p><strong>Let's see Peter's alterantive, using altitude as an example.</strong> For example, let's say we're interested in plane <code>a4f179</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">icao24</span> <span class="o">==</span> <span class="s1">&#39;a4f179&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>icao24</th>
      <th>callsign</th>
      <th>day</th>
      <th>firstseen</th>
      <th>lastseen</th>
      <th>estdepartureairport</th>
      <th>estarrivalairport</th>
      <th>time</th>
      <th>altitude</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>heading</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1096564</th>
      <td>a4f179</td>
      <td>MSQT714</td>
      <td>1529539200</td>
      <td>1.529614e+09</td>
      <td>1529614495</td>
      <td>2AZ7</td>
      <td>2AZ3</td>
      <td>1529614493</td>
      <td>1219.2</td>
      <td>33.748993</td>
      <td>-112.408242</td>
      <td>299.500732</td>
    </tr>
    <tr>
      <th>1096565</th>
      <td>a4f179</td>
      <td>MSQT714</td>
      <td>1529539200</td>
      <td>1.529614e+09</td>
      <td>1529614495</td>
      <td>2AZ7</td>
      <td>2AZ3</td>
      <td>1529614491</td>
      <td>1219.2</td>
      <td>33.748489</td>
      <td>-112.407177</td>
      <td>300.398743</td>
    </tr>
    <tr>
      <th>1096566</th>
      <td>a4f179</td>
      <td>MSQT714</td>
      <td>1529539200</td>
      <td>1.529614e+09</td>
      <td>1529614495</td>
      <td>2AZ7</td>
      <td>2AZ3</td>
      <td>1529614463</td>
      <td>1219.2</td>
      <td>33.742310</td>
      <td>-112.395406</td>
      <td>311.185913</td>
    </tr>
    <tr>
      <th>1096567</th>
      <td>a4f179</td>
      <td>MSQT714</td>
      <td>1529539200</td>
      <td>1.529614e+09</td>
      <td>1529614495</td>
      <td>2AZ7</td>
      <td>2AZ3</td>
      <td>1529614461</td>
      <td>1219.2</td>
      <td>33.741574</td>
      <td>-112.394371</td>
      <td>311.128754</td>
    </tr>
    <tr>
      <th>1096568</th>
      <td>a4f179</td>
      <td>MSQT714</td>
      <td>1529539200</td>
      <td>1.529614e+09</td>
      <td>1529614495</td>
      <td>2AZ7</td>
      <td>2AZ3</td>
      <td>1529614460</td>
      <td>1219.2</td>
      <td>33.741295</td>
      <td>-112.393970</td>
      <td>307.715973</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>How many readings do we have for this one? It's important to know what we're generally working with.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">icao24</span> <span class="o">==</span> <span class="s1">&#39;a4f179&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(3723, 12)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Wow, almost four thousand! That's a lot of info. Since we're focused on breaking it down to one row, though, we could ask "how high does this plane usually fly?"</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">icao24</span> <span class="o">==</span> <span class="s1">&#39;a4f179&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">altitude</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1001.4272360999194</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>That number might not mean much on its own, as we don't know if it's high or low. We'd need to compare it to other planes to see what that speed really looks like (...yeah, yeah, this isn't exactly true, but bear with me).</p>
<p>Let's get the mean altitude of <em>all</em> readings.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">altitude</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>4684.43290572469</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Okay, cool, so our plane seems to generally fly a lot lower than other planes. But I'm conflicted - we took 3800 altitude datapoints and turned it into one! It seems like like we're throwing out a lot of data that might prove useful in tracking down planes. <strong>Instead of reducing a plane to <em>one</em> number, let's see if we have any alternatives.</strong></p>
<p>Think about all the questions you might ask about how planes fly. Do almost all planes fly at the same altitude? When they're flying, do they usually stay at one altitude? Or do they go up and down, in a way that measuring the mean won't capture?</p>
<p>We don't know anything about planes, so maybe we should ask what a "normal" flight looks like beyond just the mean. A histogram could help us there!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">altitude</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x10df415f8&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Wow, interesting! It seems like there's a lot of low-flying planes, and then a big peak at 10,000, but plenty between and above. It might be useful to capture that numerically. We could ask for quartiles, but let's go a little more complex: <strong>what are the 20%, 40%, 60% and 80% boundaries for altitude?</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">quantiles</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">altitude</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>
<span class="n">quantiles</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.2      914.4
0.4     1828.8
0.6     4572.0
0.8    10058.4
Name: altitude, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Remember how we were "throwing out a lot of data" by reducing our altitude measurements to just an average? The way Peter got around this way to <strong>count each measurement separately.</strong></p>
<p>His question became: <strong>compared to an average plane, how often was our plane in each altitude group?</strong> How often was between the the 0-20% altitude? or the 20-40% altitude? or the 40-60% latitude?</p>
<p>A very average plane will always be in the 40-60% range. A plane that's always flying high is in the 80-100% group. A low-flying plane would be in 0-20%. If you split your time between high and low, you'll have entries in both 0-20% <em>and</em> 80-100%. <strong>This is a great way to summarize your data without throwing it all out.</strong></p>
<p>Let's perform that analysis with our <code>a4f179</code> plane, seeing how much time it spends in each bucket.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create buckets based on the quantiles of all planes,</span>
<span class="c1"># reusing our variable from above</span>
<span class="n">bin_quantiles</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">*</span><span class="n">quantiles</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]</span>

<span class="c1"># altitude1: -infinity to 914.4</span>
<span class="c1"># altitude2: 914.4     to 1,828.8</span>
<span class="c1"># altitude3: 1,828.8   to 4,572.0</span>
<span class="c1"># altitude4: 4,572.0   to 10,058.4</span>
<span class="c1"># altitude5: 10,058.4  to infinity</span>
<span class="n">bin_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;altitude1&#39;</span><span class="p">,</span><span class="s1">&#39;altitude2&#39;</span><span class="p">,</span><span class="s1">&#39;altitude3&#39;</span><span class="p">,</span><span class="s1">&#39;altitude4&#39;</span><span class="p">,</span><span class="s1">&#39;altitude5&#39;</span><span class="p">]</span>

<span class="c1"># Get the altitudes for just this plane</span>
<span class="n">altitudes</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">icao24</span> <span class="o">==</span> <span class="s1">&#39;a4f179&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">altitude</span>

<span class="c1"># Count how many altitude reading are in each bucket</span>
<span class="c1"># normalize=True to give us percentages</span>
<span class="c1"># bins=bin_labels to name them</span>
<span class="c1"># sort=False so we can see them in order of 1-5</span>
<span class="c1"># * 100 to convert to percentages because it&#39;s easier to read</span>
<span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">altitudes</span><span class="p">,</span> 
       <span class="n">bins</span><span class="o">=</span><span class="n">bin_quantiles</span><span class="p">,</span>
       <span class="n">labels</span><span class="o">=</span><span class="n">bin_labels</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>altitude1    18.614021
altitude2    81.385979
altitude3     0.000000
altitude4     0.000000
altitude5     0.000000
Name: altitude, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So our plane spends about <strong>18% of its time flying low, and 80% of its time flying medium-low.</strong> Let's compare that with another plane, <code>a97db4</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">altitudes</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">icao24</span> <span class="o">==</span> <span class="s1">&#39;a97db4&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">altitude</span>

<span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">altitudes</span><span class="p">,</span> 
       <span class="n">bins</span><span class="o">=</span><span class="n">bin_quantiles</span><span class="p">,</span>
       <span class="n">labels</span><span class="o">=</span><span class="n">bin_labels</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>altitude1     1.923788
altitude2     8.694044
altitude3     5.438402
altitude4     8.213097
altitude5    75.730670
Name: altitude, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This plane is a completely different beast! Instead of spending most of its time low, it works its way up to the highest altitudes and spends around 76% of its time there. It's a <strong>very</strong> different pattern than our first plane, and gives a good summary that we might not have gotten if we just took the mean.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Calculating-other-feature-quantiles">Calculating other feature quantiles<a class="anchor-link" href="#Calculating-other-feature-quantiles">#</a></h2><p>Now that we have an idea of what we're going to be doing, let's get started! And to make things a bit easier, Buzzfeed didn't actually process these quantiles for all of the planes in its dataset:</p>
<blockquote><p>Then we took a random sample of <strong>500 aircraft</strong> and calculated the following for each one:</p>
</blockquote>
<p>So we can start by <strong>pulling a sample of planes</strong>. Note that we can't just ask for 500 random rows - we have to ask for 500 unique <em>plane identifiers</em> and then use those to select our rows.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">unique_icao24</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">icao24</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<span class="n">sample_icao24</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">unique_icao24</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">sample_icao24</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([&#39;a06a7e&#39;, &#39;a9df59&#39;, &#39;a9e391&#39;, &#39;ae0232&#39;, &#39;a5ddea&#39;], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we can select our readings for the sample planes.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sample_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">icao24</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">sample_icao24</span><span class="p">)]</span>
<span class="n">sample_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(239188, 12)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Calculate-quantiles">Calculate quantiles<a class="anchor-link" href="#Calculate-quantiles">#</a></h1><blockquote><p>Then we took a random sample of 500 aircraft and calculated the following for each one:</p>
<ul>
<li><strong>duration</strong> of each flight segment recorded by Flightradar24, in minutes.</li>
<li><strong>boxes</strong> Area of a rectangular bounding box drawn around each flight segment, in square kilometers.</li>
</ul>
</blockquote>
<h2 id="Altitude-quantiles">Altitude quantiles<a class="anchor-link" href="#Altitude-quantiles">#</a></h2><p>Since we basically did altitude already, though, we'll throw that in there.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Get a list of altitudes</span>
<span class="n">altitudes</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;icao24&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">altitude</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Calculate quantiles from the sample and calculate each plane&#39;s behavior</span>
<span class="n">quantiles</span> <span class="o">=</span> <span class="n">altitudes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sample_icao24</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>

<span class="n">bin_quantiles</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">*</span><span class="n">quantiles</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]</span>
<span class="n">bin_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;altitude1&#39;</span><span class="p">,</span><span class="s1">&#39;altitude2&#39;</span><span class="p">,</span><span class="s1">&#39;altitude3&#39;</span><span class="p">,</span><span class="s1">&#39;altitude4&#39;</span><span class="p">,</span><span class="s1">&#39;altitude5&#39;</span><span class="p">]</span>

<span class="n">binned</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">altitudes</span><span class="p">,</span>
                <span class="n">bins</span><span class="o">=</span><span class="n">bin_quantiles</span><span class="p">,</span>
                <span class="n">labels</span><span class="o">=</span><span class="n">bin_labels</span><span class="p">)</span>

<span class="n">altitude_features</span> <span class="o">=</span> <span class="n">binned</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;icao24&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">altitude_features</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>altitude</th>
      <th>altitude1</th>
      <th>altitude2</th>
      <th>altitude3</th>
      <th>altitude4</th>
      <th>altitude5</th>
    </tr>
    <tr>
      <th>icao24</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>000001</th>
      <td>70.951157</td>
      <td>28.149100</td>
      <td>0.899743</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>009f55</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>100.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>00b0ec</th>
      <td>17.757009</td>
      <td>26.168224</td>
      <td>32.710280</td>
      <td>14.953271</td>
      <td>8.411215</td>
    </tr>
    <tr>
      <th>00b1fa</th>
      <td>37.500000</td>
      <td>24.038462</td>
      <td>9.134615</td>
      <td>20.192308</td>
      <td>9.134615</td>
    </tr>
    <tr>
      <th>00b208</th>
      <td>13.580247</td>
      <td>32.098765</td>
      <td>17.283951</td>
      <td>33.333333</td>
      <td>3.703704</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Flight-duration-quantiles">Flight duration quantiles<a class="anchor-link" href="#Flight-duration-quantiles">#</a></h2><p>Calculate flight durations for all of our planes. We're grouping by the plane ID and the <code>firstseen</code> column, which indicates a new flight.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">flight_times</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;icao24&#39;</span><span class="p">,</span> <span class="s1">&#39;firstseen&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">lastseen</span><span class="o">.</span><span class="n">last</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">flight_times</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>firstseen</th>
      <th>lastseen</th>
    </tr>
    <tr>
      <th>icao24</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>000001</th>
      <td>1.529539e+09</td>
      <td>1529539737</td>
    </tr>
    <tr>
      <th>000001</th>
      <td>1.529541e+09</td>
      <td>1529571558</td>
    </tr>
    <tr>
      <th>000001</th>
      <td>1.529595e+09</td>
      <td>1529610553</td>
    </tr>
    <tr>
      <th>009f55</th>
      <td>1.529586e+09</td>
      <td>1529587568</td>
    </tr>
    <tr>
      <th>00b0ec</th>
      <td>1.529523e+09</td>
      <td>1529576455</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can then subtract the two to get the duration for each flight.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">durations</span> <span class="o">=</span> <span class="n">flight_times</span><span class="o">.</span><span class="n">lastseen</span> <span class="o">-</span> <span class="n">flight_times</span><span class="o">.</span><span class="n">firstseen</span>
<span class="n">durations</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>icao24
000001      894.0
000001    30940.0
000001    15530.0
009f55     1695.0
00b0ec    53862.0
dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Calculate quantiles from the sample and calculate each plane&#39;s behavior</span>
<span class="n">quantiles</span> <span class="o">=</span> <span class="n">durations</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sample_icao24</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>

<span class="n">bin_quantiles</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">*</span><span class="n">quantiles</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]</span>
<span class="n">bin_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;duration1&#39;</span><span class="p">,</span><span class="s1">&#39;duration2&#39;</span><span class="p">,</span><span class="s1">&#39;duration3&#39;</span><span class="p">,</span><span class="s1">&#39;duration4&#39;</span><span class="p">,</span><span class="s1">&#39;duration5&#39;</span><span class="p">]</span>

<span class="n">binned</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">durations</span><span class="p">,</span>
                <span class="n">bins</span><span class="o">=</span><span class="n">bin_quantiles</span><span class="p">,</span>
                <span class="n">labels</span><span class="o">=</span><span class="n">bin_labels</span><span class="p">)</span>

<span class="n">duration_features</span> <span class="o">=</span> <span class="n">binned</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;icao24&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">duration_features</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>duration1</th>
      <th>duration2</th>
      <th>duration3</th>
      <th>duration4</th>
      <th>duration5</th>
    </tr>
    <tr>
      <th>icao24</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>000001</th>
      <td>33.333333</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>66.666667</td>
    </tr>
    <tr>
      <th>009f55</th>
      <td>0.000000</td>
      <td>100.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>00b0ec</th>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.000000</td>
    </tr>
    <tr>
      <th>00b1fa</th>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.000000</td>
    </tr>
    <tr>
      <th>00b208</th>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Speed-quantiles">Speed quantiles<a class="anchor-link" href="#Speed-quantiles">#</a></h1><blockquote><p>TODO speed!!!</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>icao24</th>
      <th>callsign</th>
      <th>day</th>
      <th>firstseen</th>
      <th>lastseen</th>
      <th>estdepartureairport</th>
      <th>estarrivalairport</th>
      <th>time</th>
      <th>altitude</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>heading</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a09909</td>
      <td>NaN</td>
      <td>1529539200</td>
      <td>1.529574e+09</td>
      <td>1529574562</td>
      <td>KPWK</td>
      <td>IN93</td>
      <td>1529574561</td>
      <td>609.6</td>
      <td>41.702100</td>
      <td>-86.469939</td>
      <td>88.232170</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a09909</td>
      <td>NaN</td>
      <td>1529539200</td>
      <td>1.529574e+09</td>
      <td>1529574562</td>
      <td>KPWK</td>
      <td>IN93</td>
      <td>1529574559</td>
      <td>609.6</td>
      <td>41.702042</td>
      <td>-86.472140</td>
      <td>88.253716</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Bounding-box-area-quintiles">Bounding box area quintiles<a class="anchor-link" href="#Bounding-box-area-quintiles">#</a></h1><p>We'll calculate for everyone, then get quintiles from the sample</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Calculate min/max for each flight&#39;s lat/lon</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;icao24&#39;</span><span class="p">,</span> <span class="s1">&#39;firstseen&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
    <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">],</span>
    <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">]</span>
<span class="p">})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">coords</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">latitude</th>
      <th colspan="2" halign="left">longitude</th>
    </tr>
    <tr>
      <th></th>
      <th>min</th>
      <th>max</th>
      <th>min</th>
      <th>max</th>
    </tr>
    <tr>
      <th>icao24</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>000001</th>
      <td>34.875229</td>
      <td>34.885409</td>
      <td>-86.809593</td>
      <td>-86.707801</td>
    </tr>
    <tr>
      <th>000001</th>
      <td>34.777222</td>
      <td>34.881821</td>
      <td>-86.809312</td>
      <td>-86.692085</td>
    </tr>
    <tr>
      <th>000001</th>
      <td>33.032364</td>
      <td>33.679613</td>
      <td>-111.994124</td>
      <td>-111.361322</td>
    </tr>
    <tr>
      <th>009f55</th>
      <td>34.681184</td>
      <td>37.396591</td>
      <td>-80.488294</td>
      <td>-78.992672</td>
    </tr>
    <tr>
      <th>00b0ec</th>
      <td>37.990173</td>
      <td>40.612033</td>
      <td>-73.915267</td>
      <td>-68.287626</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Calculate the bounding box in km for those</span>
<span class="c1"># Yeah, sorry this is complicated</span>

<span class="n">transformer</span> <span class="o">=</span> <span class="n">Transformer</span><span class="o">.</span><span class="n">from_crs</span><span class="p">(</span><span class="s1">&#39;epsg:4326&#39;</span><span class="p">,</span> <span class="s1">&#39;epsg:3857&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_area</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="n">coords_y</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">][</span><span class="s1">&#39;min&#39;</span><span class="p">],</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">][</span><span class="s1">&#39;max&#39;</span><span class="p">],</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">][</span><span class="s1">&#39;max&#39;</span><span class="p">],</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">][</span><span class="s1">&#39;min&#39;</span><span class="p">],</span>
    <span class="p">]</span>
    <span class="n">coords_x</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">][</span><span class="s1">&#39;max&#39;</span><span class="p">],</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">][</span><span class="s1">&#39;max&#39;</span><span class="p">],</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">][</span><span class="s1">&#39;min&#39;</span><span class="p">],</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">][</span><span class="s1">&#39;min&#39;</span><span class="p">],</span>
    <span class="p">]</span>

    <span class="c1"># This is so much faster than going the shapely route</span>
    <span class="c1"># but also slower than it used to be?</span>
    <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">coords_x</span><span class="p">,</span> <span class="n">coords_y</span><span class="p">)</span>
    <span class="n">square_m</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">))</span><span class="o">.</span><span class="n">area</span>
    <span class="n">square_km</span> <span class="o">=</span> <span class="n">square_m</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1000</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">square_km</span>

<span class="n">areas</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_area</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">areas</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>icao24
000001        15.653545
000001       185.110905
000001      6076.579771
009f55     62250.036094
00b0ec    236331.915381
dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Calculate quantiles from the sample and calculate each plane&#39;s behavior</span>
<span class="n">quantiles</span> <span class="o">=</span> <span class="n">areas</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sample_icao24</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>

<span class="n">bin_quantiles</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">*</span><span class="n">quantiles</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]</span>
<span class="n">bin_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;area1&#39;</span><span class="p">,</span><span class="s1">&#39;area2&#39;</span><span class="p">,</span><span class="s1">&#39;area3&#39;</span><span class="p">,</span><span class="s1">&#39;area4&#39;</span><span class="p">,</span><span class="s1">&#39;area5&#39;</span><span class="p">]</span>

<span class="n">binned</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">areas</span><span class="p">,</span>
                <span class="n">bins</span><span class="o">=</span><span class="n">bin_quantiles</span><span class="p">,</span>
                <span class="n">labels</span><span class="o">=</span><span class="n">bin_labels</span><span class="p">)</span>

<span class="n">area_features</span> <span class="o">=</span> <span class="n">binned</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;icao24&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">area_features</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>area1</th>
      <th>area2</th>
      <th>area3</th>
      <th>area4</th>
      <th>area5</th>
    </tr>
    <tr>
      <th>icao24</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>000001</th>
      <td>100.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>009f55</th>
      <td>0.0</td>
      <td>100.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>00b0ec</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>00b1fa</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>00b208</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Compute-the-steering">Compute the steering<a class="anchor-link" href="#Compute-the-steering">#</a></h2><p>Each measurement has a heading, the direction the plane is going. By calculating the difference between one heading and the next, we can calculate in which direction the plane was steered.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;steering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;icao24&#39;</span><span class="p">,</span> <span class="s1">&#39;firstseen&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">heading</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>icao24</th>
      <th>callsign</th>
      <th>day</th>
      <th>firstseen</th>
      <th>lastseen</th>
      <th>estdepartureairport</th>
      <th>estarrivalairport</th>
      <th>time</th>
      <th>altitude</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>heading</th>
      <th>steering</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a09909</td>
      <td>NaN</td>
      <td>1529539200</td>
      <td>1.529574e+09</td>
      <td>1529574562</td>
      <td>KPWK</td>
      <td>IN93</td>
      <td>1529574561</td>
      <td>609.6</td>
      <td>41.702100</td>
      <td>-86.469939</td>
      <td>88.232170</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a09909</td>
      <td>NaN</td>
      <td>1529539200</td>
      <td>1.529574e+09</td>
      <td>1529574562</td>
      <td>KPWK</td>
      <td>IN93</td>
      <td>1529574559</td>
      <td>609.6</td>
      <td>41.702042</td>
      <td>-86.472140</td>
      <td>88.253716</td>
      <td>0.021545</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a09909</td>
      <td>NaN</td>
      <td>1529539200</td>
      <td>1.529574e+09</td>
      <td>1529574562</td>
      <td>KPWK</td>
      <td>IN93</td>
      <td>1529574490</td>
      <td>914.4</td>
      <td>41.700657</td>
      <td>-86.553040</td>
      <td>88.451843</td>
      <td>0.198128</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a09909</td>
      <td>NaN</td>
      <td>1529539200</td>
      <td>1.529574e+09</td>
      <td>1529574562</td>
      <td>KPWK</td>
      <td>IN93</td>
      <td>1529574466</td>
      <td>1219.2</td>
      <td>41.703683</td>
      <td>-86.587595</td>
      <td>111.037514</td>
      <td>22.585670</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a09909</td>
      <td>NaN</td>
      <td>1529539200</td>
      <td>1.529574e+09</td>
      <td>1529574562</td>
      <td>KPWK</td>
      <td>IN93</td>
      <td>1529574465</td>
      <td>1219.2</td>
      <td>41.703962</td>
      <td>-86.588681</td>
      <td>111.037514</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">steerings</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;icao24&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">steering</span>
<span class="n">steerings</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>icao24
a09909          NaN
a09909     0.021545
a09909     0.198128
a09909    22.585670
a09909     0.000000
Name: steering, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since we aren't quite sure how much steering goes into flying a plane, we can take a look at a histogram to try to understand it.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">steerings</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x11c5cad30&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice those +/- 300-something turns? It's a side effect of our calculation - think about what a 359 degree turn to the right is (Hint: it's just ONE DEGREE to the left). Let's get rid of them.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Just in case it crossed the 360 barrier, we can only turn 180* L or R</span>
<span class="n">steerings</span> <span class="o">=</span> <span class="n">steerings</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">direction</span><span class="p">:</span> <span class="n">direction</span> <span class="k">if</span> <span class="n">direction</span> <span class="o">&lt;=</span> <span class="mi">180</span> <span class="k">else</span> <span class="n">direction</span> <span class="o">-</span> <span class="mi">360</span><span class="p">)</span>
<span class="n">steerings</span> <span class="o">=</span> <span class="n">steerings</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">direction</span><span class="p">:</span> <span class="n">direction</span> <span class="k">if</span> <span class="n">direction</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">180</span> <span class="k">else</span> <span class="n">direction</span> <span class="o">+</span> <span class="mi">360</span><span class="p">)</span>

<span class="n">steerings</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>icao24
a09909          NaN
a09909     0.021545
a09909     0.198128
a09909    22.585670
a09909     0.000000
Name: steering, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Does the distribution still have those 300s in there?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">steerings</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x125f1c550&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>That looks more reasonable - now we can run some calculations. <strong>Peter didn't use quantiles for this one</strong>, he used his own boundaries.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Calculate quantiles from the sample and calculate each plane&#39;s behavior</span>
<span class="c1">#quantiles = areas.loc[sample_icao24].quantile([0.2, 0.4, 0.6, 0.8])</span>
<span class="n">quantiles</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">45</span><span class="p">]</span>

<span class="n">bin_quantiles</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">*</span><span class="n">quantiles</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]</span>
<span class="n">bin_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;steer1&#39;</span><span class="p">,</span><span class="s1">&#39;steer2&#39;</span><span class="p">,</span><span class="s1">&#39;steer3&#39;</span><span class="p">,</span><span class="s1">&#39;steer4&#39;</span><span class="p">,</span><span class="s1">&#39;steer5&#39;</span><span class="p">,</span> <span class="s1">&#39;steer6&#39;</span><span class="p">,</span> <span class="s1">&#39;steer7&#39;</span><span class="p">,</span> <span class="s1">&#39;steer8&#39;</span><span class="p">]</span>

<span class="n">binned</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">steerings</span><span class="p">,</span>
                <span class="n">bins</span><span class="o">=</span><span class="n">bin_quantiles</span><span class="p">,</span>
                <span class="n">labels</span><span class="o">=</span><span class="n">bin_labels</span><span class="p">)</span>

<span class="n">steer_features</span> <span class="o">=</span> <span class="n">binned</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;icao24&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">steer_features</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>steering</th>
      <th>steer1</th>
      <th>steer2</th>
      <th>steer3</th>
      <th>steer4</th>
      <th>steer5</th>
      <th>steer6</th>
      <th>steer7</th>
      <th>steer8</th>
    </tr>
    <tr>
      <th>icao24</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>000001</th>
      <td>1.609788</td>
      <td>2.318094</td>
      <td>56.213780</td>
      <td>6.696716</td>
      <td>3.090792</td>
      <td>27.817128</td>
      <td>1.094656</td>
      <td>1.159047</td>
    </tr>
    <tr>
      <th>009f55</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>29.411765</td>
      <td>23.529412</td>
      <td>41.176471</td>
      <td>5.882353</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>00b0ec</th>
      <td>0.000000</td>
      <td>0.943396</td>
      <td>48.113208</td>
      <td>8.490566</td>
      <td>16.037736</td>
      <td>26.415094</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>00b1fa</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>42.028986</td>
      <td>12.077295</td>
      <td>10.628019</td>
      <td>35.265700</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>00b208</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>63.975155</td>
      <td>16.770186</td>
      <td>5.590062</td>
      <td>13.043478</td>
      <td>0.621118</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Observations:-How-many-times-did-each-plane-show-up-in-our-dataset?">Observations: How many times did each plane show up in our dataset?<a class="anchor-link" href="#Observations:-How-many-times-did-each-plane-show-up-in-our-dataset?">#</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">count_features</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;icao24&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;observations&#39;</span><span class="p">)</span>
<span class="n">count_features</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>observations</th>
    </tr>
    <tr>
      <th>icao24</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>000001</th>
      <td>1556</td>
    </tr>
    <tr>
      <th>009f55</th>
      <td>18</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Combine-everything-into-a-features-set">Combine everything into a features set<a class="anchor-link" href="#Combine-everything-into-a-features-set">#</a></h1><p>Now that we have multiple dataframes of features, we can concatenate them all together based on the <code>iaco24</code> index and have a nice big set of features.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
    <span class="n">altitude_features</span><span class="p">,</span>
    <span class="n">duration_features</span><span class="p">,</span>
    <span class="n">area_features</span><span class="p">,</span>
    <span class="n">steer_features</span><span class="p">,</span>
    <span class="n">count_features</span>
<span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">features</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>altitude1</th>
      <th>altitude2</th>
      <th>altitude3</th>
      <th>altitude4</th>
      <th>altitude5</th>
      <th>duration1</th>
      <th>duration2</th>
      <th>duration3</th>
      <th>duration4</th>
      <th>duration5</th>
      <th>...</th>
      <th>area5</th>
      <th>steer1</th>
      <th>steer2</th>
      <th>steer3</th>
      <th>steer4</th>
      <th>steer5</th>
      <th>steer6</th>
      <th>steer7</th>
      <th>steer8</th>
      <th>observations</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>000001</th>
      <td>70.951157</td>
      <td>28.1491</td>
      <td>0.899743</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>33.333333</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>66.666667</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.609788</td>
      <td>2.318094</td>
      <td>56.213780</td>
      <td>6.696716</td>
      <td>3.090792</td>
      <td>27.817128</td>
      <td>1.094656</td>
      <td>1.159047</td>
      <td>1556</td>
    </tr>
    <tr>
      <th>009f55</th>
      <td>0.000000</td>
      <td>0.0000</td>
      <td>0.000000</td>
      <td>100.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>100.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>29.411765</td>
      <td>23.529412</td>
      <td>41.176471</td>
      <td>5.882353</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>18</td>
    </tr>
  </tbody>
</table>
<p>2 rows  24 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll also turn the <code>icao24</code> back into a column, and <strong>capitalize it</strong> to match the other popular datasets on the topic.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">features</span> <span class="o">=</span> <span class="n">features</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;icao24&#39;</span><span class="p">})</span>
<span class="n">features</span><span class="o">.</span><span class="n">icao24</span> <span class="o">=</span> <span class="n">features</span><span class="o">.</span><span class="n">icao24</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
<span class="n">features</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>icao24</th>
      <th>altitude1</th>
      <th>altitude2</th>
      <th>altitude3</th>
      <th>altitude4</th>
      <th>altitude5</th>
      <th>duration1</th>
      <th>duration2</th>
      <th>duration3</th>
      <th>duration4</th>
      <th>...</th>
      <th>area5</th>
      <th>steer1</th>
      <th>steer2</th>
      <th>steer3</th>
      <th>steer4</th>
      <th>steer5</th>
      <th>steer6</th>
      <th>steer7</th>
      <th>steer8</th>
      <th>observations</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>000001</td>
      <td>70.951157</td>
      <td>28.149100</td>
      <td>0.899743</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>33.333333</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.609788</td>
      <td>2.318094</td>
      <td>56.213780</td>
      <td>6.696716</td>
      <td>3.090792</td>
      <td>27.817128</td>
      <td>1.094656</td>
      <td>1.159047</td>
      <td>1556</td>
    </tr>
    <tr>
      <th>1</th>
      <td>009F55</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>100.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>100.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>29.411765</td>
      <td>23.529412</td>
      <td>41.176471</td>
      <td>5.882353</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>18</td>
    </tr>
    <tr>
      <th>2</th>
      <td>00B0EC</td>
      <td>17.757009</td>
      <td>26.168224</td>
      <td>32.710280</td>
      <td>14.953271</td>
      <td>8.411215</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.943396</td>
      <td>48.113208</td>
      <td>8.490566</td>
      <td>16.037736</td>
      <td>26.415094</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>107</td>
    </tr>
    <tr>
      <th>3</th>
      <td>00B1FA</td>
      <td>37.500000</td>
      <td>24.038462</td>
      <td>9.134615</td>
      <td>20.192308</td>
      <td>9.134615</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>42.028986</td>
      <td>12.077295</td>
      <td>10.628019</td>
      <td>35.265700</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>208</td>
    </tr>
    <tr>
      <th>4</th>
      <td>00B208</td>
      <td>13.580247</td>
      <td>32.098765</td>
      <td>17.283951</td>
      <td>33.333333</td>
      <td>3.703704</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>63.975155</td>
      <td>16.770186</td>
      <td>5.590062</td>
      <td>13.043478</td>
      <td>0.621118</td>
      <td>0.000000</td>
      <td>162</td>
    </tr>
  </tbody>
</table>
<p>5 rows  25 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Filtering-for-meaning-and-saving">Filtering for meaning and saving<a class="anchor-link" href="#Filtering-for-meaning-and-saving">#</a></h1><p>Peter only kept planes that had over 500 measurements.</p>
<p>We have far fewer planes than he did (and a much smaller dataset), but for propriety's sake we'll do the same.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before filtering&quot;</span><span class="p">,</span> <span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">subset</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="n">features</span><span class="o">.</span><span class="n">observations</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After filtering&quot;</span><span class="p">,</span> <span class="n">subset</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Before filtering (13840, 25)
After filtering (3965, 25)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Save the filtered version</span>
<span class="n">subset</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;data/opensky-features.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Save a copy of the full set just for experimentation</span>
<span class="n">features</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;data/opensky-features-full.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Review">Review<a class="anchor-link" href="#Review">#</a></h1><p>We started off with a list of coordinates and other information for our planes, but needed to turn that into a <strong>description of how the plane behaves in the air.</strong> Adjusting your data to create new descriptive elements is called <strong>feature engineering</strong>, and is an important part of machine learning.</p>
<p>While we could have just used simple features like the average altitude and speed of our planes, we felt like that was throwing out a lot of our data. Instead, we divided the "average" behavior of a plane into 5 quantiles - 0-20%, 20-40%, 40-60%, 60-80%, and 80-100% - and saw how much time each plane spent in each quantile. For example, a slow, low-flying plane might spend most of its time in the 0-20% quantile for altitude and speed.</p>
<p>Although it was complicated, this method allowed us to create a more complete set of features describing how each plane flies. The hope is that these detailed features will allow us to better identify planes that are flown similarly to one another.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Discussion-topics">Discussion topics<a class="anchor-link" href="#Discussion-topics">#</a></h2><ul>
<li>Do you think these features do a better job of describing a plane than just the median or mean? Is that answer the same for all of the measurements we took?</li>
<li>Which feature do you predict works best to describe surveillance planes?</li>
<li>Why do we not use quantiles for steering? It might be interesting to check what the quantiles would have been.</li>
<li>Can you think of other features that might be used to describe surveillance planes?</li>
<li>Some organizations that publish this sort of data have agreements to not include military or government planes. Is that a reasonable request?</li>
<li>What might be some uses of this data?</li>
<li>How is this data collected? What are the requirements to be able to obtain it on your own?</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
 


    </div>
  </div>
</div>

<script>
  [...document.querySelectorAll(".code_cell")].filter(cell => cell.innerText.trim().length === 0).forEach(cell => cell.remove())
</script>

  <div class="footer bg-secondary">
  <div class="content">
    <div class="columns">
      <div class="column col-6 col-sm-12">
        <p><strong>Hi, welcome to Data Science for Journalism!</strong></p>
        <p>There's been a lot of buzz about machine learning and "artificial intelligence" being used in stories over
          the past few years. It's mostly not that complicated - a little stats, a classifier here or there - but it's
          hard to know where to start without a little help.</p>
        <p>Hopefully this site can be that help! <a href="/ds4j/about">Learn more about this project here.</a></p>
      </div>
      <div class="column col-3 col-sm-6">
        <p><strong>Quick links</strong></p>
        <!-- <p><a href="#">Something here</a></p>
        <p><a href="#">Something here</a></p>
        <p><a href="#">Something here</a></p> -->
      </div>
      <div class="column col-3 col-sm6">
        <p><strong>Contact</strong></p>
        <p><a href="mailto:hello@littlecolumns.com">hello@littlecolumns.com</a></p>
      </div>
    </div>
  </div>
</div>
  <script src="/ds4j/js/tocbot.js"></script>

  <script>
    try {
      let toc = document.createElement("div")
      toc.setAttribute('class', 'js-toc')
      document.querySelector(".reading-options").parentNode.appendChild(toc)
    } catch (err) {

    }

    tocbot.init({
      // Where to render the table of contents.
      tocSelector: '.js-toc',
      // Where to grab the headings to build the table of contents.
      contentSelector: '.notebook',
      // Which headings to grab inside of the contentSelector element.
      headingSelector: 'h1, h2, h3, h4',
      activeLinkClass: 'active',
      listClass: 'nav',
      listItemClass: 'nav-item',
      headingLabelCallback: function (label) {
        return label.replace("#", "")
      }
    });
  </script>

</body>

</html>
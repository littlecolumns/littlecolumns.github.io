<!doctype html>
<html lang="en-US">

<head>
  <meta charset="utf-8">
  <title>Designing your own sentiment analysis tool</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" rel="stylesheet">
  <!-- <link href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Raleway:400,700|Open+Sans:400,700&display=swap" rel="stylesheet"> -->
  <link rel="stylesheet" href="/ds4j/css/spectre.min.css">
  <link rel="stylesheet" href="/ds4j/css/spectre-exp.min.css">
  <link rel="stylesheet" href="/ds4j/css/spectre-icons.min.css">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="/ds4j/css/style.css" rel="stylesheet">
  <link href="/ds4j/css/highlight.css" rel="stylesheet">
</head>

<body>
  <div class="nav-holder bg-secondary">
  <div class='content'>
    <header class="navbar">
      <section class="navbar-section">
        <a href="/ds4j/" class="navbar-brand mr-2">DS4J</a>
      </section>
      <section class="navbar-section">
        <a href="/ds4j/projects" class="btn btn-link">Projects</a>
        <a href="/ds4j/topics" class="btn btn-link">Topics</a>
        <a href="/ds4j/curriculum" class="btn btn-link">Curriculum</a>
        <a href="/ds4j/about" class="btn btn-link">About</a>
      </section>
    </header>
  </div>
</div>
  
<div class="content text-based">
  <div class="columns">
    <div class="column col-12 notebook">
      <ul class="breadcrumb">
        <li class="breadcrumb-item">
          <a href="#">Projects</a>
        </li>
        <li class="breadcrumb-item">
          <a href="/ds4j/investigating-sentiment-analysis/">A very short introduction to sentiment analysis</a>
        </li>
        <li class="breadcrumb-item">
          <a href="/ds4j/investigating-sentiment-analysis/designing-your-own-sentiment-analysis-tool">Designing your own sentiment analysis tool</a>
        </li>
      </ul>

      <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Designing-your-own-sentiment-analysis-tool">Designing your own sentiment analysis tool<a class="anchor-link" href="#Designing-your-own-sentiment-analysis-tool">#</a></h1><p>While there are a lot of tools that will automatically give us a sentiment of a piece of text, we learned that they don't always agree! Let's design our own to see both how these tools work internally, along with how we can test them to see how well they might perform.</p>
<p><strong>I've cleaned the dataset up a bit.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="reading-options">
  <a class="btn" href="/ds4j/investigating-sentiment-analysis/designing-your-own-sentiment-analysis-tool">
    <i class="fa fa-sm fa-book"></i>
    Read online
  </a>
  <a class="btn" href="/ds4j/investigating-sentiment-analysis/notebooks/Designing your own sentiment analysis tool.ipynb">
    <i class="fa fa-sm fa-download"></i>
    Download notebook
  </a>
  <a class="btn" href="#">
    <i class="fa fa-sm fa-laptop"></i>
    Interactive version
  </a>
</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># !pip install sklearn</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Training-on-tweets">Training on tweets<a class="anchor-link" href="#Training-on-tweets">#</a></h2><p>Let's say we were going to analyze the sentiment of tweets. If we had a list of tweets that were scored positive vs. negative, we could see which words are usually associated with positive scores and which are usually associated with negative scores.</p>
<p>Luckily, we have <strong>Sentiment140</strong> - <a href="http://help.sentiment140.com/for-students">http://help.sentiment140.com/for-students</a> - a list of 1.6 million tweets along with a score as to whether they're negative or positive. We'll use it to build our own machine learning algorithm to see separate positivity from negativity.</p>
<h3 id="Read-in-our-data">Read in our data<a class="anchor-link" href="#Read-in-our-data">#</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/sentiment140-subset.csv&quot;</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">30000</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>polarity</th>
      <th>text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>@kconsidder You never tweet</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>Sick today  coding from the couch.</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>@ChargerJenn Thx for answering so quick,I was ...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Wii fit says I've lost 10 pounds since last ti...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>@MrKinetik Not a thing!!!  I don't really have...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>How many rows do we have?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(30000, 2)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="What-do-our-columns-mean?">What do our columns mean?<a class="anchor-link" href="#What-do-our-columns-mean?">#</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>polarity</th>
      <th>text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>@kconsidder You never tweet</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>Sick today  coding from the couch.</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>@ChargerJenn Thx for answering so quick,I was ...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Wii fit says I've lost 10 pounds since last ti...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>@MrKinetik Not a thing!!!  I don't really have...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>How many <strong>positive</strong> tweets compared to how many <strong>negative</strong> tweets?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">polarity</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1    15064
0    14936
Name: polarity, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Vectorize-our-tweets">Vectorize our tweets<a class="anchor-link" href="#Vectorize-our-tweets">#</a></h2><p>Create a <code>TfidfVectorizer</code> and use it to vectorize our tweets. Since we don't have all the time in the world, we should probably use <code>max_features</code> to only take a selection of terms - how about 1000 for now?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vectorizer</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">max_features</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">vectors</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
<span class="n">words_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">vectors</span><span class="o">.</span><span class="n">toarray</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">())</span>
<span class="n">words_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>10</th>
      <th>100</th>
      <th>11</th>
      <th>12</th>
      <th>15</th>
      <th>1st</th>
      <th>20</th>
      <th>2day</th>
      <th>2nd</th>
      <th>30</th>
      <th>...</th>
      <th>yesterday</th>
      <th>yet</th>
      <th>yo</th>
      <th>you</th>
      <th>young</th>
      <th>your</th>
      <th>yourself</th>
      <th>youtube</th>
      <th>yum</th>
      <th>yup</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.334095</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.427465</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 1000 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Training-our-algorithm">Training our algorithm<a class="anchor-link" href="#Training-our-algorithm">#</a></h2><h3 id="Setting-up-our-variables">Setting up our variables<a class="anchor-link" href="#Setting-up-our-variables">#</a></h3><p>Because we want to fit in with all the other progammers, we need to create two variables: one called <code>X</code> and one called <code>y</code>.</p>
<p><code>X</code> is all of our <strong>features</strong>, the things we use to predict positive or negative. That's going to be our words.</p>
<p><code>y</code> is all of our <strong>labels</strong>, the positive or negative rating. We'll use the <code>polarity</code> column for that.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">words_df</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">polarity</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Picking-an-algorithm">Picking an algorithm<a class="anchor-link" href="#Picking-an-algorithm">#</a></h3><p>What kind of algorithm do we want? Who knows, we don't know anything about machine learning! <strong>Let's just pick ALL OF THEM.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">LinearSVC</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">MultinomialNB</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Training-our-algorithms">Training our algorithms<a class="anchor-link" href="#Training-our-algorithms">#</a></h3><p>When we teach our algorithm about what a positive or a negative tweet looks like, this is called <strong>training</strong>. Training can take different amounts of time based on what kind of algorithm you are using.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># Create and train a logistic regression</span>
<span class="n">logreg</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mf">1e9</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;lbfgs&#39;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">logreg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 12.7 s, sys: 193 ms, total: 12.9 s
Wall time: 7.97 s
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>LogisticRegression(C=1000000000.0, class_weight=None, dual=False,
                   fit_intercept=True, intercept_scaling=1, l1_ratio=None,
                   max_iter=1000, multi_class=&#39;warn&#39;, n_jobs=None, penalty=&#39;l2&#39;,
                   random_state=None, solver=&#39;lbfgs&#39;, tol=0.0001, verbose=0,
                   warm_start=False)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># Create and train a random forest classifier</span>
<span class="n">forest</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">forest</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 46.9 s, sys: 607 ms, total: 47.5 s
Wall time: 59.3 s
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>RandomForestClassifier(bootstrap=True, class_weight=None, criterion=&#39;gini&#39;,
                       max_depth=None, max_features=&#39;auto&#39;, max_leaf_nodes=None,
                       min_impurity_decrease=0.0, min_impurity_split=None,
                       min_samples_leaf=1, min_samples_split=2,
                       min_weight_fraction_leaf=0.0, n_estimators=50,
                       n_jobs=None, oob_score=False, random_state=None,
                       verbose=0, warm_start=False)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># Create and train a linear support vector classifier (LinearSVC)</span>
<span class="n">svc</span> <span class="o">=</span> <span class="n">LinearSVC</span><span class="p">()</span>
<span class="n">svc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 386 ms, sys: 12.9 ms, total: 399 ms
Wall time: 440 ms
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>LinearSVC(C=1.0, class_weight=None, dual=True, fit_intercept=True,
          intercept_scaling=1, loss=&#39;squared_hinge&#39;, max_iter=1000,
          multi_class=&#39;ovr&#39;, penalty=&#39;l2&#39;, random_state=None, tol=0.0001,
          verbose=0)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># Create and train a multinomial naive bayes classifier (MultinomialNB)</span>
<span class="n">bayes</span> <span class="o">=</span> <span class="n">MultinomialNB</span><span class="p">()</span>
<span class="n">bayes</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 165 ms, sys: 39.7 ms, total: 204 ms
Wall time: 239 ms
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>MultinomialNB(alpha=1.0, class_prior=None, fit_prior=True)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>How long did each take to train?</strong> How much faster were some compared to others?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Use-our-models-on-some-new-data">Use our models on some new data<a class="anchor-link" href="#Use-our-models-on-some-new-data">#</a></h1><p>Now that we've trained our models, <strong>they can try to predict whether some content is positive or negative</strong>.</p>
<p><strong>Add a few more sentences below.</strong> They should be a mix of positive and negative. They can be boring, they can be exciting, they can be short, they can be long.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create some test data</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_colwidth&quot;</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="n">unknown</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">&quot;I love love love love this kitten&quot;</span><span class="p">,</span>
    <span class="s2">&quot;I hate hate hate hate this keyboard&quot;</span><span class="p">,</span>
    <span class="s2">&quot;I&#39;m not sure how I feel about toast&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Did you see the baseball game yesterday?&quot;</span><span class="p">,</span>
    <span class="s2">&quot;The package was delivered late and the contents were broken&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Trashy television shows are some of my favorites&quot;</span><span class="p">,</span>
    <span class="s2">&quot;I&#39;m seeing a Kubrick film tomorrow, I hear not so great things about it.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;I find chirping birds irritating, but I know I&#39;m not the only one&quot;</span><span class="p">,</span>
<span class="p">]})</span>
<span class="n">unknown</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>content</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>I love love love love this kitten</td>
    </tr>
    <tr>
      <th>1</th>
      <td>I hate hate hate hate this keyboard</td>
    </tr>
    <tr>
      <th>2</th>
      <td>I'm not sure how I feel about toast</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Did you see the baseball game yesterday?</td>
    </tr>
    <tr>
      <th>4</th>
      <td>The package was delivered late and the contents were broken</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Trashy television shows are some of my favorites</td>
    </tr>
    <tr>
      <th>6</th>
      <td>I'm seeing a Kubrick film tomorrow, I hear not so great things about it.</td>
    </tr>
    <tr>
      <th>7</th>
      <td>I find chirping birds irritating, but I know I'm not the only one</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we need to <strong>vectorizer</strong> our sentences into numbers, so the algorithm can understand them.</p>
<p>Our algorithm only knows <strong>certain words.</strong> Run <code>vectorizer.get_feature_names()</code> to show you the list of the words it knows.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;10&#39;, &#39;100&#39;, &#39;11&#39;, &#39;12&#39;, &#39;15&#39;, &#39;1st&#39;, &#39;20&#39;, &#39;2day&#39;, &#39;2nd&#39;, &#39;30&#39;, &#39;able&#39;, &#39;about&#39;, &#39;account&#39;, &#39;actually&#39;, &#39;add&#39;, &#39;after&#39;, &#39;afternoon&#39;, &#39;again&#39;, &#39;ago&#39;, &#39;agree&#39;, &#39;ah&#39;, &#39;ahh&#39;, &#39;ahhh&#39;, &#39;air&#39;, &#39;album&#39;, &#39;all&#39;, &#39;almost&#39;, &#39;alone&#39;, &#39;already&#39;, &#39;alright&#39;, &#39;also&#39;, &#39;although&#39;, &#39;always&#39;, &#39;am&#39;, &#39;amazing&#39;, &#39;amp&#39;, &#39;an&#39;, &#39;and&#39;, &#39;annoying&#39;, &#39;another&#39;, &#39;any&#39;, &#39;anymore&#39;, &#39;anyone&#39;, &#39;anything&#39;, &#39;anyway&#39;, &#39;app&#39;, &#39;apparently&#39;, &#39;apple&#39;, &#39;appreciate&#39;, &#39;are&#39;, &#39;around&#39;, &#39;art&#39;, &#39;as&#39;, &#39;ask&#39;, &#39;asleep&#39;, &#39;ass&#39;, &#39;at&#39;, &#39;ate&#39;, &#39;aw&#39;, &#39;awake&#39;, &#39;awards&#39;, &#39;away&#39;, &#39;awesome&#39;, &#39;aww&#39;, &#39;awww&#39;, &#39;baby&#39;, &#39;back&#39;, &#39;bad&#39;, &#39;band&#39;, &#39;bbq&#39;, &#39;bday&#39;, &#39;be&#39;, &#39;beach&#39;, &#39;beautiful&#39;, &#39;because&#39;, &#39;bed&#39;, &#39;been&#39;, &#39;beer&#39;, &#39;before&#39;, &#39;behind&#39;, &#39;being&#39;, &#39;believe&#39;, &#39;best&#39;, &#39;bet&#39;, &#39;better&#39;, &#39;big&#39;, &#39;bike&#39;, &#39;birthday&#39;, &#39;bit&#39;, &#39;bitch&#39;, &#39;black&#39;, &#39;blip&#39;, &#39;blog&#39;, &#39;blue&#39;, &#39;body&#39;, &#39;boo&#39;, &#39;book&#39;, &#39;books&#39;, &#39;bored&#39;, &#39;boring&#39;, &#39;both&#39;, &#39;bought&#39;, &#39;bout&#39;, &#39;box&#39;, &#39;boy&#39;, &#39;boys&#39;, &#39;break&#39;, &#39;breakfast&#39;, &#39;bring&#39;, &#39;bro&#39;, &#39;broke&#39;, &#39;broken&#39;, &#39;brother&#39;, &#39;brothers&#39;, &#39;btw&#39;, &#39;bus&#39;, &#39;business&#39;, &#39;busy&#39;, &#39;but&#39;, &#39;buy&#39;, &#39;by&#39;, &#39;bye&#39;, &#39;cake&#39;, &#39;call&#39;, &#39;called&#39;, &#39;came&#39;, &#39;can&#39;, &#39;cannot&#39;, &#39;cant&#39;, &#39;car&#39;, &#39;card&#39;, &#39;care&#39;, &#39;case&#39;, &#39;cat&#39;, &#39;catch&#39;, &#39;cause&#39;, &#39;cd&#39;, &#39;chance&#39;, &#39;change&#39;, &#39;channel&#39;, &#39;chat&#39;, &#39;check&#39;, &#39;chicken&#39;, &#39;chocolate&#39;, &#39;church&#39;, &#39;city&#39;, &#39;class&#39;, &#39;clean&#39;, &#39;cleaning&#39;, &#39;close&#39;, &#39;closed&#39;, &#39;club&#39;, &#39;coffee&#39;, &#39;cold&#39;, &#39;college&#39;, &#39;com&#39;, &#39;come&#39;, &#39;comes&#39;, &#39;coming&#39;, &#39;completely&#39;, &#39;computer&#39;, &#39;concert&#39;, &#39;congrats&#39;, &#39;cool&#39;, &#39;cos&#39;, &#39;could&#39;, &#39;couldn&#39;, &#39;country&#39;, &#39;couple&#39;, &#39;course&#39;, &#39;crap&#39;, &#39;crazy&#39;, &#39;cream&#39;, &#39;cry&#39;, &#39;crying&#39;, &#39;cut&#39;, &#39;cute&#39;, &#39;cuz&#39;, &#39;da&#39;, &#39;dad&#39;, &#39;damn&#39;, &#39;dance&#39;, &#39;date&#39;, &#39;daughter&#39;, &#39;david&#39;, &#39;day&#39;, &#39;days&#39;, &#39;ddlovato&#39;, &#39;de&#39;, &#39;dead&#39;, &#39;dear&#39;, &#39;decided&#39;, &#39;definitely&#39;, &#39;did&#39;, &#39;didn&#39;, &#39;didnt&#39;, &#39;die&#39;, &#39;died&#39;, &#39;dinner&#39;, &#39;dm&#39;, &#39;do&#39;, &#39;does&#39;, &#39;doesn&#39;, &#39;doesnt&#39;, &#39;dog&#39;, &#39;doing&#39;, &#39;don&#39;, &#39;done&#39;, &#39;dont&#39;, &#39;down&#39;, &#39;download&#39;, &#39;dream&#39;, &#39;dreams&#39;, &#39;dress&#39;, &#39;drink&#39;, &#39;drinking&#39;, &#39;drive&#39;, &#39;driving&#39;, &#39;drunk&#39;, &#39;dude&#39;, &#39;due&#39;, &#39;during&#39;, &#39;each&#39;, &#39;earlier&#39;, &#39;early&#39;, &#39;easy&#39;, &#39;eat&#39;, &#39;eating&#39;, &#39;either&#39;, &#39;else&#39;, &#39;em&#39;, &#39;email&#39;, &#39;end&#39;, &#39;ended&#39;, &#39;english&#39;, &#39;enjoy&#39;, &#39;enjoyed&#39;, &#39;enjoying&#39;, &#39;enough&#39;, &#39;episode&#39;, &#39;especially&#39;, &#39;even&#39;, &#39;evening&#39;, &#39;ever&#39;, &#39;every&#39;, &#39;everybody&#39;, &#39;everyone&#39;, &#39;everything&#39;, &#39;exactly&#39;, &#39;exam&#39;, &#39;exams&#39;, &#39;except&#39;, &#39;excited&#39;, &#39;exciting&#39;, &#39;eye&#39;, &#39;eyes&#39;, &#39;face&#39;, &#39;facebook&#39;, &#39;fact&#39;, &#39;fail&#39;, &#39;fair&#39;, &#39;fall&#39;, &#39;family&#39;, &#39;fan&#39;, &#39;fans&#39;, &#39;far&#39;, &#39;fast&#39;, &#39;favorite&#39;, &#39;fb&#39;, &#39;feel&#39;, &#39;feeling&#39;, &#39;feels&#39;, &#39;feet&#39;, &#39;fell&#39;, &#39;felt&#39;, &#39;few&#39;, &#39;ff&#39;, &#39;figure&#39;, &#39;final&#39;, &#39;finally&#39;, &#39;finals&#39;, &#39;find&#39;, &#39;fine&#39;, &#39;fingers&#39;, &#39;finish&#39;, &#39;finished&#39;, &#39;fire&#39;, &#39;first&#39;, &#39;fix&#39;, &#39;flight&#39;, &#39;flu&#39;, &#39;fly&#39;, &#39;fm&#39;, &#39;follow&#39;, &#39;followers&#39;, &#39;followfriday&#39;, &#39;following&#39;, &#39;food&#39;, &#39;for&#39;, &#39;forever&#39;, &#39;forget&#39;, &#39;forgot&#39;, &#39;forward&#39;, &#39;found&#39;, &#39;free&#39;, &#39;friday&#39;, &#39;friend&#39;, &#39;friends&#39;, &#39;from&#39;, &#39;front&#39;, &#39;fuck&#39;, &#39;fucking&#39;, &#39;full&#39;, &#39;fun&#39;, &#39;funny&#39;, &#39;game&#39;, &#39;games&#39;, &#39;garden&#39;, &#39;gave&#39;, &#39;gd&#39;, &#39;get&#39;, &#39;gets&#39;, &#39;getting&#39;, &#39;girl&#39;, &#39;girls&#39;, &#39;give&#39;, &#39;glad&#39;, &#39;go&#39;, &#39;god&#39;, &#39;goes&#39;, &#39;goin&#39;, &#39;going&#39;, &#39;gone&#39;, &#39;gonna&#39;, &#39;good&#39;, &#39;goodbye&#39;, &#39;goodnight&#39;, &#39;google&#39;, &#39;got&#39;, &#39;gotta&#39;, &#39;graduation&#39;, &#39;great&#39;, &#39;green&#39;, &#39;gt&#39;, &#39;guess&#39;, &#39;guitar&#39;, &#39;guy&#39;, &#39;guys&#39;, &#39;gym&#39;, &#39;ha&#39;, &#39;had&#39;, &#39;haha&#39;, &#39;hahaha&#39;, &#39;hair&#39;, &#39;half&#39;, &#39;hand&#39;, &#39;hang&#39;, &#39;happen&#39;, &#39;happened&#39;, &#39;happens&#39;, &#39;happy&#39;, &#39;hard&#39;, &#39;has&#39;, &#39;hate&#39;, &#39;hates&#39;, &#39;have&#39;, &#39;haven&#39;, &#39;havent&#39;, &#39;having&#39;, &#39;he&#39;, &#39;head&#39;, &#39;headache&#39;, &#39;headed&#39;, &#39;heading&#39;, &#39;hear&#39;, &#39;heard&#39;, &#39;heart&#39;, &#39;hehe&#39;, &#39;hell&#39;, &#39;hello&#39;, &#39;help&#39;, &#39;her&#39;, &#39;here&#39;, &#39;hey&#39;, &#39;hi&#39;, &#39;high&#39;, &#39;him&#39;, &#39;his&#39;, &#39;history&#39;, &#39;hit&#39;, &#39;hmm&#39;, &#39;holiday&#39;, &#39;home&#39;, &#39;homework&#39;, &#39;hope&#39;, &#39;hopefully&#39;, &#39;hoping&#39;, &#39;horrible&#39;, &#39;hot&#39;, &#39;hotel&#39;, &#39;hour&#39;, &#39;hours&#39;, &#39;house&#39;, &#39;how&#39;, &#39;http&#39;, &#39;hubby&#39;, &#39;hug&#39;, &#39;huge&#39;, &#39;hugs&#39;, &#39;hun&#39;, &#39;hungry&#39;, &#39;hurt&#39;, &#39;hurts&#39;, &#39;ice&#39;, &#39;idea&#39;, &#39;idk&#39;, &#39;if&#39;, &#39;ill&#39;, &#39;im&#39;, &#39;in&#39;, &#39;inside&#39;, &#39;instead&#39;, &#39;interesting&#39;, &#39;internet&#39;, &#39;into&#39;, &#39;iphone&#39;, &#39;ipod&#39;, &#39;is&#39;, &#39;isn&#39;, &#39;isnt&#39;, &#39;it&#39;, &#39;its&#39;, &#39;ive&#39;, &#39;jealous&#39;, &#39;job&#39;, &#39;join&#39;, &#39;jonas&#39;, &#39;jonasbrothers&#39;, &#39;july&#39;, &#39;june&#39;, &#39;jus&#39;, &#39;just&#39;, &#39;keep&#39;, &#39;keeps&#39;, &#39;kid&#39;, &#39;kids&#39;, &#39;kill&#39;, &#39;kind&#39;, &#39;kinda&#39;, &#39;knew&#39;, &#39;know&#39;, &#39;knows&#39;, &#39;la&#39;, &#39;lady&#39;, &#39;lakers&#39;, &#39;lame&#39;, &#39;laptop&#39;, &#39;last&#39;, &#39;late&#39;, &#39;later&#39;, &#39;laugh&#39;, &#39;lazy&#39;, &#39;learn&#39;, &#39;learning&#39;, &#39;least&#39;, &#39;leave&#39;, &#39;leaving&#39;, &#39;left&#39;, &#39;less&#39;, &#39;let&#39;, &#39;lets&#39;, &#39;life&#39;, &#39;like&#39;, &#39;liked&#39;, &#39;lil&#39;, &#39;line&#39;, &#39;link&#39;, &#39;list&#39;, &#39;listen&#39;, &#39;listening&#39;, &#39;little&#39;, &#39;live&#39;, &#39;living&#39;, &#39;ll&#39;, &#39;lmao&#39;, &#39;lol&#39;, &#39;london&#39;, &#39;lonely&#39;, &#39;long&#39;, &#39;longer&#39;, &#39;look&#39;, &#39;looked&#39;, &#39;looking&#39;, &#39;looks&#39;, &#39;lost&#39;, &#39;lot&#39;, &#39;lots&#39;, &#39;love&#39;, &#39;loved&#39;, &#39;lovely&#39;, &#39;loves&#39;, &#39;loving&#39;, &#39;lt&#39;, &#39;luck&#39;, &#39;lucky&#39;, &#39;lunch&#39;, &#39;luv&#39;, &#39;ly&#39;, &#39;ma&#39;, &#39;mac&#39;, &#39;mad&#39;, &#39;made&#39;, &#39;mail&#39;, &#39;major&#39;, &#39;make&#39;, &#39;makes&#39;, &#39;making&#39;, &#39;man&#39;, &#39;many&#39;, &#39;maths&#39;, &#39;matter&#39;, &#39;may&#39;, &#39;maybe&#39;, &#39;mcfly&#39;, &#39;me&#39;, &#39;mean&#39;, &#39;means&#39;, &#39;meant&#39;, &#39;meet&#39;, &#39;meeting&#39;, &#39;message&#39;, &#39;met&#39;, &#39;might&#39;, &#39;miley&#39;, &#39;mileycyrus&#39;, &#39;mind&#39;, &#39;mine&#39;, &#39;minute&#39;, &#39;minutes&#39;, &#39;miss&#39;, &#39;missed&#39;, &#39;missing&#39;, &#39;mom&#39;, &#39;moment&#39;, &#39;monday&#39;, &#39;money&#39;, &#39;month&#39;, &#39;months&#39;, &#39;mood&#39;, &#39;moon&#39;, &#39;more&#39;, &#39;morning&#39;, &#39;most&#39;, &#39;mother&#39;, &#39;mouth&#39;, &#39;move&#39;, &#39;movie&#39;, &#39;movies&#39;, &#39;moving&#39;, &#39;mr&#39;, &#39;mtv&#39;, &#39;much&#39;, &#39;mum&#39;, &#39;music&#39;, &#39;must&#39;, &#39;my&#39;, &#39;myloc&#39;, &#39;myself&#39;, &#39;myspace&#39;, &#39;name&#39;, &#39;nap&#39;, &#39;near&#39;, &#39;need&#39;, &#39;needed&#39;, &#39;needs&#39;, &#39;never&#39;, &#39;new&#39;, &#39;news&#39;, &#39;next&#39;, &#39;nice&#39;, &#39;night&#39;, &#39;nights&#39;, &#39;nite&#39;, &#39;no&#39;, &#39;nope&#39;, &#39;not&#39;, &#39;nothing&#39;, &#39;now&#39;, &#39;number&#39;, &#39;of&#39;, &#39;off&#39;, &#39;office&#39;, &#39;oh&#39;, &#39;ohh&#39;, &#39;ok&#39;, &#39;okay&#39;, &#39;old&#39;, &#39;omg&#39;, &#39;on&#39;, &#39;once&#39;, &#39;one&#39;, &#39;ones&#39;, &#39;online&#39;, &#39;only&#39;, &#39;open&#39;, &#39;or&#39;, &#39;other&#39;, &#39;ouch&#39;, &#39;our&#39;, &#39;out&#39;, &#39;outside&#39;, &#39;over&#39;, &#39;own&#39;, &#39;packing&#39;, &#39;page&#39;, &#39;pain&#39;, &#39;paper&#39;, &#39;parents&#39;, &#39;park&#39;, &#39;part&#39;, &#39;party&#39;, &#39;pass&#39;, &#39;past&#39;, &#39;pay&#39;, &#39;peace&#39;, &#39;people&#39;, &#39;perfect&#39;, &#39;person&#39;, &#39;phone&#39;, &#39;photo&#39;, &#39;photos&#39;, &#39;pic&#39;, &#39;pick&#39;, &#39;pics&#39;, &#39;picture&#39;, &#39;pictures&#39;, &#39;pink&#39;, &#39;pizza&#39;, &#39;place&#39;, &#39;plan&#39;, &#39;plans&#39;, &#39;play&#39;, &#39;played&#39;, &#39;playing&#39;, &#39;please&#39;, &#39;pls&#39;, &#39;plurk&#39;, &#39;plus&#39;, &#39;point&#39;, &#39;pool&#39;, &#39;poor&#39;, &#39;post&#39;, &#39;posted&#39;, &#39;power&#39;, &#39;ppl&#39;, &#39;pretty&#39;, &#39;probably&#39;, &#39;problem&#39;, &#39;profile&#39;, &#39;project&#39;, &#39;proud&#39;, &#39;put&#39;, &#39;quite&#39;, &#39;quot&#39;, &#39;radio&#39;, &#39;rain&#39;, &#39;raining&#39;, &#39;rainy&#39;, &#39;random&#39;, &#39;rather&#39;, &#39;re&#39;, &#39;read&#39;, &#39;reading&#39;, &#39;ready&#39;, &#39;real&#39;, &#39;realized&#39;, &#39;really&#39;, &#39;reason&#39;, &#39;red&#39;, &#39;relaxing&#39;, &#39;remember&#39;, &#39;reply&#39;, &#39;rest&#39;, &#39;revision&#39;, &#39;ride&#39;, &#39;right&#39;, &#39;rip&#39;, &#39;road&#39;, &#39;rock&#39;, &#39;room&#39;, &#39;run&#39;, &#39;running&#39;, &#39;sad&#39;, &#39;sadly&#39;, &#39;safe&#39;, &#39;said&#39;, &#39;same&#39;, &#39;sat&#39;, &#39;saturday&#39;, &#39;save&#39;, &#39;saw&#39;, &#39;say&#39;, &#39;saying&#39;, &#39;says&#39;, &#39;scared&#39;, &#39;scary&#39;, &#39;school&#39;, &#39;season&#39;, &#39;second&#39;, &#39;see&#39;, &#39;seeing&#39;, &#39;seem&#39;, &#39;seems&#39;, &#39;seen&#39;, &#39;send&#39;, &#39;sent&#39;, &#39;seriously&#39;, &#39;set&#39;, &#39;shall&#39;, &#39;shame&#39;, &#39;share&#39;, &#39;she&#39;, &#39;shirt&#39;, &#39;shit&#39;, &#39;shoes&#39;, &#39;shop&#39;, &#39;shopping&#39;, &#39;short&#39;, &#39;should&#39;, &#39;show&#39;, &#39;shower&#39;, &#39;shows&#39;, &#39;sick&#39;, &#39;side&#39;, &#39;sigh&#39;, &#39;sign&#39;, &#39;silly&#39;, &#39;sims&#39;, &#39;since&#39;, &#39;singing&#39;, &#39;sister&#39;, &#39;site&#39;, &#39;sitting&#39;, &#39;sleep&#39;, &#39;sleeping&#39;, &#39;sleepy&#39;, &#39;slept&#39;, &#39;slow&#39;, &#39;small&#39;, &#39;smile&#39;, &#39;so&#39;, &#39;some&#39;, &#39;someone&#39;, &#39;something&#39;, &#39;sometimes&#39;, &#39;son&#39;, &#39;song&#39;, &#39;songs&#39;, &#39;soo&#39;, &#39;soon&#39;, &#39;sooo&#39;, &#39;soooo&#39;, &#39;sore&#39;, &#39;sorry&#39;, &#39;sound&#39;, &#39;sounds&#39;, &#39;special&#39;, &#39;spend&#39;, &#39;spending&#39;, &#39;spent&#39;, &#39;star&#39;, &#39;start&#39;, &#39;started&#39;, &#39;starting&#39;, &#39;starts&#39;, &#39;stay&#39;, &#39;still&#39;, &#39;stomach&#39;, &#39;stop&#39;, &#39;store&#39;, &#39;story&#39;, &#39;straight&#39;, &#39;stuck&#39;, &#39;study&#39;, &#39;studying&#39;, &#39;stuff&#39;, &#39;stupid&#39;, &#39;such&#39;, &#39;suck&#39;, &#39;sucks&#39;, &#39;summer&#39;, &#39;sun&#39;, &#39;sunday&#39;, &#39;sunny&#39;, &#39;sunshine&#39;, &#39;super&#39;, &#39;support&#39;, &#39;supposed&#39;, &#39;sure&#39;, &#39;sweet&#39;, &#39;take&#39;, &#39;takes&#39;, &#39;taking&#39;, &#39;talk&#39;, &#39;talking&#39;, &#39;taylor&#39;, &#39;tea&#39;, &#39;team&#39;, &#39;tell&#39;, &#39;test&#39;, &#39;text&#39;, &#39;than&#39;, &#39;thank&#39;, &#39;thanks&#39;, &#39;that&#39;, &#39;thats&#39;, &#39;the&#39;, &#39;their&#39;, &#39;them&#39;, &#39;then&#39;, &#39;there&#39;, &#39;these&#39;, &#39;they&#39;, &#39;thing&#39;, &#39;things&#39;, &#39;think&#39;, &#39;thinking&#39;, &#39;thinks&#39;, &#39;this&#39;, &#39;tho&#39;, &#39;those&#39;, &#39;though&#39;, &#39;thought&#39;, &#39;three&#39;, &#39;throat&#39;, &#39;through&#39;, &#39;thru&#39;, &#39;thursday&#39;, &#39;thx&#39;, &#39;tickets&#39;, &#39;til&#39;, &#39;till&#39;, &#39;time&#39;, &#39;times&#39;, &#39;tinyurl&#39;, &#39;tired&#39;, &#39;to&#39;, &#39;today&#39;, &#39;together&#39;, &#39;told&#39;, &#39;tom&#39;, &#39;tommcfly&#39;, &#39;tomorrow&#39;, &#39;tonight&#39;, &#39;too&#39;, &#39;took&#39;, &#39;top&#39;, &#39;totally&#39;, &#39;tour&#39;, &#39;town&#39;, &#39;traffic&#39;, &#39;train&#39;, &#39;tried&#39;, &#39;trip&#39;, &#39;true&#39;, &#39;try&#39;, &#39;trying&#39;, &#39;tuesday&#39;, &#39;turn&#39;, &#39;tv&#39;, &#39;tweet&#39;, &#39;tweeting&#39;, &#39;tweets&#39;, &#39;twilight&#39;, &#39;twitpic&#39;, &#39;twitter&#39;, &#39;two&#39;, &#39;ugh&#39;, &#39;uk&#39;, &#39;under&#39;, &#39;understand&#39;, &#39;unfortunately&#39;, &#39;until&#39;, &#39;up&#39;, &#39;update&#39;, &#39;updates&#39;, &#39;upset&#39;, &#39;ur&#39;, &#39;us&#39;, &#39;use&#39;, &#39;used&#39;, &#39;using&#39;, &#39;vacation&#39;, &#39;ve&#39;, &#39;vegas&#39;, &#39;version&#39;, &#39;very&#39;, &#39;via&#39;, &#39;video&#39;, &#39;visit&#39;, &#39;voice&#39;, &#39;wait&#39;, &#39;waiting&#39;, &#39;wake&#39;, &#39;walk&#39;, &#39;wanna&#39;, &#39;want&#39;, &#39;wanted&#39;, &#39;wants&#39;, &#39;warm&#39;, &#39;was&#39;, &#39;wasn&#39;, &#39;watch&#39;, &#39;watched&#39;, &#39;watching&#39;, &#39;water&#39;, &#39;way&#39;, &#39;we&#39;, &#39;wear&#39;, &#39;weather&#39;, &#39;website&#39;, &#39;wedding&#39;, &#39;wednesday&#39;, &#39;week&#39;, &#39;weekend&#39;, &#39;weeks&#39;, &#39;weird&#39;, &#39;welcome&#39;, &#39;well&#39;, &#39;went&#39;, &#39;were&#39;, &#39;what&#39;, &#39;whats&#39;, &#39;when&#39;, &#39;where&#39;, &#39;which&#39;, &#39;while&#39;, &#39;white&#39;, &#39;who&#39;, &#39;whole&#39;, &#39;why&#39;, &#39;wife&#39;, &#39;will&#39;, &#39;win&#39;, &#39;wine&#39;, &#39;wish&#39;, &#39;wishes&#39;, &#39;wishing&#39;, &#39;wit&#39;, &#39;with&#39;, &#39;without&#39;, &#39;woke&#39;, &#39;won&#39;, &#39;wonder&#39;, &#39;wonderful&#39;, &#39;wondering&#39;, &#39;wont&#39;, &#39;woo&#39;, &#39;word&#39;, &#39;words&#39;, &#39;work&#39;, &#39;worked&#39;, &#39;working&#39;, &#39;works&#39;, &#39;world&#39;, &#39;worried&#39;, &#39;worry&#39;, &#39;worse&#39;, &#39;worst&#39;, &#39;worth&#39;, &#39;would&#39;, &#39;wouldn&#39;, &#39;wow&#39;, &#39;write&#39;, &#39;writing&#39;, &#39;wrong&#39;, &#39;wtf&#39;, &#39;www&#39;, &#39;xd&#39;, &#39;xoxo&#39;, &#39;xx&#39;, &#39;xxx&#39;, &#39;ya&#39;, &#39;yay&#39;, &#39;yea&#39;, &#39;yeah&#39;, &#39;year&#39;, &#39;years&#39;, &#39;yep&#39;, &#39;yes&#39;, &#39;yesterday&#39;, &#39;yet&#39;, &#39;yo&#39;, &#39;you&#39;, &#39;young&#39;, &#39;your&#39;, &#39;yourself&#39;, &#39;youtube&#39;, &#39;yum&#39;, &#39;yup&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Usually when we use the vectorizer, we write code like this:</p>
<div class="highlight"><pre><span></span><span class="n">vectors</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="o">....</span><span class="p">)</span>
</pre></div>
<p>Which both learns all the words <strong>and</strong> counts them. In this case <strong>we already have the list of words we know, we only want to count them.</strong> So instead of <code>.fit_transform</code>, we just use <code>.transform</code>:</p>
<div class="highlight"><pre><span></span><span class="n">unknown_vectors</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">unknown</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
<span class="n">unknown_words_df</span> <span class="o">=</span> <span class="o">......</span>
</pre></div>
<p>Finish making your <code>unknown_words_df</code> in the cell below.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Put it through the vectoriser</span>

<span class="c1"># transform, not fit_transform, because we already learned all our words</span>
<span class="n">unknown_vectors</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">unknown</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
<span class="n">unknown_words_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">unknown_vectors</span><span class="o">.</span><span class="n">toarray</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">())</span>
<span class="n">unknown_words_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>10</th>
      <th>100</th>
      <th>11</th>
      <th>12</th>
      <th>15</th>
      <th>1st</th>
      <th>20</th>
      <th>2day</th>
      <th>2nd</th>
      <th>30</th>
      <th>...</th>
      <th>yesterday</th>
      <th>yet</th>
      <th>yo</th>
      <th>you</th>
      <th>young</th>
      <th>your</th>
      <th>yourself</th>
      <th>youtube</th>
      <th>yum</th>
      <th>yup</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.537291</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.244939</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 1000 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Confirm <code>unknown_words_df</code> is 11 rows and 2,000 columns.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">unknown_words_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(8, 1000)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Predicting-with-our-models">Predicting with our models<a class="anchor-link" href="#Predicting-with-our-models">#</a></h3><p>To make a prediction for each of our sentences, you can use <code>.predict</code> with each of our models. For example, it would look like this for linear regression:</p>
<div class="highlight"><pre><span></span><span class="n">unknown</span><span class="p">[</span><span class="s1">&#39;pred_logreg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">logreg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">unknown_words_df</span><span class="p">)</span>
</pre></div>
<p>To add the prediction for logistic regression, you'd run similar <code>.predict</code> code, which will give you a <code>0</code> (negative) or a <code>1</code> (positive). A difference between the two is that for logistic regression, you can <strong>also ask for the probability that the sentence is in the <code>1</code> category</strong> instead of just simply the category. To do that, you use this code:</p>
<div class="highlight"><pre><span></span><span class="n">unknown</span><span class="p">[</span><span class="s1">&#39;pred_logreg_prob&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">linreg</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">unknown_words_df</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
<p><strong>Add new columns for each of the models you trained.</strong> If the model has a <code>.predict_proba</code>, add that as a column as well.</p>
<ul>
<li><strong>Tip:</strong> Tab is helpful for knowing whether <code>.predict_proba</code> is an option.</li>
<li><strong>Tip:</strong> Don't forget the <code>[:,1]</code> after <code>.predict_proba</code>, it means "give me the probability for category <code>1</code></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Predict using all our models. </span>

<span class="c1"># Logistic Regression predictions + probabilities</span>
<span class="n">unknown</span><span class="p">[</span><span class="s1">&#39;pred_logreg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">logreg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">unknown_words_df</span><span class="p">)</span>
<span class="n">unknown</span><span class="p">[</span><span class="s1">&#39;pred_logreg_proba&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">logreg</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">unknown_words_df</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Random forest predictions + probabilities</span>
<span class="n">unknown</span><span class="p">[</span><span class="s1">&#39;pred_forest&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">forest</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">unknown_words_df</span><span class="p">)</span>
<span class="n">unknown</span><span class="p">[</span><span class="s1">&#39;pred_forest_proba&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">forest</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">unknown_words_df</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># SVC predictions</span>
<span class="n">unknown</span><span class="p">[</span><span class="s1">&#39;pred_svc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">svc</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">unknown_words_df</span><span class="p">)</span>

<span class="c1"># Bayes predictions + probabilities</span>
<span class="n">unknown</span><span class="p">[</span><span class="s1">&#39;pred_bayes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bayes</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">unknown_words_df</span><span class="p">)</span>
<span class="n">unknown</span><span class="p">[</span><span class="s1">&#39;pred_bayes_proba&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bayes</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">unknown_words_df</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">unknown</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>content</th>
      <th>pred_logreg</th>
      <th>pred_logreg_proba</th>
      <th>pred_forest</th>
      <th>pred_forest_proba</th>
      <th>pred_svc</th>
      <th>pred_bayes</th>
      <th>pred_bayes_proba</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>I love love love love this kitten</td>
      <td>1</td>
      <td>0.950442</td>
      <td>1</td>
      <td>0.84919</td>
      <td>1</td>
      <td>1</td>
      <td>0.747222</td>
    </tr>
    <tr>
      <th>1</th>
      <td>I hate hate hate hate this keyboard</td>
      <td>0</td>
      <td>0.009593</td>
      <td>0</td>
      <td>0.00000</td>
      <td>0</td>
      <td>0</td>
      <td>0.122383</td>
    </tr>
    <tr>
      <th>2</th>
      <td>I'm not sure how I feel about toast</td>
      <td>0</td>
      <td>0.180952</td>
      <td>0</td>
      <td>0.22000</td>
      <td>0</td>
      <td>0</td>
      <td>0.416819</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Did you see the baseball game yesterday?</td>
      <td>1</td>
      <td>0.615063</td>
      <td>1</td>
      <td>0.56000</td>
      <td>1</td>
      <td>1</td>
      <td>0.509662</td>
    </tr>
    <tr>
      <th>4</th>
      <td>The package was delivered late and the contents were broken</td>
      <td>0</td>
      <td>0.058171</td>
      <td>0</td>
      <td>0.38000</td>
      <td>0</td>
      <td>0</td>
      <td>0.219788</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Trashy television shows are some of my favorites</td>
      <td>0</td>
      <td>0.330293</td>
      <td>0</td>
      <td>0.29500</td>
      <td>0</td>
      <td>1</td>
      <td>0.534234</td>
    </tr>
    <tr>
      <th>6</th>
      <td>I'm seeing a Kubrick film tomorrow, I hear not so great things about it.</td>
      <td>1</td>
      <td>0.558548</td>
      <td>0</td>
      <td>0.34000</td>
      <td>1</td>
      <td>1</td>
      <td>0.533493</td>
    </tr>
    <tr>
      <th>7</th>
      <td>I find chirping birds irritating, but I know I'm not the only one</td>
      <td>0</td>
      <td>0.060122</td>
      <td>0</td>
      <td>0.38000</td>
      <td>0</td>
      <td>0</td>
      <td>0.295739</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Questions">Questions<a class="anchor-link" href="#Questions">#</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>What do the numbers mean? What's the difference between a 0 and a 1? A 0.5? Negative numbers?</li>
<li>Were there any sentences where the classifiers seemed to disagree about? How do you feel about the amount they disagree? </li>
<li>What's the difference between using a 0/1 to talk about sentiment compared to 0-1? When might you use one compared to another?</li>
<li>What's the difference between the linear regression model and the other models we're using? Why might it fit or not fit?</li>
<li>Between 0-1, what range do you think counts as "negative," "positive" and "neutral"?</li>
<li>Does the variation in scores reflect the variation you would see among people? Or is it better or worse?</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Maybe-we-should-have-tested-this?">Maybe we should have tested this?<a class="anchor-link" href="#Maybe-we-should-have-tested-this?">#</a></h2><p>We can actually see <strong>which model performs the best!</strong> Remember how we trained our models on tweets? We can ask each model about each tweet, and see if it gets the right answer.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>polarity</th>
      <th>text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>@kconsidder You never tweet</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>Sick today  coding from the couch.</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>@ChargerJenn Thx for answering so quick,I was afraid I was gonna crash twitter with all the spamming I did 2 RR..sorry bout that</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Wii fit says I've lost 10 pounds since last time</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>@MrKinetik Not a thing!!!  I don't really have a life.....</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our original dataframe is a list of many, many tweets. We turned this into <code>X</code> - vectorized words - and <code>y</code> - whether the tweet is negative or positive.</p>
<p>Before we used <code>.fit(X, y)</code> to train on all of our data. Instead, <strong>we can test our models</strong> by doing a test/train split and see if the predictions match the actual labels.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training logistic regression&quot;</span><span class="p">)</span>
<span class="n">logreg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training random forest&quot;</span><span class="p">)</span>
<span class="n">forest</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training SVC&quot;</span><span class="p">)</span>
<span class="n">svc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training Naive Bayes&quot;</span><span class="p">)</span>
<span class="n">bayes</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Training logistic regression
Training random forest
Training SVC
Training Naive Bayes
CPU times: user 37.7 s, sys: 415 ms, total: 38.1 s
Wall time: 35.2 s
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>MultinomialNB(alpha=1.0, class_prior=None, fit_prior=True)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Confusion-matrices">Confusion matrices<a class="anchor-link" href="#Confusion-matrices">#</a></h2><p>To see how well they did, we'll use a <a href="https://en.wikipedia.org/wiki/Confusion_matrix">"confusion matrix"</a> for each one. I think confusion matrices are called that because they are confusing.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Logistic-Regression">Logistic Regression<a class="anchor-link" href="#Logistic-Regression">#</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">logreg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">label_names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;negative&#39;</span><span class="p">,</span> <span class="s1">&#39;positive&#39;</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span>
     <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Predicted &#39;</span> <span class="o">+</span> <span class="n">label_names</span><span class="p">,</span>
     <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Is &#39;</span> <span class="o">+</span> <span class="n">label_names</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Predicted negative</th>
      <th>Predicted positive</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Is negative</th>
      <td>2723</td>
      <td>1003</td>
    </tr>
    <tr>
      <th>Is positive</th>
      <td>882</td>
      <td>2892</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Random-forest">Random forest<a class="anchor-link" href="#Random-forest">#</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forest</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">label_names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;negative&#39;</span><span class="p">,</span> <span class="s1">&#39;positive&#39;</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span>
     <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Predicted &#39;</span> <span class="o">+</span> <span class="n">label_names</span><span class="p">,</span>
     <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Is &#39;</span> <span class="o">+</span> <span class="n">label_names</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Predicted negative</th>
      <th>Predicted positive</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Is negative</th>
      <td>2801</td>
      <td>925</td>
    </tr>
    <tr>
      <th>Is positive</th>
      <td>1116</td>
      <td>2658</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="SVC">SVC<a class="anchor-link" href="#SVC">#</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">svc</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">label_names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;negative&#39;</span><span class="p">,</span> <span class="s1">&#39;positive&#39;</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span>
     <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Predicted &#39;</span> <span class="o">+</span> <span class="n">label_names</span><span class="p">,</span>
     <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Is &#39;</span> <span class="o">+</span> <span class="n">label_names</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Predicted negative</th>
      <th>Predicted positive</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Is negative</th>
      <td>2723</td>
      <td>1003</td>
    </tr>
    <tr>
      <th>Is positive</th>
      <td>879</td>
      <td>2895</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Multinomial-Naive-Bayes">Multinomial Naive Bayes<a class="anchor-link" href="#Multinomial-Naive-Bayes">#</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">bayes</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">label_names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;negative&#39;</span><span class="p">,</span> <span class="s1">&#39;positive&#39;</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span>
     <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Predicted &#39;</span> <span class="o">+</span> <span class="n">label_names</span><span class="p">,</span>
     <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Is &#39;</span> <span class="o">+</span> <span class="n">label_names</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Predicted negative</th>
      <th>Predicted positive</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Is negative</th>
      <td>2790</td>
      <td>936</td>
    </tr>
    <tr>
      <th>Is positive</th>
      <td>1016</td>
      <td>2758</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Percentage-based-confusion-matrices">Percentage-based confusion matrices<a class="anchor-link" href="#Percentage-based-confusion-matrices">#</a></h2><p>Those are kind of irritating in that they're just numbers. Let's try percentages instead</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Logisitic">Logisitic<a class="anchor-link" href="#Logisitic">#</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">logreg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">label_names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;negative&#39;</span><span class="p">,</span> <span class="s1">&#39;positive&#39;</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span>
     <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Predicted &#39;</span> <span class="o">+</span> <span class="n">label_names</span><span class="p">,</span>
     <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Is &#39;</span> <span class="o">+</span> <span class="n">label_names</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Predicted negative</th>
      <th>Predicted positive</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Is negative</th>
      <td>0.730811</td>
      <td>0.265766</td>
    </tr>
    <tr>
      <th>Is positive</th>
      <td>0.236715</td>
      <td>0.766296</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">logreg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">label_names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;negative&#39;</span><span class="p">,</span> <span class="s1">&#39;positive&#39;</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span>
     <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Predicted &#39;</span> <span class="o">+</span> <span class="n">label_names</span><span class="p">,</span>
     <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Is &#39;</span> <span class="o">+</span> <span class="n">label_names</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Predicted negative</th>
      <th>Predicted positive</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Is negative</th>
      <td>0.730811</td>
      <td>0.269189</td>
    </tr>
    <tr>
      <th>Is positive</th>
      <td>0.233704</td>
      <td>0.766296</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Random-forest">Random forest<a class="anchor-link" href="#Random-forest">#</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forest</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">label_names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;negative&#39;</span><span class="p">,</span> <span class="s1">&#39;positive&#39;</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span>
     <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Predicted &#39;</span> <span class="o">+</span> <span class="n">label_names</span><span class="p">,</span>
     <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Is &#39;</span> <span class="o">+</span> <span class="n">label_names</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Predicted negative</th>
      <th>Predicted positive</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Is negative</th>
      <td>0.751744</td>
      <td>0.248256</td>
    </tr>
    <tr>
      <th>Is positive</th>
      <td>0.295707</td>
      <td>0.704293</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="SVC">SVC<a class="anchor-link" href="#SVC">#</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">svc</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">label_names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;negative&#39;</span><span class="p">,</span> <span class="s1">&#39;positive&#39;</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span>
     <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Predicted &#39;</span> <span class="o">+</span> <span class="n">label_names</span><span class="p">,</span>
     <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Is &#39;</span> <span class="o">+</span> <span class="n">label_names</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Predicted negative</th>
      <th>Predicted positive</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Is negative</th>
      <td>0.730811</td>
      <td>0.269189</td>
    </tr>
    <tr>
      <th>Is positive</th>
      <td>0.232909</td>
      <td>0.767091</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Multinomial-Naive-Bayes">Multinomial Naive Bayes<a class="anchor-link" href="#Multinomial-Naive-Bayes">#</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">bayes</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">label_names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;negative&#39;</span><span class="p">,</span> <span class="s1">&#39;positive&#39;</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span>
     <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Predicted &#39;</span> <span class="o">+</span> <span class="n">label_names</span><span class="p">,</span>
     <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Is &#39;</span> <span class="o">+</span> <span class="n">label_names</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Predicted negative</th>
      <th>Predicted positive</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Is negative</th>
      <td>0.748792</td>
      <td>0.251208</td>
    </tr>
    <tr>
      <th>Is positive</th>
      <td>0.269210</td>
      <td>0.730790</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Review">Review<a class="anchor-link" href="#Review">#</a></h2><p>If you find yourself unsatisfied with a tool, you can try to build your own! This is exactly what we tried to do, using the <strong>Sentiment140 dataset</strong> and several machine learning algorithms.</p>
<p>Sentiment140 is a database of tweets that come pre-labeled with positive or negative sentiment, assigned automatically by presence of a <code>:)</code> or <code>:(</code>.  Our first step was using a <strong>vectorizer</strong> to convert the tweets into numbers a computer could understand.</p>
<p>After that, we build four different <strong>models</strong> using different machine learning algorithms. Each one was fed a list of each tweet's <strong>features</strong> - the words - and each tweet's <strong>label</strong> - the sentiment - in the hopes that later it could predict labels if given a new tweets. This process of teaching the algorithm is called <strong>training</strong>.</p>
<p>In order to test our algorithms, we split our data into sections - <strong>train</strong> and <strong>test</strong> datasts. You teach the algorithm with the first group, and then ask it for predictions on the second set. You can then compare its predictions to the right answers using a <strong>confusion matrix</strong>.</p>
<p>Although <strong>different algorithms took different amounts of time to train</strong>, they all ended up with about 70-75% accuracy.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Discussion-topics">Discussion topics<a class="anchor-link" href="#Discussion-topics">#</a></h2><ul>
<li>Which models performed the best? Were there big differences?</li>
<li>Do you think it's more important to be sensitive to negativity or positivity? Do we want more positive things incorrectly marked as negative, or more negative things marked as positive?</li>
<li>They all had very different training times. Which ones offer the best combination of performance and not making you wait around for an hour?</li>
<li>If you have a decent algorithm that trains more quickly, that could that mean about feature selection or the size of your training set? Why did we use <code>max_features=</code> and <code>df.sample</code>?</li>
<li>Is 75% accuracy good?</li>
<li>Do your feelings change if the performance is described as "incorrect one out of every four times?"</li>
<li>What would your accuracy be for a random guess?</li>
<li>How do you feel about sentiment analysis?</li>
<li>How do you feel about <a href="https://www.nytimes.com/interactive/2017/02/28/upshot/trump-sounds-different-tone-in-first-address-to-congress.html">this piece from the UpShot</a> that uses <a href="http://saifmohammad.com/WebPages/NRC-Emotion-Lexicon.htm">the Emotional Lexicon</a>?</li>
<li>What would you feel comfortable using our sentiment classifier for?</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
 


    </div>
  </div>
</div>

<script>
  [...document.querySelectorAll(".code_cell")].filter(cell => cell.innerText.trim().length === 0).forEach(cell => cell.remove())
</script>

  <div class="footer bg-secondary">
  <div class="content">
    <div class="columns">
      <div class="column col-6 col-sm-12">
        <p><strong>Hi, welcome to Data Science for Journalism!</strong></p>
        <p>There's been a lot of buzz about machine learning and "artificial intelligence" being used in stories over
          the past few years. It's mostly not that complicated - a little stats, a classifier here or there - but it's
          hard to know where to start without a little help.</p>
        <p>Hopefully this site can be that help! <a href="/ds4j/about">Learn more about this project here.</a></p>
      </div>
      <div class="column col-3 col-sm-6">
        <p><strong>Quick links</strong></p>
        <!-- <p><a href="#">Something here</a></p>
        <p><a href="#">Something here</a></p>
        <p><a href="#">Something here</a></p> -->
      </div>
      <div class="column col-3 col-sm6">
        <p><strong>Contact</strong></p>
        <p><a href="mailto:hello@littlecolumns.com">hello@littlecolumns.com</a></p>
      </div>
    </div>
  </div>
</div>
  <script src="/ds4j/js/tocbot.js"></script>

  <script>
    try {
      let toc = document.createElement("div")
      toc.setAttribute('class', 'js-toc')
      document.querySelector(".reading-options").parentNode.appendChild(toc)
    } catch (err) {

    }

    // Chapter TOC
    tocbot.init({
      // Where to render the table of contents.
      tocSelector: '.js-toc',
      // Where to grab the headings to build the table of contents.
      contentSelector: '.notebook',
      // Which headings to grab inside of the contentSelector element.
      headingSelector: 'h1, h2, h3, h4',
      activeLinkClass: 'active',
      listClass: 'nav',
      listItemClass: 'nav-item',
      headingLabelCallback: function (label) {
        return label.replace("#", "")
      }
    });
  </script>

</body>

</html>
<!doctype html>
<html lang="en-US">

<head>
  <meta charset="utf-8">
  <title>02 - Create make model weights csv</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" rel="stylesheet">
  <!-- <link href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Raleway:400,700|Open+Sans:400,700&display=swap" rel="stylesheet"> -->
  <link rel="stylesheet" href="/ds4j/css/spectre.min.css">
  <link rel="stylesheet" href="/ds4j/css/spectre-exp.min.css">
  <link rel="stylesheet" href="/ds4j/css/spectre-icons.min.css">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="/ds4j/css/style.css" rel="stylesheet">
  <link href="/ds4j/css/highlight.css" rel="stylesheet">
</head>

<body>
  <div class="nav-holder bg-secondary">
  <div class='content'>
    <header class="navbar">
      <section class="navbar-section">
        <a href="/ds4j/" class="navbar-brand mr-2">DS4J</a>
      </section>
      <section class="navbar-section">
        <a href="/ds4j/projects" class="btn btn-link">Projects</a>
        <a href="/ds4j/topics" class="btn btn-link">Topics</a>
        <a href="/ds4j/curriculum" class="btn btn-link">Curriculum</a>
        <a href="/ds4j/about" class="btn btn-link">About</a>
      </section>
    </header>
  </div>
</div>
  
<div class="content text-based">
  <div class="columns">
    <div class="column col-12 notebook">
      <ul class="breadcrumb">
        <li class="breadcrumb-item">
          <a href="#">Projects</a>
        </li>
        <li class="breadcrumb-item">
          <a href="/ds4j/car-crashes-weight-regression/">Analyzing whether larger cars cause more deadly crashes</a>
        </li>
        <li class="breadcrumb-item">
          <a href="/ds4j/car-crashes-weight-regression/02-create-make-model-weights-csv">02 - Create make model weights csv</a>
        </li>
      </ul>

      <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Cleaning-up-our-vehicle-weight-data">Cleaning up our vehicle weight data<a class="anchor-link" href="#Cleaning-up-our-vehicle-weight-data">#</a></h1><p>Before we can analyze our data, we'll need to combine vehicle weights with makes and models, as well as clean up the results a bit.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="reading-options">
  <a class="btn" href="/ds4j/car-crashes-weight-regression/02-create-make-model-weights-csv">
    <i class="fa fa-sm fa-book"></i>
    Read online
  </a>
  <a class="btn" href="/ds4j/car-crashes-weight-regression/notebooks/02 - Create make model weights csv.ipynb">
    <i class="fa fa-sm fa-download"></i>
    Download notebook
  </a>
  <a class="btn" href="#">
    <i class="fa fa-sm fa-laptop"></i>
    Interactive version
  </a>
</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Read-in-all-of-the-vehicle-weight-csv-files">Read in all of the vehicle weight csv files<a class="anchor-link" href="#Read-in-all-of-the-vehicle-weight-csv-files">#</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">filenames</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;vehicle-data/*.csv&quot;</span><span class="p">)</span>
<span class="n">filenames</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;vehicle-data/MERCURY.csv&#39;,
 &#39;vehicle-data/LINCOLN.csv&#39;,
 &#39;vehicle-data/DELOREAN.csv&#39;,
 &#39;vehicle-data/LAMBORGHINI.csv&#39;,
 &#39;vehicle-data/SUZUKI.csv&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>60</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Anti-Brake System</th>
      <th>Curb Weight-automatic</th>
      <th>Curb Weight-manual</th>
      <th>Engine Type</th>
      <th>Front Brake Type</th>
      <th>Fuel Economy-city</th>
      <th>Fuel Economy-highway</th>
      <th>Ground Clearance</th>
      <th>Make</th>
      <th>Model</th>
      <th>Model Year</th>
      <th>Rear Brake Type</th>
      <th>Tires</th>
      <th>Transmission-long</th>
      <th>Wheelbase</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Non-ABS</td>
      <td>2500 lbs</td>
      <td>2423 lbs</td>
      <td>1.6L L4 DOHC 16V</td>
      <td>Disc</td>
      <td>23 - 25 miles/gallon</td>
      <td>26 - 31 miles/gallon</td>
      <td>NaN</td>
      <td>Mercury</td>
      <td>Capri</td>
      <td>1994</td>
      <td>Disc</td>
      <td>185/60R14</td>
      <td>4-Speed Automatic | 5-Speed Manual</td>
      <td>94.70 in.</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Non-ABS</td>
      <td>2500 lbs</td>
      <td>2423 lbs</td>
      <td>1.6L L4 DOHC 16V</td>
      <td>Disc</td>
      <td>23 - 25 miles/gallon</td>
      <td>26 - 31 miles/gallon</td>
      <td>NaN</td>
      <td>Mercury</td>
      <td>Capri</td>
      <td>1994</td>
      <td>Disc</td>
      <td>185/60R14</td>
      <td>4-Speed Automatic | 5-Speed Manual</td>
      <td>94.70 in.</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Cut-it-to-be-just-the-columns-we're-interested-in">Cut it to be just the columns we're interested in<a class="anchor-link" href="#Cut-it-to-be-just-the-columns-we're-interested-in">#</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Curb Weight-automatic&#39;</span><span class="p">,</span> <span class="s1">&#39;Curb Weight-manual&#39;</span><span class="p">,</span> <span class="s1">&#39;Make&#39;</span><span class="p">,</span> <span class="s1">&#39;Model&#39;</span><span class="p">,</span> <span class="s1">&#39;Model Year&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Curb Weight-automatic</th>
      <th>Curb Weight-manual</th>
      <th>Make</th>
      <th>Model</th>
      <th>Model Year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2500 lbs</td>
      <td>2423 lbs</td>
      <td>Mercury</td>
      <td>Capri</td>
      <td>1994</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2500 lbs</td>
      <td>2423 lbs</td>
      <td>Mercury</td>
      <td>Capri</td>
      <td>1994</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2492 lbs</td>
      <td>2404 lbs</td>
      <td>Mercury</td>
      <td>Capri</td>
      <td>1993</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2492 lbs</td>
      <td>2404 lbs</td>
      <td>Mercury</td>
      <td>Capri</td>
      <td>1993</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2492 lbs</td>
      <td>2404 lbs</td>
      <td>Mercury</td>
      <td>Capri</td>
      <td>1992</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Remove-'lbs'-from-the-weight-columns,-then-average-the-two">Remove 'lbs' from the weight columns, then average the two<a class="anchor-link" href="#Remove-'lbs'-from-the-weight-columns,-then-average-the-two">#</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Curb Weight-automatic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Curb Weight-automatic&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; lbs&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Curb Weight-manual&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Curb Weight-manual&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; lbs&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Curb Weight-automatic</th>
      <th>Curb Weight-manual</th>
      <th>Make</th>
      <th>Model</th>
      <th>Model Year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2500</td>
      <td>2423</td>
      <td>Mercury</td>
      <td>Capri</td>
      <td>1994</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2500</td>
      <td>2423</td>
      <td>Mercury</td>
      <td>Capri</td>
      <td>1994</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Average the automatic and manual weights</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Curb Weight-automatic&#39;</span><span class="p">,</span><span class="s1">&#39;Curb Weight-automatic&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Curb Weight-automatic</th>
      <th>Curb Weight-manual</th>
      <th>Make</th>
      <th>Model</th>
      <th>Model Year</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2500</td>
      <td>2423</td>
      <td>Mercury</td>
      <td>Capri</td>
      <td>1994</td>
      <td>2500.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2500</td>
      <td>2423</td>
      <td>Mercury</td>
      <td>Capri</td>
      <td>1994</td>
      <td>2500.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Curb Weight-automatic&#39;</span><span class="p">,</span> <span class="s1">&#39;Curb Weight-manual&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Make</th>
      <th>Model</th>
      <th>Model Year</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mercury</td>
      <td>Capri</td>
      <td>1994</td>
      <td>2500.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Mercury</td>
      <td>Capri</td>
      <td>1994</td>
      <td>2500.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mercury</td>
      <td>Capri</td>
      <td>1993</td>
      <td>2492.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Mercury</td>
      <td>Capri</td>
      <td>1993</td>
      <td>2492.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Mercury</td>
      <td>Capri</td>
      <td>1992</td>
      <td>2492.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Maybe-there-are-multiples-per-make/model/year,-so-we'll-average-those,-too">Maybe there are multiples per make/model/year, so we'll average those, too<a class="anchor-link" href="#Maybe-there-are-multiples-per-make/model/year,-so-we'll-average-those,-too">#</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Now let&#39;s group by make, model and year and get the average weight</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Make&#39;</span><span class="p">,</span> <span class="s1">&#39;Model&#39;</span><span class="p">,</span> <span class="s1">&#39;Model Year&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1"># Remove anything that doesn&#39;t have a weight</span>
<span class="n">weights</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Make the weights integers because we don&#39;t need that specificity</span>
<span class="n">weights</span><span class="o">.</span><span class="n">weight</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># What do we have?</span>
<span class="n">weights</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Make</th>
      <th>Model</th>
      <th>Model Year</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Acura</td>
      <td>CL</td>
      <td>1997</td>
      <td>3009</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Acura</td>
      <td>CL</td>
      <td>1998</td>
      <td>3215</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Acura</td>
      <td>CL</td>
      <td>1999</td>
      <td>3285</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Acura</td>
      <td>CL</td>
      <td>2001</td>
      <td>3470</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Acura</td>
      <td>CL</td>
      <td>2002</td>
      <td>3470</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(4323, 4)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Standardization">Standardization<a class="anchor-link" href="#Standardization">#</a></h1><p>We'll need this to match content later</p>
<ul>
<li>Rename Model Year column</li>
<li>Capitalize Make/Model</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">weights</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Model Year&#39;</span><span class="p">:</span> <span class="s1">&#39;ModelYear&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">weights</span><span class="o">.</span><span class="n">ModelYear</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">ModelYear</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">weights</span><span class="o">.</span><span class="n">Make</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">Make</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
<span class="n">weights</span><span class="o">.</span><span class="n">Model</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">Model</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Interpolate-missing-values">Interpolate missing values<a class="anchor-link" href="#Interpolate-missing-values">#</a></h1><p>Sometimes we have 2005 and 2007 but not 2006. We'll interpolate those.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Pivot so each type of car is a column</span>
<span class="n">weights_pivot</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="s2">&quot;weight&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;ModelYear&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Make&#39;</span><span class="p">,</span> <span class="s1">&#39;Model&#39;</span><span class="p">])</span>
<span class="n">weights_pivot</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>Make</th>
      <th colspan="10" halign="left">ACURA</th>
      <th>...</th>
      <th colspan="10" halign="left">VOLVO</th>
    </tr>
    <tr>
      <th>Model</th>
      <th>CL</th>
      <th>ILX</th>
      <th>INTEGRA</th>
      <th>LEGEND</th>
      <th>MDX</th>
      <th>NSX</th>
      <th>RDX</th>
      <th>RL</th>
      <th>RLX</th>
      <th>SLX</th>
      <th>...</th>
      <th>S70</th>
      <th>S80</th>
      <th>S90</th>
      <th>V40</th>
      <th>V50</th>
      <th>V60</th>
      <th>V70</th>
      <th>XC60</th>
      <th>XC70</th>
      <th>XC90</th>
    </tr>
    <tr>
      <th>ModelYear</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1988</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1989</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1990</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1991</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1992</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>2615.0</td>
      <td>3486.0</td>
      <td>NaN</td>
      <td>3098.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1993</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>2615.0</td>
      <td>3446.0</td>
      <td>NaN</td>
      <td>3097.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1994</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>2670.0</td>
      <td>3560.0</td>
      <td>NaN</td>
      <td>3109.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1995</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>2670.0</td>
      <td>3560.0</td>
      <td>NaN</td>
      <td>3208.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1996</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>2670.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3208.0</td>
      <td>NaN</td>
      <td>3660.0</td>
      <td>NaN</td>
      <td>4315.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1997</th>
      <td>3009.0</td>
      <td>NaN</td>
      <td>2703.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3069.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 649 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Interpolate missing values in those columns</span>
<span class="n">weights_pivot</span> <span class="o">=</span> <span class="n">weights_pivot</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">limit_direction</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">weights_pivot</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>Make</th>
      <th colspan="10" halign="left">ACURA</th>
      <th>...</th>
      <th colspan="10" halign="left">VOLVO</th>
    </tr>
    <tr>
      <th>Model</th>
      <th>CL</th>
      <th>ILX</th>
      <th>INTEGRA</th>
      <th>LEGEND</th>
      <th>MDX</th>
      <th>NSX</th>
      <th>RDX</th>
      <th>RL</th>
      <th>RLX</th>
      <th>SLX</th>
      <th>...</th>
      <th>S70</th>
      <th>S80</th>
      <th>S90</th>
      <th>V40</th>
      <th>V50</th>
      <th>V60</th>
      <th>V70</th>
      <th>XC60</th>
      <th>XC70</th>
      <th>XC90</th>
    </tr>
    <tr>
      <th>ModelYear</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1988</th>
      <td>3009.0</td>
      <td>2910.0</td>
      <td>2615.0</td>
      <td>3486.0</td>
      <td>4323.0</td>
      <td>3098.0</td>
      <td>3968.0</td>
      <td>3660.0</td>
      <td>3933.0</td>
      <td>4315.0</td>
      <td>...</td>
      <td>3333.0</td>
      <td>3618.0</td>
      <td>4012.0</td>
      <td>2998.0</td>
      <td>3570.0</td>
      <td>3527.0</td>
      <td>3433.0</td>
      <td>4387.0</td>
      <td>3699.0</td>
      <td>4493.0</td>
    </tr>
    <tr>
      <th>1989</th>
      <td>3009.0</td>
      <td>2910.0</td>
      <td>2615.0</td>
      <td>3486.0</td>
      <td>4323.0</td>
      <td>3098.0</td>
      <td>3968.0</td>
      <td>3660.0</td>
      <td>3933.0</td>
      <td>4315.0</td>
      <td>...</td>
      <td>3333.0</td>
      <td>3618.0</td>
      <td>4012.0</td>
      <td>2998.0</td>
      <td>3570.0</td>
      <td>3527.0</td>
      <td>3433.0</td>
      <td>4387.0</td>
      <td>3699.0</td>
      <td>4493.0</td>
    </tr>
    <tr>
      <th>1990</th>
      <td>3009.0</td>
      <td>2910.0</td>
      <td>2615.0</td>
      <td>3486.0</td>
      <td>4323.0</td>
      <td>3098.0</td>
      <td>3968.0</td>
      <td>3660.0</td>
      <td>3933.0</td>
      <td>4315.0</td>
      <td>...</td>
      <td>3333.0</td>
      <td>3618.0</td>
      <td>4012.0</td>
      <td>2998.0</td>
      <td>3570.0</td>
      <td>3527.0</td>
      <td>3433.0</td>
      <td>4387.0</td>
      <td>3699.0</td>
      <td>4493.0</td>
    </tr>
    <tr>
      <th>1991</th>
      <td>3009.0</td>
      <td>2910.0</td>
      <td>2615.0</td>
      <td>3486.0</td>
      <td>4323.0</td>
      <td>3098.0</td>
      <td>3968.0</td>
      <td>3660.0</td>
      <td>3933.0</td>
      <td>4315.0</td>
      <td>...</td>
      <td>3333.0</td>
      <td>3618.0</td>
      <td>4012.0</td>
      <td>2998.0</td>
      <td>3570.0</td>
      <td>3527.0</td>
      <td>3433.0</td>
      <td>4387.0</td>
      <td>3699.0</td>
      <td>4493.0</td>
    </tr>
    <tr>
      <th>1992</th>
      <td>3009.0</td>
      <td>2910.0</td>
      <td>2615.0</td>
      <td>3486.0</td>
      <td>4323.0</td>
      <td>3098.0</td>
      <td>3968.0</td>
      <td>3660.0</td>
      <td>3933.0</td>
      <td>4315.0</td>
      <td>...</td>
      <td>3333.0</td>
      <td>3618.0</td>
      <td>4012.0</td>
      <td>2998.0</td>
      <td>3570.0</td>
      <td>3527.0</td>
      <td>3433.0</td>
      <td>4387.0</td>
      <td>3699.0</td>
      <td>4493.0</td>
    </tr>
    <tr>
      <th>1993</th>
      <td>3009.0</td>
      <td>2910.0</td>
      <td>2615.0</td>
      <td>3446.0</td>
      <td>4323.0</td>
      <td>3097.0</td>
      <td>3968.0</td>
      <td>3660.0</td>
      <td>3933.0</td>
      <td>4315.0</td>
      <td>...</td>
      <td>3333.0</td>
      <td>3618.0</td>
      <td>4012.0</td>
      <td>2998.0</td>
      <td>3570.0</td>
      <td>3527.0</td>
      <td>3433.0</td>
      <td>4387.0</td>
      <td>3699.0</td>
      <td>4493.0</td>
    </tr>
    <tr>
      <th>1994</th>
      <td>3009.0</td>
      <td>2910.0</td>
      <td>2670.0</td>
      <td>3560.0</td>
      <td>4323.0</td>
      <td>3109.0</td>
      <td>3968.0</td>
      <td>3660.0</td>
      <td>3933.0</td>
      <td>4315.0</td>
      <td>...</td>
      <td>3333.0</td>
      <td>3618.0</td>
      <td>4012.0</td>
      <td>2998.0</td>
      <td>3570.0</td>
      <td>3527.0</td>
      <td>3433.0</td>
      <td>4387.0</td>
      <td>3699.0</td>
      <td>4493.0</td>
    </tr>
    <tr>
      <th>1995</th>
      <td>3009.0</td>
      <td>2910.0</td>
      <td>2670.0</td>
      <td>3560.0</td>
      <td>4323.0</td>
      <td>3208.0</td>
      <td>3968.0</td>
      <td>3660.0</td>
      <td>3933.0</td>
      <td>4315.0</td>
      <td>...</td>
      <td>3333.0</td>
      <td>3618.0</td>
      <td>4012.0</td>
      <td>2998.0</td>
      <td>3570.0</td>
      <td>3527.0</td>
      <td>3433.0</td>
      <td>4387.0</td>
      <td>3699.0</td>
      <td>4493.0</td>
    </tr>
    <tr>
      <th>1996</th>
      <td>3009.0</td>
      <td>2910.0</td>
      <td>2670.0</td>
      <td>3560.0</td>
      <td>4323.0</td>
      <td>3208.0</td>
      <td>3968.0</td>
      <td>3660.0</td>
      <td>3933.0</td>
      <td>4315.0</td>
      <td>...</td>
      <td>3333.0</td>
      <td>3618.0</td>
      <td>4012.0</td>
      <td>2998.0</td>
      <td>3570.0</td>
      <td>3527.0</td>
      <td>3433.0</td>
      <td>4387.0</td>
      <td>3699.0</td>
      <td>4493.0</td>
    </tr>
    <tr>
      <th>1997</th>
      <td>3009.0</td>
      <td>2910.0</td>
      <td>2703.0</td>
      <td>3560.0</td>
      <td>4323.0</td>
      <td>3069.0</td>
      <td>3968.0</td>
      <td>3609.0</td>
      <td>3933.0</td>
      <td>4465.0</td>
      <td>...</td>
      <td>3333.0</td>
      <td>3618.0</td>
      <td>4012.0</td>
      <td>2998.0</td>
      <td>3570.0</td>
      <td>3527.0</td>
      <td>3433.0</td>
      <td>4387.0</td>
      <td>3699.0</td>
      <td>4493.0</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 649 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Convert it back into the normal dataframe</span>
<span class="n">filled_in</span> <span class="o">=</span> <span class="n">weights_pivot</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">filled_in</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;weight&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">filled_in</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">filled_in</span><span class="o">.</span><span class="n">weight</span> <span class="o">=</span> <span class="n">filled_in</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">filled_in</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Make</th>
      <th>Model</th>
      <th>ModelYear</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACURA</td>
      <td>CL</td>
      <td>1988</td>
      <td>3009</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ACURA</td>
      <td>CL</td>
      <td>1989</td>
      <td>3009</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ACURA</td>
      <td>CL</td>
      <td>1990</td>
      <td>3009</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ACURA</td>
      <td>CL</td>
      <td>1991</td>
      <td>3009</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ACURA</td>
      <td>CL</td>
      <td>1992</td>
      <td>3009</td>
    </tr>
    <tr>
      <th>5</th>
      <td>ACURA</td>
      <td>CL</td>
      <td>1993</td>
      <td>3009</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ACURA</td>
      <td>CL</td>
      <td>1994</td>
      <td>3009</td>
    </tr>
    <tr>
      <th>7</th>
      <td>ACURA</td>
      <td>CL</td>
      <td>1995</td>
      <td>3009</td>
    </tr>
    <tr>
      <th>8</th>
      <td>ACURA</td>
      <td>CL</td>
      <td>1996</td>
      <td>3009</td>
    </tr>
    <tr>
      <th>9</th>
      <td>ACURA</td>
      <td>CL</td>
      <td>1997</td>
      <td>3009</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">filled_in</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(19470, 4)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Add-in-manual-work">Add in manual work<a class="anchor-link" href="#Add-in-manual-work">#</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">manual_weights</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;weights_needed_completed.csv&quot;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">manual_filled</span> <span class="o">=</span> <span class="n">manual_weights</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;make&#39;</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">limit_direction</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">manual_realigned</span> <span class="o">=</span> <span class="n">manual_filled</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;make&#39;</span><span class="p">:</span> <span class="s1">&#39;Make&#39;</span><span class="p">,</span>
    <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;Model&#39;</span><span class="p">,</span>
    <span class="s1">&#39;level_2&#39;</span><span class="p">:</span> <span class="s1">&#39;ModelYear&#39;</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;weight&#39;</span>
<span class="p">})</span>
<span class="n">filled_in</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">filled_in</span><span class="p">,</span> <span class="n">manual_realigned</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">filled_in</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Make</th>
      <th>Model</th>
      <th>ModelYear</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACURA</td>
      <td>CL</td>
      <td>1988</td>
      <td>3009.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ACURA</td>
      <td>CL</td>
      <td>1989</td>
      <td>3009.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ACURA</td>
      <td>CL</td>
      <td>1990</td>
      <td>3009.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ACURA</td>
      <td>CL</td>
      <td>1991</td>
      <td>3009.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ACURA</td>
      <td>CL</td>
      <td>1992</td>
      <td>3009.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">filled_in</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(19877, 4)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Save-the-output">Save the output<a class="anchor-link" href="#Save-the-output">#</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Let&#39;s just save it right to the data folder</span>
<span class="n">filled_in</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;data/weights.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>make</th>
      <th>CHEVROLET</th>
      <th>DODGE</th>
      <th>LEXUS</th>
      <th>HYUNDAI</th>
      <th>LEXUS</th>
      <th>CHRYSLER</th>
      <th>TOYOTA</th>
      <th>FORD</th>
      <th>GMC</th>
      <th>LINCOLN</th>
      <th>CHEVROLET</th>
    </tr>
    <tr>
      <th>model</th>
      <th>SILVERADO</th>
      <th>RAM</th>
      <th>ES</th>
      <th>SANTA FE</th>
      <th>RX</th>
      <th>TOWN AND COUNTRY</th>
      <th>4-RUNNER</th>
      <th>E-350</th>
      <th>SIERRA</th>
      <th>TOWN CAR</th>
      <th>GMT-400</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1983</th>
      <td>4200.0</td>
      <td>4800.0</td>
      <td>3300.0</td>
      <td>3600.0</td>
      <td>3700.0</td>
      <td>4200.0</td>
      <td>3800.0</td>
      <td>5000.0</td>
      <td>4200.0</td>
      <td>4000.0</td>
      <td>4300.0</td>
    </tr>
    <tr>
      <th>1984</th>
      <td>4200.0</td>
      <td>4800.0</td>
      <td>3300.0</td>
      <td>3600.0</td>
      <td>3700.0</td>
      <td>4200.0</td>
      <td>3800.0</td>
      <td>5000.0</td>
      <td>4200.0</td>
      <td>4000.0</td>
      <td>4300.0</td>
    </tr>
    <tr>
      <th>1985</th>
      <td>4200.0</td>
      <td>4800.0</td>
      <td>3300.0</td>
      <td>3600.0</td>
      <td>3700.0</td>
      <td>4200.0</td>
      <td>3800.0</td>
      <td>5000.0</td>
      <td>4200.0</td>
      <td>4000.0</td>
      <td>4300.0</td>
    </tr>
    <tr>
      <th>1986</th>
      <td>4200.0</td>
      <td>4800.0</td>
      <td>3300.0</td>
      <td>3600.0</td>
      <td>3700.0</td>
      <td>4200.0</td>
      <td>3800.0</td>
      <td>5000.0</td>
      <td>4200.0</td>
      <td>4000.0</td>
      <td>4300.0</td>
    </tr>
    <tr>
      <th>1987</th>
      <td>4200.0</td>
      <td>4800.0</td>
      <td>3300.0</td>
      <td>3600.0</td>
      <td>3700.0</td>
      <td>4200.0</td>
      <td>3800.0</td>
      <td>5000.0</td>
      <td>4200.0</td>
      <td>4000.0</td>
      <td>4300.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Make</th>
      <th>Model</th>
      <th>ModelYear</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>1983</td>
      <td>4200.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>1984</td>
      <td>4200.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>1985</td>
      <td>4200.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>1986</td>
      <td>4200.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>1987</td>
      <td>4200.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>1988</td>
      <td>4200.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>1989</td>
      <td>4200.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>1990</td>
      <td>4200.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>1991</td>
      <td>4200.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>1992</td>
      <td>4200.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>1993</td>
      <td>4200.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>1994</td>
      <td>4200.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>1995</td>
      <td>4200.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>1996</td>
      <td>4200.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>1997</td>
      <td>4200.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>1998</td>
      <td>4200.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>1999</td>
      <td>4200.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>2000</td>
      <td>4280.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>2001</td>
      <td>4360.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>2002</td>
      <td>4440.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>2003</td>
      <td>4520.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>2004</td>
      <td>4600.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>2005</td>
      <td>4700.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>2006</td>
      <td>4800.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>2007</td>
      <td>4900.0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>2008</td>
      <td>5000.0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>2009</td>
      <td>5000.0</td>
    </tr>
    <tr>
      <th>27</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>2010</td>
      <td>5000.0</td>
    </tr>
    <tr>
      <th>28</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>2011</td>
      <td>5000.0</td>
    </tr>
    <tr>
      <th>29</th>
      <td>CHEVROLET</td>
      <td>SILVERADO</td>
      <td>2012</td>
      <td>5000.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>377</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>1990</td>
      <td>4340.0</td>
    </tr>
    <tr>
      <th>378</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>1991</td>
      <td>4360.0</td>
    </tr>
    <tr>
      <th>379</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>1992</td>
      <td>4380.0</td>
    </tr>
    <tr>
      <th>380</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>1993</td>
      <td>4400.0</td>
    </tr>
    <tr>
      <th>381</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>1994</td>
      <td>4420.0</td>
    </tr>
    <tr>
      <th>382</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>1995</td>
      <td>4440.0</td>
    </tr>
    <tr>
      <th>383</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>1996</td>
      <td>4460.0</td>
    </tr>
    <tr>
      <th>384</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>1997</td>
      <td>4480.0</td>
    </tr>
    <tr>
      <th>385</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>1998</td>
      <td>4500.0</td>
    </tr>
    <tr>
      <th>386</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>1999</td>
      <td>4500.0</td>
    </tr>
    <tr>
      <th>387</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>2000</td>
      <td>4500.0</td>
    </tr>
    <tr>
      <th>388</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>2001</td>
      <td>4500.0</td>
    </tr>
    <tr>
      <th>389</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>2002</td>
      <td>4500.0</td>
    </tr>
    <tr>
      <th>390</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>2003</td>
      <td>4500.0</td>
    </tr>
    <tr>
      <th>391</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>2004</td>
      <td>4500.0</td>
    </tr>
    <tr>
      <th>392</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>2005</td>
      <td>4500.0</td>
    </tr>
    <tr>
      <th>393</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>2006</td>
      <td>4500.0</td>
    </tr>
    <tr>
      <th>394</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>2007</td>
      <td>4500.0</td>
    </tr>
    <tr>
      <th>395</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>2008</td>
      <td>4500.0</td>
    </tr>
    <tr>
      <th>396</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>2009</td>
      <td>4500.0</td>
    </tr>
    <tr>
      <th>397</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>2010</td>
      <td>4500.0</td>
    </tr>
    <tr>
      <th>398</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>2011</td>
      <td>4500.0</td>
    </tr>
    <tr>
      <th>399</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>2012</td>
      <td>4500.0</td>
    </tr>
    <tr>
      <th>400</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>2013</td>
      <td>4500.0</td>
    </tr>
    <tr>
      <th>401</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>2014</td>
      <td>4500.0</td>
    </tr>
    <tr>
      <th>402</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>2015</td>
      <td>4500.0</td>
    </tr>
    <tr>
      <th>403</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>2016</td>
      <td>4500.0</td>
    </tr>
    <tr>
      <th>404</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>2017</td>
      <td>4500.0</td>
    </tr>
    <tr>
      <th>405</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>2018</td>
      <td>4500.0</td>
    </tr>
    <tr>
      <th>406</th>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>2019</td>
      <td>4500.0</td>
    </tr>
  </tbody>
</table>
<p>407 rows × 4 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
 


    </div>
  </div>
</div>

<script>
  [...document.querySelectorAll(".code_cell")].filter(cell => cell.innerText.trim().length === 0).forEach(cell => cell.remove())
</script>

  <div class="footer bg-secondary">
  <div class="content">
    <div class="columns">
      <div class="column col-6 col-sm-12">
        <p><strong>Hi, welcome to Data Science for Journalism!</strong></p>
        <p>There's been a lot of buzz about machine learning and "artificial intelligence" being used in stories over
          the past few years. It's mostly not that complicated - a little stats, a classifier here or there - but it's
          hard to know where to start without a little help.</p>
        <p>Hopefully this site can be that help! <a href="/ds4j/about">Learn more about this project here.</a></p>
      </div>
      <div class="column col-3 col-sm-6">
        <p><strong>Quick links</strong></p>
        <!-- <p><a href="#">Something here</a></p>
        <p><a href="#">Something here</a></p>
        <p><a href="#">Something here</a></p> -->
      </div>
      <div class="column col-3 col-sm6">
        <p><strong>Contact</strong></p>
        <p><a href="mailto:hello@littlecolumns.com">hello@littlecolumns.com</a></p>
      </div>
    </div>
  </div>
</div>
  <script src="/ds4j/js/tocbot.js"></script>

  <script>
    try {
      let toc = document.createElement("div")
      toc.setAttribute('class', 'js-toc')
      document.querySelector(".reading-options").parentNode.appendChild(toc)
    } catch (err) {

    }

    // Chapter TOC
    tocbot.init({
      // Where to render the table of contents.
      tocSelector: '.js-toc',
      // Where to grab the headings to build the table of contents.
      contentSelector: '.notebook',
      // Which headings to grab inside of the contentSelector element.
      headingSelector: 'h1, h2, h3, h4',
      activeLinkClass: 'active',
      listClass: 'nav',
      listItemClass: 'nav-item',
      headingLabelCallback: function (label) {
        return label.replace("#", "")
      }
    });
  </script>

</body>

</html>
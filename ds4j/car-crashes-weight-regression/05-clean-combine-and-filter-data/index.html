<!doctype html>
<html lang="en-US">

<head>
  <meta charset="utf-8">
  <title>05 - Clean combine and filter data</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" rel="stylesheet">
  <!-- <link href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Raleway:400,700|Open+Sans:400,700&display=swap" rel="stylesheet"> -->
  <link rel="stylesheet" href="/ds4j/css/spectre.min.css">
  <link rel="stylesheet" href="/ds4j/css/spectre-exp.min.css">
  <link rel="stylesheet" href="/ds4j/css/spectre-icons.min.css">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="/ds4j/css/style.css" rel="stylesheet">
  <link href="/ds4j/css/highlight.css" rel="stylesheet">
</head>

<body>
  <div class="nav-holder bg-secondary">
  <div class='content'>
    <header class="navbar">
      <section class="navbar-section">
        <a href="/ds4j/" class="navbar-brand mr-2">DS4J</a>
      </section>
      <section class="navbar-section">
        <a href="/ds4j/projects" class="btn btn-link">Projects</a>
        <a href="/ds4j/topics" class="btn btn-link">Topics</a>
        <a href="/ds4j/curriculum" class="btn btn-link">Curriculum</a>
        <a href="/ds4j/about" class="btn btn-link">About</a>
      </section>
    </header>
  </div>
</div>
  
<div class="content text-based">
  <div class="columns">
    <div class="column col-12 notebook">
      <ul class="breadcrumb">
        <li class="breadcrumb-item">
          <a href="#">Projects</a>
        </li>
        <li class="breadcrumb-item">
          <a href="/ds4j/car-crashes-weight-regression/">Analyzing whether larger cars cause more deadly crashes</a>
        </li>
        <li class="breadcrumb-item">
          <a href="/ds4j/car-crashes-weight-regression/05-clean-combine-and-filter-data">05 - Clean combine and filter data</a>
        </li>
      </ul>

      <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="A-final-cleaning,-combining,-and-filtering-of-our-vehicle-data">A final cleaning, combining, and filtering of our vehicle data<a class="anchor-link" href="#A-final-cleaning,-combining,-and-filtering-of-our-vehicle-data">#</a></h1><p>After combining from so many sources, we need to filter out the car crashes we're interested in. We're curious about 2-car accidents that happen between light vehicles (no tractor-trailers).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="reading-options">
  <a class="btn" href="/ds4j/car-crashes-weight-regression/05-clean-combine-and-filter-data">
    <i class="fa fa-sm fa-book"></i>
    Read online
  </a>
  <a class="btn" href="/ds4j/car-crashes-weight-regression/notebooks/05 - Clean combine and filter data.ipynb">
    <i class="fa fa-sm fa-download"></i>
    Download notebook
  </a>
  <a class="btn" href="#">
    <i class="fa fa-sm fa-laptop"></i>
    Interactive version
  </a>
</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_columns&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_rows&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Read-in-our-data">Read in our data<a class="anchor-link" href="#Read-in-our-data">#</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-vehicles-involved-in-the-crash">The vehicles involved in the crash<a class="anchor-link" href="#The-vehicles-involved-in-the-crash">#</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vehicles</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/cleaned/combined-vehicle-data.csv&quot;</span><span class="p">)</span>
<span class="n">vehicles</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AREA_DAMAGED_CODE1</th>
      <th>AREA_DAMAGED_CODE2</th>
      <th>AREA_DAMAGED_CODE3</th>
      <th>AREA_DAMAGED_CODE_IMP1</th>
      <th>AREA_DAMAGED_CODE_MAIN</th>
      <th>BODY_TYPE_CODE</th>
      <th>COMMERCIAL_FLAG</th>
      <th>CONTI_DIRECTION_CODE</th>
      <th>CV_BODY_TYPE_CODE</th>
      <th>DAMAGE_CODE</th>
      <th>DRIVERLESS_FLAG</th>
      <th>FIRE_FLAG</th>
      <th>GOING_DIRECTION_CODE</th>
      <th>GVW_CODE</th>
      <th>HARM_EVENT_CODE</th>
      <th>HAZMAT_SPILL_FLAG</th>
      <th>HIT_AND_RUN_FLAG</th>
      <th>HZM_NUM</th>
      <th>MOVEMENT_CODE</th>
      <th>NUM_AXLES</th>
      <th>PARKED_FLAG</th>
      <th>REPORT_NO</th>
      <th>SPEED_LIMIT</th>
      <th>TOWED_AWAY_FLAG</th>
      <th>TOWED_VEHICLE_CONFIG_CODE</th>
      <th>VEHICLE_ID</th>
      <th>VEH_MAKE</th>
      <th>VEH_MODEL</th>
      <th>VEH_YEAR</th>
      <th>VIN_NO</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>23.08</td>
      <td>N</td>
      <td>E</td>
      <td>NaN</td>
      <td>5</td>
      <td>N</td>
      <td>N</td>
      <td>E</td>
      <td>NaN</td>
      <td>9.0</td>
      <td>NaN</td>
      <td>N</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>N</td>
      <td>ADJ487004H</td>
      <td>30</td>
      <td>Y</td>
      <td>0</td>
      <td>000238fd-44fa-4cd5-8eb7-41ab30500bec</td>
      <td>CHEVY</td>
      <td>TAHOE</td>
      <td>2005.0</td>
      <td>1GNEK13Q2J285593</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12.0</td>
      <td>12.0</td>
      <td>2.00</td>
      <td>N</td>
      <td>E</td>
      <td>NaN</td>
      <td>4</td>
      <td>N</td>
      <td>N</td>
      <td>E</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>N</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>N</td>
      <td>MCP2487000M</td>
      <td>40</td>
      <td>Y</td>
      <td>0</td>
      <td>00038116-1bf9-48cc-b317-4f4375d14b60</td>
      <td>INFI</td>
      <td>4S</td>
      <td>2003.0</td>
      <td>JNKCV51E63M013580</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>What are we interested in for this dataset? We probably don't need all those columns!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vehicles</span> <span class="o">=</span> <span class="n">vehicles</span><span class="p">[[</span><span class="s1">&#39;REPORT_NO&#39;</span><span class="p">,</span> <span class="s1">&#39;SPEED_LIMIT&#39;</span><span class="p">,</span> <span class="s1">&#39;VEH_MAKE&#39;</span><span class="p">,</span> <span class="s1">&#39;VEH_MODEL&#39;</span><span class="p">,</span> <span class="s1">&#39;VEH_YEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;VIN_NO&#39;</span><span class="p">,</span> <span class="s1">&#39;VEHICLE_ID&#39;</span><span class="p">]]</span>
<span class="n">vehicles</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>REPORT_NO</th>
      <th>SPEED_LIMIT</th>
      <th>VEH_MAKE</th>
      <th>VEH_MODEL</th>
      <th>VEH_YEAR</th>
      <th>VIN_NO</th>
      <th>VEHICLE_ID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ADJ487004H</td>
      <td>30</td>
      <td>CHEVY</td>
      <td>TAHOE</td>
      <td>2005.0</td>
      <td>1GNEK13Q2J285593</td>
      <td>000238fd-44fa-4cd5-8eb7-41ab30500bec</td>
    </tr>
    <tr>
      <th>1</th>
      <td>MCP2487000M</td>
      <td>40</td>
      <td>INFI</td>
      <td>4S</td>
      <td>2003.0</td>
      <td>JNKCV51E63M013580</td>
      <td>00038116-1bf9-48cc-b317-4f4375d14b60</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CB5190006B</td>
      <td>55</td>
      <td>TOYT</td>
      <td>TK</td>
      <td>2011.0</td>
      <td>5TFUY5F1XBX167340</td>
      <td>0003b659-2785-4868-8877-0b786a284827</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ADJ4590035</td>
      <td>5</td>
      <td>HONDA</td>
      <td>CIVIC</td>
      <td>2015.0</td>
      <td>2HGFG4A59FH702545</td>
      <td>00050484-d08f-4b6e-bc7e-9ec270e94660</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ADJ849000Z</td>
      <td>10</td>
      <td>HONDA</td>
      <td>ACCORD</td>
      <td>2003.0</td>
      <td>1HGCM66313A037175</td>
      <td>00057af4-d848-4cee-b854-707f57581f4e</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Details-about-the-crash-itself">Details about the crash itself<a class="anchor-link" href="#Details-about-the-crash-itself">#</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">crashes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/cleaned/combined-crash-data.csv&quot;</span><span class="p">)</span>
<span class="n">crashes</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ACC_DATE</th>
      <th>ACC_TIME</th>
      <th>AGENCY_CODE</th>
      <th>AREA_CODE</th>
      <th>COLLISION_TYPE_CODE</th>
      <th>COUNTY_NO</th>
      <th>C_M_ZONE_FLAG</th>
      <th>DISTANCE</th>
      <th>DISTANCE_DIR_FLAG</th>
      <th>FEET_MILES_FLAG</th>
      <th>FIX_OBJ_CODE</th>
      <th>HARM_EVENT_CODE1</th>
      <th>HARM_EVENT_CODE2</th>
      <th>JUNCTION_CODE</th>
      <th>LANE_CODE</th>
      <th>LATITUDE</th>
      <th>LIGHT_CODE</th>
      <th>LOC_CODE</th>
      <th>LOGMILE_DIR_FLAG</th>
      <th>LOG_MILE</th>
      <th>LONGITUDE</th>
      <th>MAINROAD_NAME</th>
      <th>MUNI_CODE</th>
      <th>RD_COND_CODE</th>
      <th>RD_DIV_CODE</th>
      <th>REFERENCE_NO</th>
      <th>REFERENCE_ROAD_NAME</th>
      <th>REFERENCE_SUFFIX</th>
      <th>REFERENCE_TYPE_CODE</th>
      <th>REPORT_NO</th>
      <th>REPORT_TYPE</th>
      <th>ROUTE_TYPE_CODE</th>
      <th>RTE_NO</th>
      <th>RTE_SUFFIX</th>
      <th>SIGNAL_FLAG</th>
      <th>SURF_COND_CODE</th>
      <th>WEATHER_CODE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2018-04-10 00:00:00</td>
      <td>01:50:00</td>
      <td>MSP</td>
      <td>UNK</td>
      <td>17</td>
      <td>18.0</td>
      <td>N</td>
      <td>0.0</td>
      <td>N</td>
      <td>F</td>
      <td>22.03</td>
      <td>16.0</td>
      <td>11.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>38.277230</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>N</td>
      <td>2.09</td>
      <td>-76.682876</td>
      <td>NEWTOWNE NECK RD</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>166.0</td>
      <td>ROSEBANK RD</td>
      <td>NaN</td>
      <td>CO</td>
      <td>MSP6188002Q</td>
      <td>Injury Crash</td>
      <td>MD</td>
      <td>243.0</td>
      <td>NaN</td>
      <td>N</td>
      <td>2.0</td>
      <td>6.01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2018-05-02 00:00:00</td>
      <td>11:06:00</td>
      <td>ELKTON</td>
      <td>UNK</td>
      <td>5</td>
      <td>7.0</td>
      <td>N</td>
      <td>15.0</td>
      <td>S</td>
      <td>F</td>
      <td>0.00</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>39.613747</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>N</td>
      <td>19.41</td>
      <td>-75.837454</td>
      <td>N BRIDGE ST</td>
      <td>52.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>362.0</td>
      <td>LAUREL DR</td>
      <td>NaN</td>
      <td>MU</td>
      <td>BK0227001M</td>
      <td>Injury Crash</td>
      <td>MD</td>
      <td>213.0</td>
      <td>NaN</td>
      <td>N</td>
      <td>2.0</td>
      <td>6.01</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Do we need all of those fields? Again - probably not! What fields are we interested in?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">crashes</span> <span class="o">=</span> <span class="n">crashes</span><span class="p">[[</span><span class="s1">&#39;REPORT_NO&#39;</span><span class="p">]]</span>
<span class="n">crashes</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>REPORT_NO</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>MSP6188002Q</td>
    </tr>
    <tr>
      <th>1</th>
      <td>BK0227001M</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ZU8005001W</td>
    </tr>
    <tr>
      <th>3</th>
      <td>MCP2891005S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>MSP6743004Q</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Weights-of-the-cars">Weights of the cars<a class="anchor-link" href="#Weights-of-the-cars">#</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">weights</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/cleaned/vins_and_weights.csv&quot;</span><span class="p">)</span>
<span class="n">weights</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VIN</th>
      <th>Make</th>
      <th>Model</th>
      <th>ModelYear</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2FMDA5143TBB45576</td>
      <td>FORD</td>
      <td>WINDSTAR</td>
      <td>1996</td>
      <td>3733.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2G1WC5E37E1120089</td>
      <td>CHEVROLET</td>
      <td>IMPALA</td>
      <td>2014</td>
      <td>3618.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Seems good to me!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Person-data">Person data<a class="anchor-link" href="#Person-data">#</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">people</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/cleaned/combined-person-data.csv&quot;</span><span class="p">)</span>
<span class="n">people</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AIRBAG_DEPLOYED</th>
      <th>ALCOHOL_TESTTYPE_CODE</th>
      <th>ALCOHOL_TEST_CODE</th>
      <th>BAC_CODE</th>
      <th>CDL_FLAG</th>
      <th>CLASS</th>
      <th>CONDITION_CODE</th>
      <th>DATE_OF_BIRTH</th>
      <th>DRUG_TESTRESULT_CODE</th>
      <th>DRUG_TEST_CODE</th>
      <th>EJECT_CODE</th>
      <th>EMS_UNIT_LABEL</th>
      <th>EQUIP_PROB_CODE</th>
      <th>FAULT_FLAG</th>
      <th>INJ_SEVER_CODE</th>
      <th>LICENSE_STATE_CODE</th>
      <th>MOVEMENT_CODE</th>
      <th>OCC_SEAT_POS_CODE</th>
      <th>PED_LOCATION_CODE</th>
      <th>PED_OBEY_CODE</th>
      <th>PED_TYPE_CODE</th>
      <th>PED_VISIBLE_CODE</th>
      <th>PERSON_ID</th>
      <th>PERSON_TYPE</th>
      <th>REPORT_NO</th>
      <th>SAF_EQUIP_CODE</th>
      <th>SEX_CODE</th>
      <th>VEHICLE_ID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>N</td>
      <td>C</td>
      <td>0.0</td>
      <td>1952-04-20 00:00:00</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>N</td>
      <td>1</td>
      <td>PA</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>48dd00ee-e033-47e7-ad1e-0b734020301b</td>
      <td>D</td>
      <td>AB4284000S</td>
      <td>13.0</td>
      <td>F</td>
      <td>eb6aadb8-dacb-4744-a1a7-ab812c96f27f</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>N</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>1985-05-28 00:00:00</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>N</td>
      <td>1</td>
      <td>MD</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>166296bd-ffd3-4c16-aa74-4f4bf4139d8d</td>
      <td>D</td>
      <td>AB4313000X</td>
      <td>13.0</td>
      <td>F</td>
      <td>b463eb20-2f01-4200-9d6f-b18888ce2593</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">people</span> <span class="o">=</span> <span class="n">people</span><span class="p">[[</span><span class="s1">&#39;INJ_SEVER_CODE&#39;</span><span class="p">,</span> <span class="s1">&#39;VEHICLE_ID&#39;</span><span class="p">]]</span>
<span class="n">people</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>INJ_SEVER_CODE</th>
      <th>VEHICLE_ID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>eb6aadb8-dacb-4744-a1a7-ab812c96f27f</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>b463eb20-2f01-4200-9d6f-b18888ce2593</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3c8629d0-d524-47c1-bfbc-b18e07f3087e</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>c4628cdb-f295-4a24-8a4b-653741ac6ae7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>cdda1580-fd79-4358-8819-c2250f494591</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Merging-our-data">Merging our data<a class="anchor-link" href="#Merging-our-data">#</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># We&#39;ll keep the ones without weights so we can drop those accidents from the analysis</span>
<span class="n">vehicles_with_weights</span> <span class="o">=</span> <span class="n">vehicles</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span>
                                       <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                                       <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;VIN_NO&#39;</span><span class="p">,</span>
                                       <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;VIN&#39;</span><span class="p">)</span>
<span class="n">vehicles_with_weights</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>REPORT_NO</th>
      <th>SPEED_LIMIT</th>
      <th>VEH_MAKE</th>
      <th>VEH_MODEL</th>
      <th>VEH_YEAR</th>
      <th>VIN_NO</th>
      <th>VEHICLE_ID</th>
      <th>VIN</th>
      <th>Make</th>
      <th>Model</th>
      <th>ModelYear</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ADJ487004H</td>
      <td>30</td>
      <td>CHEVY</td>
      <td>TAHOE</td>
      <td>2005.0</td>
      <td>1GNEK13Q2J285593</td>
      <td>000238fd-44fa-4cd5-8eb7-41ab30500bec</td>
      <td>1GNEK13Q2J285593</td>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>1988.0</td>
      <td>4300.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>MCP2487000M</td>
      <td>40</td>
      <td>INFI</td>
      <td>4S</td>
      <td>2003.0</td>
      <td>JNKCV51E63M013580</td>
      <td>00038116-1bf9-48cc-b317-4f4375d14b60</td>
      <td>JNKCV51E63M013580</td>
      <td>INFINITI</td>
      <td>G35</td>
      <td>2003.0</td>
      <td>3468.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CB5190006B</td>
      <td>55</td>
      <td>TOYT</td>
      <td>TK</td>
      <td>2011.0</td>
      <td>5TFUY5F1XBX167340</td>
      <td>0003b659-2785-4868-8877-0b786a284827</td>
      <td>5TFUY5F1XBX167340</td>
      <td>TOYOTA</td>
      <td>TUNDRA</td>
      <td>2011.0</td>
      <td>5480.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ADJ4590035</td>
      <td>5</td>
      <td>HONDA</td>
      <td>CIVIC</td>
      <td>2015.0</td>
      <td>2HGFG4A59FH702545</td>
      <td>00050484-d08f-4b6e-bc7e-9ec270e94660</td>
      <td>2HGFG4A59FH702545</td>
      <td>HONDA</td>
      <td>CIVIC</td>
      <td>2015.0</td>
      <td>2754.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ADJ849000Z</td>
      <td>10</td>
      <td>HONDA</td>
      <td>ACCORD</td>
      <td>2003.0</td>
      <td>1HGCM66313A037175</td>
      <td>00057af4-d848-4cee-b854-707f57581f4e</td>
      <td>1HGCM66313A037175</td>
      <td>HONDA</td>
      <td>ACCORD</td>
      <td>2003.0</td>
      <td>3023.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>AE5207008Z</td>
      <td>30</td>
      <td>FORD</td>
      <td>4D</td>
      <td>2016.0</td>
      <td>1FADP3K28GL258987</td>
      <td>00089d4a-7038-4693-9e02-b402676631af</td>
      <td>1FADP3K28GL258987</td>
      <td>FORD</td>
      <td>FOCUS</td>
      <td>2016.0</td>
      <td>2932.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>MDTA1150000D</td>
      <td>30</td>
      <td>GILL</td>
      <td>BUS</td>
      <td>2004.0</td>
      <td>15GGD211X41076128</td>
      <td>000abd04-058d-4e14-9f1c-4a100493a305</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>MSP5973003Q</td>
      <td>35</td>
      <td>CHEVROLET</td>
      <td>HHR</td>
      <td>2008.0</td>
      <td>3GNDA23DX8S558149</td>
      <td>000e3b5d-b4ae-44a1-af02-df6cce381fc1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>MCP27070015</td>
      <td>25</td>
      <td>ACUR</td>
      <td>TSX</td>
      <td>2008.0</td>
      <td>JH4CL96848C021626</td>
      <td>000f45d8-bc0e-4f9c-820a-474212e669cd</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>ADJ859000Y</td>
      <td>15</td>
      <td>HONDA</td>
      <td>CIVIC</td>
      <td>2009.0</td>
      <td>2HGFA16689H357624</td>
      <td>0010076b-0a45-45f3-8796-f387b39cd85d</td>
      <td>2HGFA16689H357624</td>
      <td>HONDA</td>
      <td>CIVIC</td>
      <td>2009.0</td>
      <td>2678.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Do the <code>VEH_MAKE</code> and <code>Make</code> columns match up, generally speaking? <strong>Do we trust what we did by searching out the VIN?</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vehicles_with_weights</span><span class="p">[[</span><span class="s1">&#39;VEH_MAKE&#39;</span><span class="p">,</span> <span class="s1">&#39;Make&#39;</span><span class="p">,</span> <span class="s1">&#39;VEH_MODEL&#39;</span><span class="p">,</span> <span class="s1">&#39;Model&#39;</span><span class="p">,</span> <span class="s1">&#39;VEH_YEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;ModelYear&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VEH_MAKE</th>
      <th>Make</th>
      <th>VEH_MODEL</th>
      <th>Model</th>
      <th>VEH_YEAR</th>
      <th>ModelYear</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CHEVY</td>
      <td>CHEVROLET</td>
      <td>TAHOE</td>
      <td>GMT-400</td>
      <td>2005.0</td>
      <td>1988.0</td>
      <td>4300.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>INFI</td>
      <td>INFINITI</td>
      <td>4S</td>
      <td>G35</td>
      <td>2003.0</td>
      <td>2003.0</td>
      <td>3468.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>TOYT</td>
      <td>TOYOTA</td>
      <td>TK</td>
      <td>TUNDRA</td>
      <td>2011.0</td>
      <td>2011.0</td>
      <td>5480.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>HONDA</td>
      <td>HONDA</td>
      <td>CIVIC</td>
      <td>CIVIC</td>
      <td>2015.0</td>
      <td>2015.0</td>
      <td>2754.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>HONDA</td>
      <td>HONDA</td>
      <td>ACCORD</td>
      <td>ACCORD</td>
      <td>2003.0</td>
      <td>2003.0</td>
      <td>3023.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>FORD</td>
      <td>FORD</td>
      <td>4D</td>
      <td>FOCUS</td>
      <td>2016.0</td>
      <td>2016.0</td>
      <td>2932.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>GILL</td>
      <td>NaN</td>
      <td>BUS</td>
      <td>NaN</td>
      <td>2004.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>CHEVROLET</td>
      <td>NaN</td>
      <td>HHR</td>
      <td>NaN</td>
      <td>2008.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>ACUR</td>
      <td>NaN</td>
      <td>TSX</td>
      <td>NaN</td>
      <td>2008.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>HONDA</td>
      <td>HONDA</td>
      <td>CIVIC</td>
      <td>CIVIC</td>
      <td>2009.0</td>
      <td>2009.0</td>
      <td>2678.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It looks some of these have weights, while others don't. How many do we have weights for?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># isna vs notna</span>
<span class="n">vehicles_with_weights</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True     534436
False    207697
Name: weight, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Some-of-our-vehicles-don't-have-weights-or-years!">Some of our vehicles don't have weights or years!<a class="anchor-link" href="#Some-of-our-vehicles-don't-have-weights-or-years!">#</a></h2><p>Let's get the report numbers of vehicles without weights and/or years, then exclude those reports (crashes) from our analysis.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Find the ones missing weights</span>
<span class="n">missing_weight</span> <span class="o">=</span> <span class="n">vehicles_with_weights</span><span class="p">[</span><span class="n">vehicles_with_weights</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
<span class="n">missing_weight</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>REPORT_NO</th>
      <th>SPEED_LIMIT</th>
      <th>VEH_MAKE</th>
      <th>VEH_MODEL</th>
      <th>VEH_YEAR</th>
      <th>VIN_NO</th>
      <th>VEHICLE_ID</th>
      <th>VIN</th>
      <th>Make</th>
      <th>Model</th>
      <th>ModelYear</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6</th>
      <td>MDTA1150000D</td>
      <td>30</td>
      <td>GILL</td>
      <td>BUS</td>
      <td>2004.0</td>
      <td>15GGD211X41076128</td>
      <td>000abd04-058d-4e14-9f1c-4a100493a305</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>MSP5973003Q</td>
      <td>35</td>
      <td>CHEVROLET</td>
      <td>HHR</td>
      <td>2008.0</td>
      <td>3GNDA23DX8S558149</td>
      <td>000e3b5d-b4ae-44a1-af02-df6cce381fc1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>MCP27070015</td>
      <td>25</td>
      <td>ACUR</td>
      <td>TSX</td>
      <td>2008.0</td>
      <td>JH4CL96848C021626</td>
      <td>000f45d8-bc0e-4f9c-820a-474212e669cd</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>14</th>
      <td>DA3276000V</td>
      <td>45</td>
      <td>TOYT</td>
      <td>CAMRY</td>
      <td>2018.0</td>
      <td>JTNB11HK2J3004953</td>
      <td>0018b4d3-b19b-4327-b5f9-f0725fd06844</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>15</th>
      <td>CB5712001X</td>
      <td>50</td>
      <td>JEEP</td>
      <td>COMPASS</td>
      <td>2015.0</td>
      <td>W452866115351</td>
      <td>001968e1-88be-424b-b7cf-bd816ffe340a</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Get their report numbers</span>
<span class="n">missing_weight</span><span class="o">.</span><span class="n">REPORT_NO</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>6     MDTA1150000D
7      MSP5973003Q
8      MCP27070015
14      DA3276000V
15      CB5712001X
Name: REPORT_NO, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Filter those out of our &#39;crashes&#39; dataset</span>
<span class="c1"># We need to outline this real bigtime beforehand, &quot;what can we keep?&quot;</span>
<span class="c1"># because if we&#39;re only looking at our own car, then we don&#39;t need to drop these</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before&quot;</span><span class="p">,</span> <span class="n">crashes</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">crashes</span> <span class="o">=</span> <span class="n">crashes</span><span class="p">[</span><span class="o">~</span><span class="n">crashes</span><span class="o">.</span><span class="n">REPORT_NO</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">missing_weight</span><span class="o">.</span><span class="n">REPORT_NO</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After&quot;</span><span class="p">,</span> <span class="n">crashes</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Before (396419, 1)
After (218513, 1)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we're getting rid of half of our data, is it still okay?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="We-only-want-two-vehicle-crashes">We only want two-vehicle crashes<a class="anchor-link" href="#We-only-want-two-vehicle-crashes">#</a></h1><blockquote><p>For analytic purposes, we decompose the data set into three sub-sa three-vehicle crashes, and single-vehicle crashes. The two-vehicle crash data set is the focus of most of our analyses</p>
</blockquote>
<p>Each vehicle has a <code>REPORT_NO</code>. If two vehicles show up with the same <code>REPORT_NO</code>, we know there were two vehicles in the crash.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vehicles_with_weights</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>REPORT_NO</th>
      <th>SPEED_LIMIT</th>
      <th>VEH_MAKE</th>
      <th>VEH_MODEL</th>
      <th>VEH_YEAR</th>
      <th>VIN_NO</th>
      <th>VEHICLE_ID</th>
      <th>VIN</th>
      <th>Make</th>
      <th>Model</th>
      <th>ModelYear</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ADJ487004H</td>
      <td>30</td>
      <td>CHEVY</td>
      <td>TAHOE</td>
      <td>2005.0</td>
      <td>1GNEK13Q2J285593</td>
      <td>000238fd-44fa-4cd5-8eb7-41ab30500bec</td>
      <td>1GNEK13Q2J285593</td>
      <td>CHEVROLET</td>
      <td>GMT-400</td>
      <td>1988.0</td>
      <td>4300.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>MCP2487000M</td>
      <td>40</td>
      <td>INFI</td>
      <td>4S</td>
      <td>2003.0</td>
      <td>JNKCV51E63M013580</td>
      <td>00038116-1bf9-48cc-b317-4f4375d14b60</td>
      <td>JNKCV51E63M013580</td>
      <td>INFINITI</td>
      <td>G35</td>
      <td>2003.0</td>
      <td>3468.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CB5190006B</td>
      <td>55</td>
      <td>TOYT</td>
      <td>TK</td>
      <td>2011.0</td>
      <td>5TFUY5F1XBX167340</td>
      <td>0003b659-2785-4868-8877-0b786a284827</td>
      <td>5TFUY5F1XBX167340</td>
      <td>TOYOTA</td>
      <td>TUNDRA</td>
      <td>2011.0</td>
      <td>5480.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ADJ4590035</td>
      <td>5</td>
      <td>HONDA</td>
      <td>CIVIC</td>
      <td>2015.0</td>
      <td>2HGFG4A59FH702545</td>
      <td>00050484-d08f-4b6e-bc7e-9ec270e94660</td>
      <td>2HGFG4A59FH702545</td>
      <td>HONDA</td>
      <td>CIVIC</td>
      <td>2015.0</td>
      <td>2754.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ADJ849000Z</td>
      <td>10</td>
      <td>HONDA</td>
      <td>ACCORD</td>
      <td>2003.0</td>
      <td>1HGCM66313A037175</td>
      <td>00057af4-d848-4cee-b854-707f57581f4e</td>
      <td>1HGCM66313A037175</td>
      <td>HONDA</td>
      <td>ACCORD</td>
      <td>2003.0</td>
      <td>3023.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Which technique?</span>

<span class="c1"># counted = vehicles_with_weights.groupby(&#39;REPORT_NO&#39;).size().reset_index(name=&#39;car_count&#39;)</span>
<span class="c1"># counted.head()</span>

<span class="n">counted</span> <span class="o">=</span> <span class="n">vehicles_with_weights</span><span class="o">.</span><span class="n">REPORT_NO</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">counted</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>MDTA1229000H    69
CB53480003      35
MSP67460095     18
CE4636002C      17
MSP6063005N     17
Name: REPORT_NO, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There was a 69-car crash? That's pretty interesting. Better look that one up. To get the ones that have two cars, we just ask if <code>== 2</code> - since it's a series, we don't have to ask for the column name.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#two_car_report_nos = counted[counted.car_count == 2].REPORT_NO</span>
<span class="n">two_car_report_nos</span> <span class="o">=</span> <span class="n">counted</span><span class="p">[</span><span class="n">counted</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
<span class="n">two_car_report_nos</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;MSP528100BT&#39;, &#39;MSP5179001M&#39;, &#39;AE5869002N&#39;, &#39;ADH2680025&#39;, &#39;MSP2312000H&#39;,
       &#39;HS98300005&#39;, &#39;AC12830021&#39;, &#39;DA3892000P&#39;, &#39;AC2040003L&#39;, &#39;AC2127000B&#39;,
       ...
       &#39;ADI179000X&#39;, &#39;DA3889002W&#39;, &#39;ADI946000L&#39;, &#39;ADJ380001Y&#39;, &#39;AC2034002L&#39;,
       &#39;MSP61740086&#39;, &#39;AK00410003&#39;, &#39;MCP1366006C&#39;, &#39;ADJ186004B&#39;, &#39;ZH0339000W&#39;],
      dtype=&#39;object&#39;, length=253011)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Filter-for-only-light-vehicles">Filter for only light vehicles<a class="anchor-link" href="#Filter-for-only-light-vehicles">#</a></h1><blockquote><p>this data set contains all collisions involving two light vehicles built after 1980. We define a light vehicle as any car, pickup truck, SUV, or minivan that weights between 1500 and 6000 pounds.</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_not_light_vehicle</span> <span class="o">=</span> <span class="p">(</span><span class="n">vehicles_with_weights</span><span class="o">.</span><span class="n">weight</span> <span class="o">&lt;=</span> <span class="mi">1500</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">vehicles_with_weights</span><span class="o">.</span><span class="n">weight</span> <span class="o">&gt;</span> <span class="mi">6000</span><span class="p">)</span>
<span class="n">is_before_1980</span> <span class="o">=</span> <span class="n">vehicles_with_weights</span><span class="o">.</span><span class="n">ModelYear</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1980</span>
<span class="n">not_light_vehicle_crash</span> <span class="o">=</span> <span class="n">vehicles_with_weights</span><span class="p">[</span><span class="n">is_not_light_vehicle</span> <span class="o">|</span> <span class="n">is_before_1980</span><span class="p">]</span><span class="o">.</span><span class="n">REPORT_NO</span>
<span class="n">crashes</span> <span class="o">=</span> <span class="n">crashes</span><span class="p">[</span><span class="o">~</span><span class="n">crashes</span><span class="o">.</span><span class="n">REPORT_NO</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">not_light_vehicle_crash</span><span class="p">)]</span>
<span class="n">crashes</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(217074, 1)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
 


    </div>
  </div>
</div>

<script>
  [...document.querySelectorAll(".code_cell")].filter(cell => cell.innerText.trim().length === 0).forEach(cell => cell.remove())
</script>

  <div class="footer bg-secondary">
  <div class="content">
    <div class="columns">
      <div class="column col-6 col-sm-12">
        <p><strong>Hi, welcome to Data Science for Journalism!</strong></p>
        <p>There's been a lot of buzz about machine learning and "artificial intelligence" being used in stories over
          the past few years. It's mostly not that complicated - a little stats, a classifier here or there - but it's
          hard to know where to start without a little help.</p>
        <p>Hopefully this site can be that help! <a href="/ds4j/about">Learn more about this project here.</a></p>
      </div>
      <div class="column col-3 col-sm-6">
        <p><strong>Quick links</strong></p>
        <!-- <p><a href="#">Something here</a></p>
        <p><a href="#">Something here</a></p>
        <p><a href="#">Something here</a></p> -->
      </div>
      <div class="column col-3 col-sm6">
        <p><strong>Contact</strong></p>
        <p><a href="mailto:hello@littlecolumns.com">hello@littlecolumns.com</a></p>
      </div>
    </div>
  </div>
</div>
  <script src="/ds4j/js/tocbot.js"></script>

  <script>
    try {
      let toc = document.createElement("div")
      toc.setAttribute('class', 'js-toc')
      document.querySelector(".reading-options").parentNode.appendChild(toc)
    } catch (err) {

    }

    tocbot.init({
      // Where to render the table of contents.
      tocSelector: '.js-toc',
      // Where to grab the headings to build the table of contents.
      contentSelector: '.notebook',
      // Which headings to grab inside of the contentSelector element.
      headingSelector: 'h1, h2, h3, h4',
      activeLinkClass: 'active',
      listClass: 'nav',
      listItemClass: 'nav-item',
      headingLabelCallback: function (label) {
        return label.replace("#", "")
      }
    });
  </script>

</body>

</html>
<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8"/>
<title>Classification</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" rel="stylesheet"/>
<!-- <link href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Raleway:400,700|Open+Sans:400,700&display=swap" rel="stylesheet"> -->
<link href="/ds4j/css/spectre.min.css" rel="stylesheet"/>
<link href="/ds4j/css/spectre-exp.min.css" rel="stylesheet"/>
<link href="/ds4j/css/spectre-icons.min.css" rel="stylesheet"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<link href="/ds4j/css/style.css" rel="stylesheet"/>
<link href="/ds4j/css/highlight.css" rel="stylesheet"/>
</head>
<body>
<div class="nav-holder bg-secondary">
<div class="content">
<header class="navbar">
<section class="navbar-section">
<a class="navbar-brand mr-2" href="/ds4j/">DS4J</a>
</section>
<section class="navbar-section">
<a class="btn btn-link" href="/ds4j/projects">Projects</a>
<a class="btn btn-link" href="/ds4j/topics">Topics</a>
<a class="btn btn-link" href="/ds4j/curriculum">Curriculum</a>
<a class="btn btn-link" href="/ds4j/about">About</a>
</section>
</header>
</div>
</div>
<div class="columns col-gapless">
<div class="column col-auto bg-dark col-sm-12">
<div class="sidebar-holder">
<div class="accordion-container">
<div class="accordion">
<input checked="checked" hidden="" id="accordion-text-analysis" name="docs-accordion-checkbox" type="checkbox"/>
<a class="accordion-header c-hand" for="accordion-text-analysis" href="/ds4j/reference/text-analysis/">Text Analysis</a>
<div class="accordion-body ref-nav-text-analysis">
</div>
<input hidden="" id="accordion-regression" name="docs-accordion-checkbox" type="checkbox"/>
<a class="accordion-header c-hand" for="accordion-regression" href="/ds4j/reference/regression/">Regression</a>
<div class="accordion-body ref-nav-regression">
</div>
<input hidden="" id="accordion-classification" name="docs-accordion-checkbox" type="checkbox"/>
<a class="accordion-header c-hand" for="accordion-classification" href="/ds4j/reference/classification/">Classification</a>
<div class="accordion-body ref-nav-classification">
</div>
</div>
</div>
</div>
</div>
<div class="column with-sidebar col-sm-12">
<div class="hero">
<div class="hero-body">
<div class="content">
<h1>Classification</h1>
</div>
</div>
</div>
<section class="section">
<div class="content" id="page-content"><html><body><div class="ref-holder"><h2 id="creating-classifiers">Creating classifiers</h2><html><body><div class="columns">
<div class="column col-5 col-sm-12 ref-expl"><h3 id="logistic-regression">Logistic Regression</h3>

</div>
<div class="column col-7 col-sm-12 ref-code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mf">1e9</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">'lbfgs'</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">4000</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div></div>
</div>
</body></html><html><body><div class="columns">
<div class="column col-5 col-sm-12 ref-expl"><h3 id="decision-tree">Decision Tree</h3>

</div>
<div class="column col-7 col-sm-12 ref-code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">()</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div></div>
</div>
</body></html><html><body><div class="columns">
<div class="column col-5 col-sm-12 ref-expl"><h3 id="random-forest">Random Forest</h3>

</div>
<div class="column col-7 col-sm-12 ref-code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div></div>
</div>
</body></html><html><body><div class="columns">
<div class="column col-5 col-sm-12 ref-expl"><h3 id="linearsvc">LinearSVC</h3>

</div>
<div class="column col-7 col-sm-12 ref-code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">LinearSVC</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">LinearSVC</span><span class="p">()</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div></div>
</div>
</body></html><html><body><div class="columns">
<div class="column col-5 col-sm-12 ref-expl"><h3 id="multinomial-naive-bayes">Multinomial Naive Bayes</h3>


</div>
<div class="column col-7 col-sm-12 ref-code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">MultinomialNB</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">MultinomialNB</span><span class="p">()</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div></div>
</div>
</body></html><h2 id="evaluating-classifiers">Evaluating classifiers</h2><html><body><div class="columns">
<div class="column col-5 col-sm-12 ref-expl"><h3 id="traintest-split">Train/test split</h3>

</div>
<div class="column col-7 col-sm-12 ref-code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div></div>
</div>
</body></html><html><body><div class="columns">
<div class="column col-5 col-sm-12 ref-expl"><h3 id="accuracy">Accuracy</h3>

</div>
<div class="column col-7 col-sm-12 ref-code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div></div>
</div>
</body></html><html><body><div class="columns">
<div class="column col-5 col-sm-12 ref-expl"><h3 id="confusion-matrix">Confusion matrix</h3>


</div>
<div class="column col-7 col-sm-12 ref-code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>

<span class="n">y_true</span> <span class="o">=</span> <span class="n">y_test</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">logreg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">label_names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">'negative'</span><span class="p">,</span> <span class="s1">'positive'</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span>
     <span class="n">columns</span><span class="o">=</span><span class="s1">'Predicted '</span> <span class="o">+</span> <span class="n">label_names</span><span class="p">,</span>
     <span class="n">index</span><span class="o">=</span><span class="s1">'Is '</span> <span class="o">+</span> <span class="n">label_names</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div></div>
</div>
</body></html><h2 id="feature-importance">Feature importance</h2><html><body><div class="columns">
<div class="column col-5 col-sm-12 ref-expl"><h3 id="importance-explanation">Importance explanation</h3>

<p>I am firmly in the camp that <a href="https://eli5.readthedocs.io/">ELI5</a> is the greatest blessing to the modern world.</p>
</div>
<div class="column col-7 col-sm-12 ref-code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">eli5</span>

<span class="c1"># X is your list of features</span>
<span class="c1"># you could also write them out manually</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="n">eli5</span><span class="o">.</span><span class="n">show_weights</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="n">feature_names</span><span class="p">)</span>
</pre></div></div>
</div>
</body></html><html><body><div class="columns">
<div class="column col-5 col-sm-12 ref-expl"><h3 id="scoring-details">Scoring details</h3>

<p>While <code>eli5</code> typically just shows you feature importance, adding in <code>show=</code> will also give you descriptions of what the numbers mean, and possibly warnings about how to interpret them. Can also be done by <a href="https://eli5.readthedocs.io/en/latest/autodocs/eli5.html#eli5.format_as_text">picking certain things to show</a>, but using <code>ALL</code> is easier to remember.</p>
</div>
<div class="column col-7 col-sm-12 ref-code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">eli5</span>

<span class="c1"># X is your list of features</span>
<span class="c1"># you could also write them out manually</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="n">eli5</span><span class="o">.</span><span class="n">show_weights</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span>
                  <span class="n">feature_names</span><span class="o">=</span><span class="n">feature_names</span><span class="p">,</span>
                  <span class="n">show</span><span class="o">=</span><span class="n">eli5</span><span class="o">.</span><span class="n">formatters</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">ALL</span><span class="p">)</span>
</pre></div></div>
</div>
</body></html><html><body><div class="columns">
<div class="column col-5 col-sm-12 ref-expl"><h3 id="text-feature-importance">Text feature importance</h3>

<p>When each feature is a piece of text, you should pass the vectorizer to <code>eli5</code>. If you don't, each feature will just be a number. If you pass the vectorizer, it automatically shows you what each term actually is.</p>
</div>
<div class="column col-7 col-sm-12 ref-code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">eli5</span>

<span class="n">eli5</span><span class="o">.</span><span class="n">show_weights</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">vec</span><span class="o">=</span><span class="n">vectorizer</span><span class="p">)</span>
</pre></div></div>
</div>
</body></html><html><body><div class="columns">
<div class="column col-5 col-sm-12 ref-expl"><h3 id="graphing-features">Graphing features</h3>

<p>Graph the top 20 and bottom 20 most important features.</p>
</div>
<div class="column col-7 col-sm-12 ref-code"><div class="highlight"><pre><span></span><span class="c1"># Build a dataframe of what we have above</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">eli5</span><span class="o">.</span><span class="n">explain_weights_df</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">vec</span><span class="o">=</span><span class="n">vectorizer</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>

<span class="c1"># Pick colors based on being above or below zero</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
  <span class="k">lambda</span> <span class="n">weight</span><span class="p">:</span> <span class="s1">'lightblue'</span> <span class="k">if</span> <span class="n">weight</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">'tan'</span>
<span class="p">)</span>

<span class="c1"># Sort it and plot it</span>
<span class="n">weights</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
    <span class="n">by</span><span class="o">=</span><span class="s1">'weight'</span><span class="p">,</span>
    <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">'weight'</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">'feature'</span><span class="p">,</span>
    <span class="n">kind</span><span class="o">=</span><span class="s1">'barh'</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span>
    <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
    <span class="n">legend</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div></div>
</div>
</body></html><html><body><div class="columns">
<div class="column col-5 col-sm-12 ref-expl"><h3 id="explain-one-prediction">Explain one prediction</h3>

<p>I am firmly in the camp that <a href="https://eli5.readthedocs.io/">ELI5</a> is the greatest blessing to the modern world.</p>
</div>
<div class="column col-7 col-sm-12 ref-code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">eli5</span>

<span class="n">eli5</span><span class="o">.</span><span class="n">show_prediction</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vec</span><span class="o">=</span><span class="n">vectorizer</span><span class="p">)</span>
</pre></div></div>
</div>
</body></html></div></body></html>

</div>
</section>
<script>
    let refNavSelector = ".ref-nav-classification"
</script>
</div>
</div>
<div class="footer bg-secondary">
<div class="content">
<div class="columns">
<div class="column col-6 col-sm-12">
<p><strong>Hi, welcome to Data Science for Journalism!</strong></p>
<p>There's been a lot of buzz about machine learning and "artificial intelligence" being used in stories over
          the past few years. It's mostly not that complicated - a little stats, a classifier here or there - but it's
          hard to know where to start without a little help.</p>
<p>Hopefully this site can be that help! <a href="/ds4j/about">Learn more about this project here.</a></p>
</div>
<div class="column col-3 col-sm-6">
<p><strong>Quick links</strong></p>
<!-- <p><a href="#">Something here</a></p>
        <p><a href="#">Something here</a></p>
        <p><a href="#">Something here</a></p> -->
</div>
<div class="column col-3 col-sm6">
<p><strong>Contact</strong></p>
<p><a href="mailto:hello@littlecolumns.com">hello@littlecolumns.com</a></p>
</div>
</div>
</div>
</div>
<script src="/ds4j/js/tocbot.js"></script>
<script>
    try {
      let toc = document.createElement("div")
      toc.setAttribute('class', 'js-toc')
      document.querySelector(".reading-options").parentNode.appendChild(toc)
    } catch (err) {

    }

    // Sidebar TOC
    tocbot.init({
      // Where to render the table of contents.
      tocSelector: refNavSelector,
      // Where to grab the headings to build the table of contents.
      contentSelector: '.ref-holder',
      // Which headings to grab inside of the contentSelector element.
      headingSelector: 'h1, h2, h3, h4',
      activeLinkClass: 'active',
      listClass: 'menu menu-nav',
      listItemClass: 'menu-item'
    });
    document.querySelector(refNavSelector).previousElementSibling.setAttribute('href', '#')
  </script>
</body>
</html>
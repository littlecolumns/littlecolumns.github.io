<!doctype html>
<html lang="en-US">

<head>
  <meta charset="utf-8">
  <title>Homework - Reveal Mortgage Analysis - Logistic Regression using statsmodels formulas</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" rel="stylesheet">
  <!-- <link href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Raleway:400,700|Open+Sans:400,700&display=swap" rel="stylesheet"> -->
  <link rel="stylesheet" href="/ds4j/css/spectre.min.css">
  <link rel="stylesheet" href="/ds4j/css/spectre-exp.min.css">
  <link rel="stylesheet" href="/ds4j/css/spectre-icons.min.css">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="/ds4j/css/style.css" rel="stylesheet">
  <link href="/ds4j/css/highlight.css" rel="stylesheet">
</head>

<body>
  <div class="nav-holder bg-secondary">
  <div class='content'>
    <header class="navbar">
      <section class="navbar-section">
        <a href="/ds4j/" class="navbar-brand mr-2">DS4J</a>
      </section>
      <section class="navbar-section">
        <a href="/ds4j/projects" class="btn btn-link">Projects</a>
        <a href="/ds4j/topics" class="btn btn-link">Topics</a>
        <a href="/ds4j/curriculum" class="btn btn-link">Curriculum</a>
        <a href="/ds4j/about" class="btn btn-link">About</a>
      </section>
    </header>
  </div>
</div>
  
<div class="content text-based">
  <div class="columns">
    <div class="column col-12 notebook">
      <ul class="breadcrumb">
        <li class="breadcrumb-item">
          <a href="#">Projects</a>
        </li>
        <li class="breadcrumb-item">
          <a href="/ds4j/reveal-mortgages/">Analyzing mortgage rejections for racial bias</a>
        </li>
        <li class="breadcrumb-item">
          <a href="/ds4j/reveal-mortgages/homework-reveal-mortgage-analysis-logistic-regression-using-statsmodels-formulas">Homework - Reveal Mortgage Analysis - Logistic Regression using statsmodels formulas</a>
        </li>
      </ul>

      <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Lending-disparities-using-Logistic-Regression">Lending disparities using Logistic Regression<a class="anchor-link" href="#Lending-disparities-using-Logistic-Regression">#</a></h1><p><strong>The story:</strong> <a href="https://www.revealnews.org/article/for-people-of-color-banks-are-shutting-the-door-to-homeownership/">https://www.revealnews.org/article/for-people-of-color-banks-are-shutting-the-door-to-homeownership/</a></p>
<p><strong>Author:</strong> Aaron Glantz and Emmanuel Martinez</p>
<p><strong>Topics:</strong> Logistic regression, odds ratios</p>
<p><strong>Datasets</strong></p>
<ul>
<li><strong>philadelphia-mortgages.csv:</strong> Philadelphia mortgage data for 2015<ul>
<li>A subset of HMDA LAR data from <a href="https://www.ffiec.gov/hmda/hmdaproducts.htm">FFEIC</a></li>
<li>Codebook is <code>2015HMDACodeSheet.pdf</code></li>
<li>A <a href="https://www.ffiec.gov/hmda/guide.htm">guide to HMDA reporting</a></li>
<li>I've massaged it slightly to make processing a bit easier</li>
</ul>
</li>
<li><strong>nhgis0006_ds233_20175_2017_tract.csv:</strong><ul>
<li>Table B03002: Hispanic or Latino Origin by Race</li>
<li>2013-2017 American Community Survey data US Census Bureau, from <a href="https://data2.nhgis.org/main">NHGIS</a></li>
<li>Codebook is <code>nhgis0006_ds233_20175_2017_tract_codebook.txt</code></li>
</ul>
</li>
<li><strong>lending_disparities_whitepaper_180214.pdf:</strong> the whitepaper outlining Reveal's methodology</li>
</ul>
<h2 id="What's-the-goal?">What's the goal?<a class="anchor-link" href="#What's-the-goal?">#</a></h2><p>Do banks provide mortgages at disparate rates between white applicants and people of color? We're going to look at the following variables to find out:</p>
<ul>
<li>Race/Ethnicity<ul>
<li>Native American</li>
<li>Asian</li>
<li>Black</li>
<li>Native Hawaiian</li>
<li>Hispanic/Latino</li>
<li>Race and ethnicity were not reported</li>
</ul>
</li>
<li>Sex</li>
<li>Whether there was a co-applicant</li>
<li>Applicant’s annual income (includes co-applicant income)</li>
<li>Loan amount</li>
<li>Ratio between the loan amount and the applicant’s income</li>
<li>Ratio between the median income of the census tract and the median income of the metro area</li>
<li>Racial and ethnic breakdown by percentage for each census tract</li>
<li>Regulating agency of the lending institution</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="reading-options">
  <a class="btn" href="/ds4j/reveal-mortgages/homework-reveal-mortgage-analysis-logistic-regression-using-statsmodels-formulas">
    <i class="fa fa-sm fa-book"></i>
    Read online
  </a>
  <a class="btn" href="/ds4j/reveal-mortgages/notebooks/Homework - Reveal Mortgage Analysis - Logistic Regression using statsmodels formulas.ipynb">
    <i class="fa fa-sm fa-download"></i>
    Download notebook
  </a>
  <a class="btn" href="#">
    <i class="fa fa-sm fa-laptop"></i>
    Interactive version
  </a>
</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Setup">Setup<a class="anchor-link" href="#Setup">#</a></h1><p>Import pandas as usual, but also import numpy. We'll need it for logarithms and exponents.</p>
<p>Some of our datasets have a lot of columns, so you'll also want to use <code>pd.set_option</code> to display up to 100 columns or so.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_columns&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_rows&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.float_format&quot;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{:,.5f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="What-is-each-row-of-our-data?">What is each row of our data?<a class="anchor-link" href="#What-is-each-row-of-our-data?">#</a></h1><p>If you aren't sure, you might need to look at either the whitepaper or the codebook. You'll need to look at them both eventually, so might as well get started now.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Read-in-your-data">Read in your data<a class="anchor-link" href="#Read-in-your-data">#</a></h1><p>Read in our Philadelphia mortgage data and take a peek at the first few rows.</p>
<ul>
<li><strong>Tip:</strong> As always, census tract columns like to cause problems if they're read in as numbers. Make sure pandas reads it in as a string.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># We&#39;re just looking at Philly</span>
<span class="n">mortgage</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/philadelphia-mortgages.csv&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="p">{</span> <span class="s1">&#39;census_tract&#39;</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">})</span>
<span class="n">mortgage</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>census_tract</th>
      <th>county_code</th>
      <th>state_code</th>
      <th>applicant_sex</th>
      <th>income</th>
      <th>loan_amount</th>
      <th>loan_type</th>
      <th>property_type</th>
      <th>occupancy</th>
      <th>action_type</th>
      <th>loan_purpose</th>
      <th>agency_code</th>
      <th>tract_to_msa_income_percent</th>
      <th>applicant_race</th>
      <th>co_applicant_sex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0101.00</td>
      <td>101</td>
      <td>42</td>
      <td>3</td>
      <td>26</td>
      <td>5</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>5</td>
      <td>97.09000</td>
      <td>6</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0264.00</td>
      <td>101</td>
      <td>42</td>
      <td>2</td>
      <td>26</td>
      <td>40</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>5</td>
      <td>98.27000</td>
      <td>3</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0281.00</td>
      <td>101</td>
      <td>42</td>
      <td>2</td>
      <td>22</td>
      <td>20</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>5</td>
      <td>2</td>
      <td>5</td>
      <td>72.28000</td>
      <td>6</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0158.00</td>
      <td>101</td>
      <td>42</td>
      <td>2</td>
      <td>57</td>
      <td>36</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>5</td>
      <td>3</td>
      <td>5</td>
      <td>105.87000</td>
      <td>6</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0358.00</td>
      <td>101</td>
      <td>42</td>
      <td>1</td>
      <td>80</td>
      <td>34</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>5</td>
      <td>139.62000</td>
      <td>5</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Check-your-column-types">Check your column types<a class="anchor-link" href="#Check-your-column-types">#</a></h3><p>I mentioned it above, but make sure <code>census_tract</code> is an object (a string) or merging isn't going to be any fun later on.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mortgage</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>census_tract                    object
county_code                      int64
state_code                       int64
applicant_sex                    int64
income                           int64
loan_amount                      int64
loan_type                        int64
property_type                    int64
occupancy                        int64
action_type                      int64
loan_purpose                     int64
agency_code                      int64
tract_to_msa_income_percent    float64
applicant_race                   int64
co_applicant_sex                 int64
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Engineering-and-cleaning-up-features">Engineering and cleaning up features<a class="anchor-link" href="#Engineering-and-cleaning-up-features">#</a></h1><h2 id="Income-related-columns">Income-related columns<a class="anchor-link" href="#Income-related-columns">#</a></h2><blockquote><p>When we plotted the number of applicants, how much money they made and the size of the loan, we found that it skewed to the left, meaning the majority of applicants were clustered on the lower end of the income and loan amount scales. This was especially true for applicants of color. <strong>We took the logarithm transformation of income and loan amount to normalize the distribution of those variables and limit the effect of extreme outliers.</strong></p>
</blockquote>
<p>Traditionally we would calculate these valuess and save them in <strong>new columns</strong>. Since it's just simple math, though, we'll be able to do it when we run the regression.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Co-applicants">Co-applicants<a class="anchor-link" href="#Co-applicants">#</a></h3><p>Right now we have a column about the co-applicant's sex (see the codebook for column details). We don't want the sex, though, we're interested in whether there is a co applicant or not. Use the co-applicant's sex to <strong>create a new column called <code>co_applicant</code> that is either 'yes', 'no', or 'unknown'.</strong></p>
<ul>
<li><strong>Hint:</strong> If the co-applicant's sex was not provided or is not applicable, count it as unknown.</li>
<li><strong>Hint:</strong> The easiest way is to use <code>.replace</code> on the co-applicant sex column, but store the result in your new column</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mortgage</span><span class="p">[</span><span class="s1">&#39;co_applicant&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mortgage</span><span class="o">.</span><span class="n">co_applicant_sex</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span>
    <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span>
    <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;unknown&#39;</span><span class="p">,</span>
    <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;unknown&#39;</span><span class="p">,</span>
    <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;no&#39;</span>
<span class="p">})</span>
<span class="n">mortgage</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>census_tract</th>
      <th>county_code</th>
      <th>state_code</th>
      <th>applicant_sex</th>
      <th>income</th>
      <th>loan_amount</th>
      <th>loan_type</th>
      <th>property_type</th>
      <th>occupancy</th>
      <th>action_type</th>
      <th>loan_purpose</th>
      <th>agency_code</th>
      <th>tract_to_msa_income_percent</th>
      <th>applicant_race</th>
      <th>co_applicant_sex</th>
      <th>co_applicant</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0101.00</td>
      <td>101</td>
      <td>42</td>
      <td>3</td>
      <td>26</td>
      <td>5</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>5</td>
      <td>97.09000</td>
      <td>6</td>
      <td>5</td>
      <td>no</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0264.00</td>
      <td>101</td>
      <td>42</td>
      <td>2</td>
      <td>26</td>
      <td>40</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>5</td>
      <td>98.27000</td>
      <td>3</td>
      <td>5</td>
      <td>no</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0281.00</td>
      <td>101</td>
      <td>42</td>
      <td>2</td>
      <td>22</td>
      <td>20</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>5</td>
      <td>2</td>
      <td>5</td>
      <td>72.28000</td>
      <td>6</td>
      <td>5</td>
      <td>no</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0158.00</td>
      <td>101</td>
      <td>42</td>
      <td>2</td>
      <td>57</td>
      <td>36</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>5</td>
      <td>3</td>
      <td>5</td>
      <td>105.87000</td>
      <td>6</td>
      <td>5</td>
      <td>no</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0358.00</td>
      <td>101</td>
      <td>42</td>
      <td>1</td>
      <td>80</td>
      <td>34</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>5</td>
      <td>139.62000</td>
      <td>5</td>
      <td>2</td>
      <td>yes</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Filter-loan-applicants">Filter loan applicants<a class="anchor-link" href="#Filter-loan-applicants">#</a></h1><p>If you read the whitepaper - <code>lending_disparities_whitepaper_180214.pdf</code> - many filters are used to get to the target dataset for analysis.</p>
<blockquote><p><strong>Loan type</strong></p>
<p>While we recognize the substantial presence of applicants of color in the FHA market, we focused on conventional home loans for several reasons.</p>
<p><strong>Property type</strong></p>
<p>Prospective borrowers submit loan applications for various types of structures: one- to four-unit properties, multifamily properties and manufactured homes. For this analysis, we focused on one- to four-unit properties.</p>
<p><strong>Occupancy</strong></p>
<p>We included only borrowers who said they planned to live in the house they were looking to buy. We did this to exclude developers or individuals who were buying property as an investment or to subsequently flip it.</p>
<p><strong>Action Type</strong></p>
<p>We wanted to look at the reasons lending institutions deny people a mortgage. After conversations with former officials at HUD, we decided to include only those applications that resulted in originations (action type 1) or denials (action type 3)</p>
<p><strong>Income</strong></p>
<p>An applicant’s income isn’t always reported in the data. In other cases, the data cuts off any incomes over \$9.9 million and any loan amounts over \\$99.9 million, meaning there’s a value in the database, but it’s not precise. We focused only on those records where income and loan amount have an accurate estimation. This meant discarding about 1 percent of all conventional home loans in the country for 2016. [Note: I already edited this]</p>
<p>When we plotted the number of applicants, how much money they made and the size of the loan, we found that it skewed to the left, meaning the majority of applicants were clustered on the lower end of the income and loan amount scales. This was especially true for applicants of color. We took the logarithm transformation of income and loan amount to normalize the distribution of those variables and limit the effect of extreme outliers.</p>
<p><strong>Lien status</strong></p>
<p>We included all cases in our analysis regardless of lien status.</p>
<p><strong>Race and ethnicity</strong></p>
<p>At first, we looked at race separate from ethnicity, but that approach introduced too many instances in which​ ​either the ethnicity or race was unknown. So we decided to combine race and ethnicity. Applicants who marked their ethnicity as Hispanic were grouped together as Hispanic/Latino regardless of race. Non-Hispanic applicants, as well as those who didn’t provide an ethnicity, were grouped together by race: non-Hispanic white, non-Hispanic black, etc. <strong>[Note: This has already been taken care of]</strong></p>
<p><strong>Loan purpose</strong></p>
<p>We decided to look at home purchase, home improvement and refinance loans separately from each other. [Note: please look at <strong>home purchase</strong> loans.]</p>
</blockquote>
<p>Use the text above (it's from the whitepaper) and the <strong>2015HMDACodeSheet.pdf</strong> code book to filter the dataset.</p>
<ul>
<li><strong>Tip:</strong> there should be between 5-8 filters, depending on how you write them.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mortgage</span> <span class="o">=</span> <span class="n">mortgage</span><span class="p">[(</span><span class="n">mortgage</span><span class="o">.</span><span class="n">loan_type</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> \
            <span class="p">(</span><span class="n">mortgage</span><span class="o">.</span><span class="n">property_type</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> \
            <span class="p">(</span><span class="n">mortgage</span><span class="o">.</span><span class="n">occupancy</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> \
            <span class="n">mortgage</span><span class="o">.</span><span class="n">action_type</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span> <span class="o">&amp;</span> \
            <span class="p">(</span><span class="n">mortgage</span><span class="o">.</span><span class="n">income</span> <span class="o">!=</span> <span class="mi">9999</span><span class="p">)</span> <span class="o">&amp;</span> \
            <span class="p">(</span><span class="n">mortgage</span><span class="o">.</span><span class="n">loan_amount</span> <span class="o">!=</span> <span class="mi">99999</span><span class="p">)</span> <span class="o">&amp;</span> \
            <span class="p">(</span><span class="n">mortgage</span><span class="o">.</span><span class="n">loan_purpose</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)]</span>
<span class="n">mortgage</span> <span class="o">=</span> <span class="n">mortgage</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">mortgage</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(10107, 16)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When you're done filtering, save your dataframe as a "copy" with <code>df = df.copy()</code> (if it's called <code>df</code>, of course). This will prevent irritating warnings when you're trying to create new columns.</p>
<h3 id="Confirm-that-you-have-10,107-loans-with-19-columns">Confirm that you have 10,107 loans with 19 columns<a class="anchor-link" href="#Confirm-that-you-have-10,107-loans-with-19-columns">#</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mortgage</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(10107, 16)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Create-a-&quot;loan-denied&quot;-column">Create a "loan denied" column<a class="anchor-link" href="#Create-a-&quot;loan-denied&quot;-column">#</a></h3><p>Right now the <code>action_type</code> category reflects whether the loan was granted or not, and either has a value of <code>1</code> or <code>3</code>. We'll need to create a new column called <code>loan_denied</code>, where the value is <code>0</code> if the loan was accepted and <code>1</code> if the loan was denied.</p>
<p>While we're eventually going to do a bunch of crazy comparisons and math inside of our statsmodels formula, we do need the target of our regression to be a number. You'll see what I mean later on!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mortgage</span><span class="p">[</span><span class="s1">&#39;loan_denied&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">mortgage</span><span class="o">.</span><span class="n">action_type</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Deal-with-categorical-variables">Deal with categorical variables<a class="anchor-link" href="#Deal-with-categorical-variables">#</a></h1><p>Let's go ahead and take a look at our categorical variables:</p>
<ul>
<li>Applicant sex (male, female, na)</li>
<li>Applicant race</li>
<li>Mortgage agency</li>
<li>Co-applicant (yes, no, unknown)</li>
</ul>
<p>Before we do anything crazy, let's use the codebook to turn them into strings.</p>
<ul>
<li><strong>Tip:</strong> We already did this with the <code>co_applicant</code> column, you only need to do the rest</li>
<li><strong>Tip:</strong> Just use <code>.replace</code></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mortgage</span><span class="o">.</span><span class="n">applicant_sex</span> <span class="o">=</span> <span class="n">mortgage</span><span class="o">.</span><span class="n">applicant_sex</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span>
    <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;female&#39;</span><span class="p">,</span>
    <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;na&#39;</span>
<span class="p">})</span>
<span class="n">mortgage</span><span class="o">.</span><span class="n">applicant_race</span> <span class="o">=</span> <span class="n">mortgage</span><span class="o">.</span><span class="n">applicant_race</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span>
    <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;native_amer&#39;</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;asian&#39;</span><span class="p">,</span>
    <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>
    <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;hawaiian&#39;</span><span class="p">,</span>
    <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span>
    <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;na&#39;</span><span class="p">,</span>
    <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;na&#39;</span><span class="p">,</span>
    <span class="mi">8</span><span class="p">:</span> <span class="s1">&#39;na&#39;</span><span class="p">,</span>
    <span class="mi">99</span><span class="p">:</span> <span class="s1">&#39;latino&#39;</span>
<span class="p">})</span>
<span class="n">mortgage</span><span class="o">.</span><span class="n">agency_code</span> <span class="o">=</span> <span class="n">mortgage</span><span class="o">.</span><span class="n">agency_code</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span>
    <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;OCC&#39;</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;FRS&#39;</span><span class="p">,</span>
    <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;FDIC&#39;</span><span class="p">,</span>
    <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;NCUA&#39;</span><span class="p">,</span>
    <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;HUD&#39;</span><span class="p">,</span>
    <span class="mi">9</span><span class="p">:</span> <span class="s1">&#39;CFPB&#39;</span>
<span class="p">})</span>
<span class="n">mortgage</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>census_tract</th>
      <th>county_code</th>
      <th>state_code</th>
      <th>applicant_sex</th>
      <th>income</th>
      <th>loan_amount</th>
      <th>loan_type</th>
      <th>property_type</th>
      <th>occupancy</th>
      <th>action_type</th>
      <th>loan_purpose</th>
      <th>agency_code</th>
      <th>tract_to_msa_income_percent</th>
      <th>applicant_race</th>
      <th>co_applicant_sex</th>
      <th>co_applicant</th>
      <th>loan_denied</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>42</th>
      <td>4019.00</td>
      <td>45</td>
      <td>42</td>
      <td>female</td>
      <td>59</td>
      <td>112</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>OCC</td>
      <td>133.09000</td>
      <td>white</td>
      <td>5</td>
      <td>no</td>
      <td>0</td>
    </tr>
    <tr>
      <th>43</th>
      <td>4099.02</td>
      <td>45</td>
      <td>42</td>
      <td>na</td>
      <td>177</td>
      <td>375</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>OCC</td>
      <td>208.56000</td>
      <td>na</td>
      <td>3</td>
      <td>unknown</td>
      <td>0</td>
    </tr>
    <tr>
      <th>46</th>
      <td>4102.00</td>
      <td>45</td>
      <td>42</td>
      <td>male</td>
      <td>150</td>
      <td>381</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>OCC</td>
      <td>215.35000</td>
      <td>white</td>
      <td>5</td>
      <td>no</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Double-check these columns match these values in the first three rows (and yes, you should have a lot of other columns, too).</p>
<table>
<thead><tr>
<th>applicant_sex</th>
<th>agency_code</th>
<th>applicant_race</th>
<th>co_applicant</th>
</tr>
</thead>
<tbody>
<tr>
<td>female</td>
<td>OCC</td>
<td>white</td>
<td>no</td>
</tr>
<tr>
<td>na</td>
<td>OCC</td>
<td>na</td>
<td>unknown</td>
</tr>
<tr>
<td>male</td>
<td>OCC</td>
<td>white</td>
<td>no</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Double-check-our-mortage-data">Double-check our mortage data<a class="anchor-link" href="#Double-check-our-mortage-data">#</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mortgage</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>census_tract</th>
      <th>county_code</th>
      <th>state_code</th>
      <th>applicant_sex</th>
      <th>income</th>
      <th>loan_amount</th>
      <th>loan_type</th>
      <th>property_type</th>
      <th>occupancy</th>
      <th>action_type</th>
      <th>loan_purpose</th>
      <th>agency_code</th>
      <th>tract_to_msa_income_percent</th>
      <th>applicant_race</th>
      <th>co_applicant_sex</th>
      <th>co_applicant</th>
      <th>loan_denied</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>42</th>
      <td>4019.00</td>
      <td>45</td>
      <td>42</td>
      <td>female</td>
      <td>59</td>
      <td>112</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>OCC</td>
      <td>133.09000</td>
      <td>white</td>
      <td>5</td>
      <td>no</td>
      <td>0</td>
    </tr>
    <tr>
      <th>43</th>
      <td>4099.02</td>
      <td>45</td>
      <td>42</td>
      <td>na</td>
      <td>177</td>
      <td>375</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>OCC</td>
      <td>208.56000</td>
      <td>na</td>
      <td>3</td>
      <td>unknown</td>
      <td>0</td>
    </tr>
    <tr>
      <th>46</th>
      <td>4102.00</td>
      <td>45</td>
      <td>42</td>
      <td>male</td>
      <td>150</td>
      <td>381</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>OCC</td>
      <td>215.35000</td>
      <td>white</td>
      <td>5</td>
      <td>no</td>
      <td>0</td>
    </tr>
    <tr>
      <th>48</th>
      <td>0312.00</td>
      <td>101</td>
      <td>42</td>
      <td>female</td>
      <td>65</td>
      <td>136</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>OCC</td>
      <td>93.11000</td>
      <td>asian</td>
      <td>5</td>
      <td>no</td>
      <td>0</td>
    </tr>
    <tr>
      <th>51</th>
      <td>4036.01</td>
      <td>45</td>
      <td>42</td>
      <td>female</td>
      <td>55</td>
      <td>196</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>OCC</td>
      <td>141.83000</td>
      <td>asian</td>
      <td>5</td>
      <td>no</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mortgage</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(10107, 17)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Census-data">Census data<a class="anchor-link" href="#Census-data">#</a></h1><p>Now we just need the final piece to the puzzle, the census data. Read in the census data file, calling the dataframe <code>census</code>.</p>
<blockquote><p><strong>Tip:</strong> As always, be sure to read the tract column in as a string. Interestingly, this time we <em>don't</em> need to worry about the state or county codes in the same way.</p>
<p><strong>Tip:</strong> You're going to encounter a problem that you find every time you read in a file from the US government!</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">census</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/nhgis0007_ds215_20155_2015_tract.csv&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;TRACTA&#39;</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">})</span>
<span class="n">census</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GISJOIN</th>
      <th>YEAR</th>
      <th>REGIONA</th>
      <th>DIVISIONA</th>
      <th>STATE</th>
      <th>STATEA</th>
      <th>COUNTY</th>
      <th>COUNTYA</th>
      <th>COUSUBA</th>
      <th>PLACEA</th>
      <th>TRACTA</th>
      <th>BLKGRPA</th>
      <th>CONCITA</th>
      <th>AIANHHA</th>
      <th>RES_ONLYA</th>
      <th>TRUSTA</th>
      <th>AITSCEA</th>
      <th>ANRCA</th>
      <th>CBSAA</th>
      <th>CSAA</th>
      <th>METDIVA</th>
      <th>NECTAA</th>
      <th>CNECTAA</th>
      <th>NECTADIVA</th>
      <th>UAA</th>
      <th>CDCURRA</th>
      <th>SLDUA</th>
      <th>SLDLA</th>
      <th>ZCTA5A</th>
      <th>SUBMCDA</th>
      <th>SDELMA</th>
      <th>SDSECA</th>
      <th>SDUNIA</th>
      <th>PUMA5A</th>
      <th>BTTRA</th>
      <th>BTBGA</th>
      <th>NAME_E</th>
      <th>ADK5E001</th>
      <th>ADK5E002</th>
      <th>ADK5E003</th>
      <th>ADK5E004</th>
      <th>ADK5E005</th>
      <th>ADK5E006</th>
      <th>ADK5E007</th>
      <th>ADK5E008</th>
      <th>ADK5E009</th>
      <th>ADK5E010</th>
      <th>ADK5E011</th>
      <th>ADK5E012</th>
      <th>ADK5E013</th>
      <th>ADK5E014</th>
      <th>ADK5E015</th>
      <th>ADK5E016</th>
      <th>ADK5E017</th>
      <th>ADK5E018</th>
      <th>ADK5E019</th>
      <th>ADK5E020</th>
      <th>ADK5E021</th>
      <th>NAME_M</th>
      <th>ADK5M001</th>
      <th>ADK5M002</th>
      <th>ADK5M003</th>
      <th>ADK5M004</th>
      <th>ADK5M005</th>
      <th>ADK5M006</th>
      <th>ADK5M007</th>
      <th>ADK5M008</th>
      <th>ADK5M009</th>
      <th>ADK5M010</th>
      <th>ADK5M011</th>
      <th>ADK5M012</th>
      <th>ADK5M013</th>
      <th>ADK5M014</th>
      <th>ADK5M015</th>
      <th>ADK5M016</th>
      <th>ADK5M017</th>
      <th>ADK5M018</th>
      <th>ADK5M019</th>
      <th>ADK5M020</th>
      <th>ADK5M021</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>G0100010020100</td>
      <td>2011-2015</td>
      <td>nan</td>
      <td>nan</td>
      <td>Alabama</td>
      <td>1</td>
      <td>Autauga County</td>
      <td>1</td>
      <td>nan</td>
      <td>nan</td>
      <td>020100</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>Census Tract 201, Autauga County, Alabama</td>
      <td>1948</td>
      <td>1931</td>
      <td>1703</td>
      <td>150</td>
      <td>6</td>
      <td>12</td>
      <td>0</td>
      <td>0</td>
      <td>60</td>
      <td>0</td>
      <td>60</td>
      <td>17</td>
      <td>17</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Census Tract 201, Autauga County, Alabama</td>
      <td>203</td>
      <td>212</td>
      <td>229</td>
      <td>126</td>
      <td>8</td>
      <td>16</td>
      <td>11</td>
      <td>11</td>
      <td>44</td>
      <td>11</td>
      <td>44</td>
      <td>21</td>
      <td>21</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
    </tr>
    <tr>
      <th>1</th>
      <td>G0100010020200</td>
      <td>2011-2015</td>
      <td>nan</td>
      <td>nan</td>
      <td>Alabama</td>
      <td>1</td>
      <td>Autauga County</td>
      <td>1</td>
      <td>nan</td>
      <td>nan</td>
      <td>020200</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>Census Tract 202, Autauga County, Alabama</td>
      <td>2156</td>
      <td>2139</td>
      <td>872</td>
      <td>1149</td>
      <td>0</td>
      <td>50</td>
      <td>0</td>
      <td>0</td>
      <td>68</td>
      <td>0</td>
      <td>68</td>
      <td>17</td>
      <td>14</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Census Tract 202, Autauga County, Alabama</td>
      <td>268</td>
      <td>268</td>
      <td>207</td>
      <td>250</td>
      <td>11</td>
      <td>61</td>
      <td>11</td>
      <td>11</td>
      <td>62</td>
      <td>11</td>
      <td>62</td>
      <td>25</td>
      <td>23</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>7</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Rename-some-columns">Rename some columns<a class="anchor-link" href="#Rename-some-columns">#</a></h2><p>If you like to keep your data extra clean, feel free to rename the columns you're interested in. If not, feel free to skip it!</p>
<blockquote><p><strong>Tip:</strong> Make sure you're using the estimates columns, not the margin of error columns</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># join on STATEA-state code, COUNTYA-county code, TRACTA-census tract (cleaned)</span>
<span class="n">census</span> <span class="o">=</span> <span class="n">census</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;ADK5E001&#39;</span><span class="p">:</span> <span class="s1">&#39;pop_total&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ADK5E003&#39;</span><span class="p">:</span> <span class="s1">&#39;pop_white&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ADK5E004&#39;</span><span class="p">:</span> <span class="s1">&#39;pop_black&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ADK5E005&#39;</span><span class="p">:</span> <span class="s1">&#39;pop_amer_indian&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ADK5E006&#39;</span><span class="p">:</span> <span class="s1">&#39;pop_asian&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ADK5E007&#39;</span><span class="p">:</span> <span class="s1">&#39;pop_pac_islander&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ADK5E012&#39;</span><span class="p">:</span> <span class="s1">&#39;pop_hispanic&#39;</span>
<span class="p">})</span>
<span class="n">census</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>GISJOIN</th>
      <td>G0100010020100</td>
      <td>G0100010020200</td>
    </tr>
    <tr>
      <th>YEAR</th>
      <td>2011-2015</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>REGIONA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>DIVISIONA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>STATE</th>
      <td>Alabama</td>
      <td>Alabama</td>
    </tr>
    <tr>
      <th>STATEA</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>COUNTY</th>
      <td>Autauga County</td>
      <td>Autauga County</td>
    </tr>
    <tr>
      <th>COUNTYA</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>COUSUBA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>PLACEA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>TRACTA</th>
      <td>020100</td>
      <td>020200</td>
    </tr>
    <tr>
      <th>BLKGRPA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>CONCITA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>AIANHHA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>RES_ONLYA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>TRUSTA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>AITSCEA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>ANRCA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>CBSAA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>CSAA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>METDIVA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NECTAA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>CNECTAA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NECTADIVA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>UAA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>CDCURRA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SLDUA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SLDLA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>ZCTA5A</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SUBMCDA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SDELMA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SDSECA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SDUNIA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>PUMA5A</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>BTTRA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>BTBGA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NAME_E</th>
      <td>Census Tract 201, Autauga County, Alabama</td>
      <td>Census Tract 202, Autauga County, Alabama</td>
    </tr>
    <tr>
      <th>pop_total</th>
      <td>1948</td>
      <td>2156</td>
    </tr>
    <tr>
      <th>ADK5E002</th>
      <td>1931</td>
      <td>2139</td>
    </tr>
    <tr>
      <th>pop_white</th>
      <td>1703</td>
      <td>872</td>
    </tr>
    <tr>
      <th>pop_black</th>
      <td>150</td>
      <td>1149</td>
    </tr>
    <tr>
      <th>pop_amer_indian</th>
      <td>6</td>
      <td>0</td>
    </tr>
    <tr>
      <th>pop_asian</th>
      <td>12</td>
      <td>50</td>
    </tr>
    <tr>
      <th>pop_pac_islander</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ADK5E008</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ADK5E009</th>
      <td>60</td>
      <td>68</td>
    </tr>
    <tr>
      <th>ADK5E010</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ADK5E011</th>
      <td>60</td>
      <td>68</td>
    </tr>
    <tr>
      <th>pop_hispanic</th>
      <td>17</td>
      <td>17</td>
    </tr>
    <tr>
      <th>ADK5E013</th>
      <td>17</td>
      <td>14</td>
    </tr>
    <tr>
      <th>ADK5E014</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ADK5E015</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ADK5E016</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ADK5E017</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ADK5E018</th>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>ADK5E019</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ADK5E020</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ADK5E021</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>NAME_M</th>
      <td>Census Tract 201, Autauga County, Alabama</td>
      <td>Census Tract 202, Autauga County, Alabama</td>
    </tr>
    <tr>
      <th>ADK5M001</th>
      <td>203</td>
      <td>268</td>
    </tr>
    <tr>
      <th>ADK5M002</th>
      <td>212</td>
      <td>268</td>
    </tr>
    <tr>
      <th>ADK5M003</th>
      <td>229</td>
      <td>207</td>
    </tr>
    <tr>
      <th>ADK5M004</th>
      <td>126</td>
      <td>250</td>
    </tr>
    <tr>
      <th>ADK5M005</th>
      <td>8</td>
      <td>11</td>
    </tr>
    <tr>
      <th>ADK5M006</th>
      <td>16</td>
      <td>61</td>
    </tr>
    <tr>
      <th>ADK5M007</th>
      <td>11</td>
      <td>11</td>
    </tr>
    <tr>
      <th>ADK5M008</th>
      <td>11</td>
      <td>11</td>
    </tr>
    <tr>
      <th>ADK5M009</th>
      <td>44</td>
      <td>62</td>
    </tr>
    <tr>
      <th>ADK5M010</th>
      <td>11</td>
      <td>11</td>
    </tr>
    <tr>
      <th>ADK5M011</th>
      <td>44</td>
      <td>62</td>
    </tr>
    <tr>
      <th>ADK5M012</th>
      <td>21</td>
      <td>25</td>
    </tr>
    <tr>
      <th>ADK5M013</th>
      <td>21</td>
      <td>23</td>
    </tr>
    <tr>
      <th>ADK5M014</th>
      <td>11</td>
      <td>11</td>
    </tr>
    <tr>
      <th>ADK5M015</th>
      <td>11</td>
      <td>11</td>
    </tr>
    <tr>
      <th>ADK5M016</th>
      <td>11</td>
      <td>11</td>
    </tr>
    <tr>
      <th>ADK5M017</th>
      <td>11</td>
      <td>11</td>
    </tr>
    <tr>
      <th>ADK5M018</th>
      <td>11</td>
      <td>7</td>
    </tr>
    <tr>
      <th>ADK5M019</th>
      <td>11</td>
      <td>11</td>
    </tr>
    <tr>
      <th>ADK5M020</th>
      <td>11</td>
      <td>11</td>
    </tr>
    <tr>
      <th>ADK5M021</th>
      <td>11</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Computed-columns">Computed columns<a class="anchor-link" href="#Computed-columns">#</a></h2><p>According to Reveal's regression output, you'll want to create the following columns:</p>
<ul>
<li>Percent Black in tract</li>
<li>Percent Hispanic/Latino in tract (I hope you know how Hispanic/Latino + census data works by now)</li>
<li>Percent Asian in tract</li>
<li>Percent Native American in tract</li>
<li>Percent Native Hawaiian in tract</li>
</ul>
<p>Notice that we don't include percent white - <strong>because all of the other columns add up to percent white, we ignore it!</strong> It's similar to a reference category.</p>
<blockquote><p>If we want to use buzzwords here, the technical reason we're not using percent white is called <strong>collinearity.</strong> We'll talk more about it on Friday.</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Merge-datasets">Merge datasets<a class="anchor-link" href="#Merge-datasets">#</a></h1><p>Merge <code>mortgage</code> and <code>census</code> into a new dataframe called <code>merged</code>.</p>
<p>Unfortunately something is a little different between our <code>mortgage</code> and <code>census</code> census tract columns. You'll need to fix it before you can merge.</p>
<h2 id="Cleaning">Cleaning<a class="anchor-link" href="#Cleaning">#</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mortgage</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>census_tract</th>
      <th>county_code</th>
      <th>state_code</th>
      <th>applicant_sex</th>
      <th>income</th>
      <th>loan_amount</th>
      <th>loan_type</th>
      <th>property_type</th>
      <th>occupancy</th>
      <th>action_type</th>
      <th>loan_purpose</th>
      <th>agency_code</th>
      <th>tract_to_msa_income_percent</th>
      <th>applicant_race</th>
      <th>co_applicant_sex</th>
      <th>co_applicant</th>
      <th>loan_denied</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>42</th>
      <td>4019.00</td>
      <td>45</td>
      <td>42</td>
      <td>female</td>
      <td>59</td>
      <td>112</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>OCC</td>
      <td>133.09000</td>
      <td>white</td>
      <td>5</td>
      <td>no</td>
      <td>0</td>
    </tr>
    <tr>
      <th>43</th>
      <td>4099.02</td>
      <td>45</td>
      <td>42</td>
      <td>na</td>
      <td>177</td>
      <td>375</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>OCC</td>
      <td>208.56000</td>
      <td>na</td>
      <td>3</td>
      <td>unknown</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">census</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GISJOIN</th>
      <th>YEAR</th>
      <th>REGIONA</th>
      <th>DIVISIONA</th>
      <th>STATE</th>
      <th>STATEA</th>
      <th>COUNTY</th>
      <th>COUNTYA</th>
      <th>COUSUBA</th>
      <th>PLACEA</th>
      <th>TRACTA</th>
      <th>BLKGRPA</th>
      <th>CONCITA</th>
      <th>AIANHHA</th>
      <th>RES_ONLYA</th>
      <th>TRUSTA</th>
      <th>AITSCEA</th>
      <th>ANRCA</th>
      <th>CBSAA</th>
      <th>CSAA</th>
      <th>METDIVA</th>
      <th>NECTAA</th>
      <th>CNECTAA</th>
      <th>NECTADIVA</th>
      <th>UAA</th>
      <th>CDCURRA</th>
      <th>SLDUA</th>
      <th>SLDLA</th>
      <th>ZCTA5A</th>
      <th>SUBMCDA</th>
      <th>SDELMA</th>
      <th>SDSECA</th>
      <th>SDUNIA</th>
      <th>PUMA5A</th>
      <th>BTTRA</th>
      <th>BTBGA</th>
      <th>NAME_E</th>
      <th>pop_total</th>
      <th>ADK5E002</th>
      <th>pop_white</th>
      <th>pop_black</th>
      <th>pop_amer_indian</th>
      <th>pop_asian</th>
      <th>pop_pac_islander</th>
      <th>ADK5E008</th>
      <th>ADK5E009</th>
      <th>ADK5E010</th>
      <th>ADK5E011</th>
      <th>pop_hispanic</th>
      <th>ADK5E013</th>
      <th>ADK5E014</th>
      <th>ADK5E015</th>
      <th>ADK5E016</th>
      <th>ADK5E017</th>
      <th>ADK5E018</th>
      <th>ADK5E019</th>
      <th>ADK5E020</th>
      <th>ADK5E021</th>
      <th>NAME_M</th>
      <th>ADK5M001</th>
      <th>ADK5M002</th>
      <th>ADK5M003</th>
      <th>ADK5M004</th>
      <th>ADK5M005</th>
      <th>ADK5M006</th>
      <th>ADK5M007</th>
      <th>ADK5M008</th>
      <th>ADK5M009</th>
      <th>ADK5M010</th>
      <th>ADK5M011</th>
      <th>ADK5M012</th>
      <th>ADK5M013</th>
      <th>ADK5M014</th>
      <th>ADK5M015</th>
      <th>ADK5M016</th>
      <th>ADK5M017</th>
      <th>ADK5M018</th>
      <th>ADK5M019</th>
      <th>ADK5M020</th>
      <th>ADK5M021</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>G0100010020100</td>
      <td>2011-2015</td>
      <td>nan</td>
      <td>nan</td>
      <td>Alabama</td>
      <td>1</td>
      <td>Autauga County</td>
      <td>1</td>
      <td>nan</td>
      <td>nan</td>
      <td>020100</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>Census Tract 201, Autauga County, Alabama</td>
      <td>1948</td>
      <td>1931</td>
      <td>1703</td>
      <td>150</td>
      <td>6</td>
      <td>12</td>
      <td>0</td>
      <td>0</td>
      <td>60</td>
      <td>0</td>
      <td>60</td>
      <td>17</td>
      <td>17</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Census Tract 201, Autauga County, Alabama</td>
      <td>203</td>
      <td>212</td>
      <td>229</td>
      <td>126</td>
      <td>8</td>
      <td>16</td>
      <td>11</td>
      <td>11</td>
      <td>44</td>
      <td>11</td>
      <td>44</td>
      <td>21</td>
      <td>21</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
    </tr>
    <tr>
      <th>1</th>
      <td>G0100010020200</td>
      <td>2011-2015</td>
      <td>nan</td>
      <td>nan</td>
      <td>Alabama</td>
      <td>1</td>
      <td>Autauga County</td>
      <td>1</td>
      <td>nan</td>
      <td>nan</td>
      <td>020200</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>Census Tract 202, Autauga County, Alabama</td>
      <td>2156</td>
      <td>2139</td>
      <td>872</td>
      <td>1149</td>
      <td>0</td>
      <td>50</td>
      <td>0</td>
      <td>0</td>
      <td>68</td>
      <td>0</td>
      <td>68</td>
      <td>17</td>
      <td>14</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Census Tract 202, Autauga County, Alabama</td>
      <td>268</td>
      <td>268</td>
      <td>207</td>
      <td>250</td>
      <td>11</td>
      <td>61</td>
      <td>11</td>
      <td>11</td>
      <td>62</td>
      <td>11</td>
      <td>62</td>
      <td>25</td>
      <td>23</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>7</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mortgage</span><span class="p">[</span><span class="s1">&#39;census_tract&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mortgage</span><span class="p">[</span><span class="s1">&#39;census_tract&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">mortgage</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>census_tract</th>
      <th>county_code</th>
      <th>state_code</th>
      <th>applicant_sex</th>
      <th>income</th>
      <th>loan_amount</th>
      <th>loan_type</th>
      <th>property_type</th>
      <th>occupancy</th>
      <th>action_type</th>
      <th>loan_purpose</th>
      <th>agency_code</th>
      <th>tract_to_msa_income_percent</th>
      <th>applicant_race</th>
      <th>co_applicant_sex</th>
      <th>co_applicant</th>
      <th>loan_denied</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>42</th>
      <td>401900</td>
      <td>45</td>
      <td>42</td>
      <td>female</td>
      <td>59</td>
      <td>112</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>OCC</td>
      <td>133.09000</td>
      <td>white</td>
      <td>5</td>
      <td>no</td>
      <td>0</td>
    </tr>
    <tr>
      <th>43</th>
      <td>409902</td>
      <td>45</td>
      <td>42</td>
      <td>na</td>
      <td>177</td>
      <td>375</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>OCC</td>
      <td>208.56000</td>
      <td>na</td>
      <td>3</td>
      <td>unknown</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Do-the-merge">Do the merge<a class="anchor-link" href="#Do-the-merge">#</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">merged</span> <span class="o">=</span> <span class="n">mortgage</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">census</span><span class="p">,</span>
                         <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;state_code&#39;</span><span class="p">,</span> <span class="s1">&#39;county_code&#39;</span><span class="p">,</span> <span class="s1">&#39;census_tract&#39;</span><span class="p">],</span>
                         <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;STATEA&#39;</span><span class="p">,</span> <span class="s1">&#39;COUNTYA&#39;</span><span class="p">,</span> <span class="s1">&#39;TRACTA&#39;</span><span class="p">])</span>
<span class="n">merged</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>census_tract</th>
      <th>county_code</th>
      <th>state_code</th>
      <th>applicant_sex</th>
      <th>income</th>
      <th>loan_amount</th>
      <th>loan_type</th>
      <th>property_type</th>
      <th>occupancy</th>
      <th>action_type</th>
      <th>loan_purpose</th>
      <th>agency_code</th>
      <th>tract_to_msa_income_percent</th>
      <th>applicant_race</th>
      <th>co_applicant_sex</th>
      <th>co_applicant</th>
      <th>loan_denied</th>
      <th>GISJOIN</th>
      <th>YEAR</th>
      <th>REGIONA</th>
      <th>DIVISIONA</th>
      <th>STATE</th>
      <th>STATEA</th>
      <th>COUNTY</th>
      <th>COUNTYA</th>
      <th>COUSUBA</th>
      <th>PLACEA</th>
      <th>TRACTA</th>
      <th>BLKGRPA</th>
      <th>CONCITA</th>
      <th>AIANHHA</th>
      <th>RES_ONLYA</th>
      <th>TRUSTA</th>
      <th>AITSCEA</th>
      <th>ANRCA</th>
      <th>CBSAA</th>
      <th>CSAA</th>
      <th>METDIVA</th>
      <th>NECTAA</th>
      <th>CNECTAA</th>
      <th>NECTADIVA</th>
      <th>UAA</th>
      <th>CDCURRA</th>
      <th>SLDUA</th>
      <th>SLDLA</th>
      <th>ZCTA5A</th>
      <th>SUBMCDA</th>
      <th>SDELMA</th>
      <th>SDSECA</th>
      <th>SDUNIA</th>
      <th>PUMA5A</th>
      <th>BTTRA</th>
      <th>BTBGA</th>
      <th>NAME_E</th>
      <th>pop_total</th>
      <th>ADK5E002</th>
      <th>pop_white</th>
      <th>pop_black</th>
      <th>pop_amer_indian</th>
      <th>pop_asian</th>
      <th>pop_pac_islander</th>
      <th>ADK5E008</th>
      <th>ADK5E009</th>
      <th>ADK5E010</th>
      <th>ADK5E011</th>
      <th>pop_hispanic</th>
      <th>ADK5E013</th>
      <th>ADK5E014</th>
      <th>ADK5E015</th>
      <th>ADK5E016</th>
      <th>ADK5E017</th>
      <th>ADK5E018</th>
      <th>ADK5E019</th>
      <th>ADK5E020</th>
      <th>ADK5E021</th>
      <th>NAME_M</th>
      <th>ADK5M001</th>
      <th>ADK5M002</th>
      <th>ADK5M003</th>
      <th>ADK5M004</th>
      <th>ADK5M005</th>
      <th>ADK5M006</th>
      <th>ADK5M007</th>
      <th>ADK5M008</th>
      <th>ADK5M009</th>
      <th>ADK5M010</th>
      <th>ADK5M011</th>
      <th>ADK5M012</th>
      <th>ADK5M013</th>
      <th>ADK5M014</th>
      <th>ADK5M015</th>
      <th>ADK5M016</th>
      <th>ADK5M017</th>
      <th>ADK5M018</th>
      <th>ADK5M019</th>
      <th>ADK5M020</th>
      <th>ADK5M021</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>401900</td>
      <td>45</td>
      <td>42</td>
      <td>female</td>
      <td>59</td>
      <td>112</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>OCC</td>
      <td>133.09000</td>
      <td>white</td>
      <td>5</td>
      <td>no</td>
      <td>0</td>
      <td>G4200450401900</td>
      <td>2011-2015</td>
      <td>nan</td>
      <td>nan</td>
      <td>Pennsylvania</td>
      <td>42</td>
      <td>Delaware County</td>
      <td>45</td>
      <td>nan</td>
      <td>nan</td>
      <td>401900</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>Census Tract 4019, Delaware County, Pennsylvania</td>
      <td>4219</td>
      <td>4181</td>
      <td>2064</td>
      <td>1719</td>
      <td>0</td>
      <td>224</td>
      <td>0</td>
      <td>0</td>
      <td>174</td>
      <td>21</td>
      <td>153</td>
      <td>38</td>
      <td>21</td>
      <td>0</td>
      <td>17</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Census Tract 4019, Delaware County, Pennsylvania</td>
      <td>210</td>
      <td>210</td>
      <td>210</td>
      <td>224</td>
      <td>10</td>
      <td>146</td>
      <td>10</td>
      <td>10</td>
      <td>139</td>
      <td>34</td>
      <td>121</td>
      <td>36</td>
      <td>24</td>
      <td>10</td>
      <td>26</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>401900</td>
      <td>45</td>
      <td>42</td>
      <td>male</td>
      <td>63</td>
      <td>192</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>NCUA</td>
      <td>133.09000</td>
      <td>na</td>
      <td>5</td>
      <td>no</td>
      <td>0</td>
      <td>G4200450401900</td>
      <td>2011-2015</td>
      <td>nan</td>
      <td>nan</td>
      <td>Pennsylvania</td>
      <td>42</td>
      <td>Delaware County</td>
      <td>45</td>
      <td>nan</td>
      <td>nan</td>
      <td>401900</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>Census Tract 4019, Delaware County, Pennsylvania</td>
      <td>4219</td>
      <td>4181</td>
      <td>2064</td>
      <td>1719</td>
      <td>0</td>
      <td>224</td>
      <td>0</td>
      <td>0</td>
      <td>174</td>
      <td>21</td>
      <td>153</td>
      <td>38</td>
      <td>21</td>
      <td>0</td>
      <td>17</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Census Tract 4019, Delaware County, Pennsylvania</td>
      <td>210</td>
      <td>210</td>
      <td>210</td>
      <td>224</td>
      <td>10</td>
      <td>146</td>
      <td>10</td>
      <td>10</td>
      <td>139</td>
      <td>34</td>
      <td>121</td>
      <td>36</td>
      <td>24</td>
      <td>10</td>
      <td>26</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>401900</td>
      <td>45</td>
      <td>42</td>
      <td>female</td>
      <td>80</td>
      <td>105</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>FDIC</td>
      <td>133.09000</td>
      <td>black</td>
      <td>1</td>
      <td>yes</td>
      <td>0</td>
      <td>G4200450401900</td>
      <td>2011-2015</td>
      <td>nan</td>
      <td>nan</td>
      <td>Pennsylvania</td>
      <td>42</td>
      <td>Delaware County</td>
      <td>45</td>
      <td>nan</td>
      <td>nan</td>
      <td>401900</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>Census Tract 4019, Delaware County, Pennsylvania</td>
      <td>4219</td>
      <td>4181</td>
      <td>2064</td>
      <td>1719</td>
      <td>0</td>
      <td>224</td>
      <td>0</td>
      <td>0</td>
      <td>174</td>
      <td>21</td>
      <td>153</td>
      <td>38</td>
      <td>21</td>
      <td>0</td>
      <td>17</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Census Tract 4019, Delaware County, Pennsylvania</td>
      <td>210</td>
      <td>210</td>
      <td>210</td>
      <td>224</td>
      <td>10</td>
      <td>146</td>
      <td>10</td>
      <td>10</td>
      <td>139</td>
      <td>34</td>
      <td>121</td>
      <td>36</td>
      <td>24</td>
      <td>10</td>
      <td>26</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>401900</td>
      <td>45</td>
      <td>42</td>
      <td>female</td>
      <td>84</td>
      <td>128</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>NCUA</td>
      <td>133.09000</td>
      <td>white</td>
      <td>1</td>
      <td>yes</td>
      <td>0</td>
      <td>G4200450401900</td>
      <td>2011-2015</td>
      <td>nan</td>
      <td>nan</td>
      <td>Pennsylvania</td>
      <td>42</td>
      <td>Delaware County</td>
      <td>45</td>
      <td>nan</td>
      <td>nan</td>
      <td>401900</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>Census Tract 4019, Delaware County, Pennsylvania</td>
      <td>4219</td>
      <td>4181</td>
      <td>2064</td>
      <td>1719</td>
      <td>0</td>
      <td>224</td>
      <td>0</td>
      <td>0</td>
      <td>174</td>
      <td>21</td>
      <td>153</td>
      <td>38</td>
      <td>21</td>
      <td>0</td>
      <td>17</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Census Tract 4019, Delaware County, Pennsylvania</td>
      <td>210</td>
      <td>210</td>
      <td>210</td>
      <td>224</td>
      <td>10</td>
      <td>146</td>
      <td>10</td>
      <td>10</td>
      <td>139</td>
      <td>34</td>
      <td>121</td>
      <td>36</td>
      <td>24</td>
      <td>10</td>
      <td>26</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>401900</td>
      <td>45</td>
      <td>42</td>
      <td>female</td>
      <td>26</td>
      <td>168</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>NCUA</td>
      <td>133.09000</td>
      <td>black</td>
      <td>5</td>
      <td>no</td>
      <td>1</td>
      <td>G4200450401900</td>
      <td>2011-2015</td>
      <td>nan</td>
      <td>nan</td>
      <td>Pennsylvania</td>
      <td>42</td>
      <td>Delaware County</td>
      <td>45</td>
      <td>nan</td>
      <td>nan</td>
      <td>401900</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>Census Tract 4019, Delaware County, Pennsylvania</td>
      <td>4219</td>
      <td>4181</td>
      <td>2064</td>
      <td>1719</td>
      <td>0</td>
      <td>224</td>
      <td>0</td>
      <td>0</td>
      <td>174</td>
      <td>21</td>
      <td>153</td>
      <td>38</td>
      <td>21</td>
      <td>0</td>
      <td>17</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Census Tract 4019, Delaware County, Pennsylvania</td>
      <td>210</td>
      <td>210</td>
      <td>210</td>
      <td>224</td>
      <td>10</td>
      <td>146</td>
      <td>10</td>
      <td>10</td>
      <td>139</td>
      <td>34</td>
      <td>121</td>
      <td>36</td>
      <td>24</td>
      <td>10</td>
      <td>26</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Confirm you have 10107 rows and 96 columns in the merged dataframe.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">merged</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(10107, 97)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="WE-ARENT-DROPPING-NA-DATA">WE ARENT DROPPING NA DATA<a class="anchor-link" href="#WE-ARENT-DROPPING-NA-DATA">#</a></h1><h1 id="WE-ARENT-DROPPING-NA-DATA">WE ARENT DROPPING NA DATA<a class="anchor-link" href="#WE-ARENT-DROPPING-NA-DATA">#</a></h1><h1 id="WE-ARENT-DROPPING-NA-DATA">WE ARENT DROPPING NA DATA<a class="anchor-link" href="#WE-ARENT-DROPPING-NA-DATA">#</a></h1><h1 id="WE-ARENT-DROPPING-NA-DATA">WE ARENT DROPPING NA DATA<a class="anchor-link" href="#WE-ARENT-DROPPING-NA-DATA">#</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">merged</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>census_tract</th>
      <td>401900</td>
      <td>401900</td>
    </tr>
    <tr>
      <th>county_code</th>
      <td>45</td>
      <td>45</td>
    </tr>
    <tr>
      <th>state_code</th>
      <td>42</td>
      <td>42</td>
    </tr>
    <tr>
      <th>applicant_sex</th>
      <td>female</td>
      <td>male</td>
    </tr>
    <tr>
      <th>income</th>
      <td>59</td>
      <td>63</td>
    </tr>
    <tr>
      <th>loan_amount</th>
      <td>112</td>
      <td>192</td>
    </tr>
    <tr>
      <th>loan_type</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>property_type</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>occupancy</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>action_type</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>loan_purpose</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>agency_code</th>
      <td>OCC</td>
      <td>NCUA</td>
    </tr>
    <tr>
      <th>tract_to_msa_income_percent</th>
      <td>133.09000</td>
      <td>133.09000</td>
    </tr>
    <tr>
      <th>applicant_race</th>
      <td>white</td>
      <td>na</td>
    </tr>
    <tr>
      <th>co_applicant_sex</th>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>co_applicant</th>
      <td>no</td>
      <td>no</td>
    </tr>
    <tr>
      <th>loan_denied</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>GISJOIN</th>
      <td>G4200450401900</td>
      <td>G4200450401900</td>
    </tr>
    <tr>
      <th>YEAR</th>
      <td>2011-2015</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>REGIONA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>DIVISIONA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>STATE</th>
      <td>Pennsylvania</td>
      <td>Pennsylvania</td>
    </tr>
    <tr>
      <th>STATEA</th>
      <td>42</td>
      <td>42</td>
    </tr>
    <tr>
      <th>COUNTY</th>
      <td>Delaware County</td>
      <td>Delaware County</td>
    </tr>
    <tr>
      <th>COUNTYA</th>
      <td>45</td>
      <td>45</td>
    </tr>
    <tr>
      <th>COUSUBA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>PLACEA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>TRACTA</th>
      <td>401900</td>
      <td>401900</td>
    </tr>
    <tr>
      <th>BLKGRPA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>CONCITA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>AIANHHA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>RES_ONLYA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>TRUSTA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>AITSCEA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>ANRCA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>CBSAA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>CSAA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>METDIVA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NECTAA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>CNECTAA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NECTADIVA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>UAA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>CDCURRA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SLDUA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SLDLA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>ZCTA5A</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SUBMCDA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SDELMA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SDSECA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SDUNIA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>PUMA5A</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>BTTRA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>BTBGA</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NAME_E</th>
      <td>Census Tract 4019, Delaware County, Pennsylvania</td>
      <td>Census Tract 4019, Delaware County, Pennsylvania</td>
    </tr>
    <tr>
      <th>pop_total</th>
      <td>4219</td>
      <td>4219</td>
    </tr>
    <tr>
      <th>ADK5E002</th>
      <td>4181</td>
      <td>4181</td>
    </tr>
    <tr>
      <th>pop_white</th>
      <td>2064</td>
      <td>2064</td>
    </tr>
    <tr>
      <th>pop_black</th>
      <td>1719</td>
      <td>1719</td>
    </tr>
    <tr>
      <th>pop_amer_indian</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>pop_asian</th>
      <td>224</td>
      <td>224</td>
    </tr>
    <tr>
      <th>pop_pac_islander</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ADK5E008</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ADK5E009</th>
      <td>174</td>
      <td>174</td>
    </tr>
    <tr>
      <th>ADK5E010</th>
      <td>21</td>
      <td>21</td>
    </tr>
    <tr>
      <th>ADK5E011</th>
      <td>153</td>
      <td>153</td>
    </tr>
    <tr>
      <th>pop_hispanic</th>
      <td>38</td>
      <td>38</td>
    </tr>
    <tr>
      <th>ADK5E013</th>
      <td>21</td>
      <td>21</td>
    </tr>
    <tr>
      <th>ADK5E014</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ADK5E015</th>
      <td>17</td>
      <td>17</td>
    </tr>
    <tr>
      <th>ADK5E016</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ADK5E017</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ADK5E018</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ADK5E019</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ADK5E020</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ADK5E021</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>NAME_M</th>
      <td>Census Tract 4019, Delaware County, Pennsylvania</td>
      <td>Census Tract 4019, Delaware County, Pennsylvania</td>
    </tr>
    <tr>
      <th>ADK5M001</th>
      <td>210</td>
      <td>210</td>
    </tr>
    <tr>
      <th>ADK5M002</th>
      <td>210</td>
      <td>210</td>
    </tr>
    <tr>
      <th>ADK5M003</th>
      <td>210</td>
      <td>210</td>
    </tr>
    <tr>
      <th>ADK5M004</th>
      <td>224</td>
      <td>224</td>
    </tr>
    <tr>
      <th>ADK5M005</th>
      <td>10</td>
      <td>10</td>
    </tr>
    <tr>
      <th>ADK5M006</th>
      <td>146</td>
      <td>146</td>
    </tr>
    <tr>
      <th>ADK5M007</th>
      <td>10</td>
      <td>10</td>
    </tr>
    <tr>
      <th>ADK5M008</th>
      <td>10</td>
      <td>10</td>
    </tr>
    <tr>
      <th>ADK5M009</th>
      <td>139</td>
      <td>139</td>
    </tr>
    <tr>
      <th>ADK5M010</th>
      <td>34</td>
      <td>34</td>
    </tr>
    <tr>
      <th>ADK5M011</th>
      <td>121</td>
      <td>121</td>
    </tr>
    <tr>
      <th>ADK5M012</th>
      <td>36</td>
      <td>36</td>
    </tr>
    <tr>
      <th>ADK5M013</th>
      <td>24</td>
      <td>24</td>
    </tr>
    <tr>
      <th>ADK5M014</th>
      <td>10</td>
      <td>10</td>
    </tr>
    <tr>
      <th>ADK5M015</th>
      <td>26</td>
      <td>26</td>
    </tr>
    <tr>
      <th>ADK5M016</th>
      <td>10</td>
      <td>10</td>
    </tr>
    <tr>
      <th>ADK5M017</th>
      <td>10</td>
      <td>10</td>
    </tr>
    <tr>
      <th>ADK5M018</th>
      <td>10</td>
      <td>10</td>
    </tr>
    <tr>
      <th>ADK5M019</th>
      <td>10</td>
      <td>10</td>
    </tr>
    <tr>
      <th>ADK5M020</th>
      <td>10</td>
      <td>10</td>
    </tr>
    <tr>
      <th>ADK5M021</th>
      <td>10</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Performing-our-regression">Performing our regression<a class="anchor-link" href="#Performing-our-regression">#</a></h1><p><strong>Note:</strong> When working with statsmodels formulas, <strong>you don't need to drop missing data.</strong> It's handled automatically as part of the <code>.fit()</code> process.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Working-with-statsmodels-formulas">Working with statsmodels formulas<a class="anchor-link" href="#Working-with-statsmodels-formulas">#</a></h2><p>Statsmodels formulas are a fun (yes, fun! exciting! amazing!) way to write regressions. For example, I can write a formula to say "calculate the relationship between a loan being denied in relation to the loan amount and the applicant's income."</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">logit</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    loan_denied ~ loan_amount + income</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">merged</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization terminated successfully.
         Current function value: 0.365688
         Iterations 7
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<table class="simpletable">
<caption>Logit Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>      <td>loan_denied</td>   <th>  No. Observations:  </th>  <td> 10107</td>  
</tr>
<tr>
  <th>Model:</th>                 <td>Logit</td>      <th>  Df Residuals:      </th>  <td> 10104</td>  
</tr>
<tr>
  <th>Method:</th>                 <td>MLE</td>       <th>  Df Model:          </th>  <td>     2</td>  
</tr>
<tr>
  <th>Date:</th>            <td>Thu, 07 Nov 2019</td> <th>  Pseudo R-squ.:     </th>  <td>0.01192</td> 
</tr>
<tr>
  <th>Time:</th>                <td>13:13:01</td>     <th>  Log-Likelihood:    </th> <td> -3696.0</td> 
</tr>
<tr>
  <th>converged:</th>             <td>True</td>       <th>  LL-Null:           </th> <td> -3740.6</td> 
</tr>
<tr>
  <th>Covariance Type:</th>     <td>nonrobust</td>    <th>  LLR p-value:       </th> <td>4.380e-20</td>
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>   <td>   -1.5269</td> <td>    0.058</td> <td>  -26.406</td> <td> 0.000</td> <td>   -1.640</td> <td>   -1.414</td>
</tr>
<tr>
  <th>loan_amount</th> <td>   -0.0015</td> <td>    0.000</td> <td>   -5.093</td> <td> 0.000</td> <td>   -0.002</td> <td>   -0.001</td>
</tr>
<tr>
  <th>income</th>      <td>   -0.0010</td> <td>    0.000</td> <td>   -1.952</td> <td> 0.051</td> <td>   -0.002</td> <td> 4.04e-06</td>
</tr>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>But that's child's play: we're here to get a little bit crazy.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Formulas-and-calculations-in-statsmodels-formulas">Formulas and calculations in statsmodels formulas<a class="anchor-link" href="#Formulas-and-calculations-in-statsmodels-formulas">#</a></h2><p>Let's do this! Instead of building new columns in pandas, <strong>we're just going to tell statsmodels to do it for us</strong>. This is using something called <a href="https://patsy.readthedocs.io/en/latest/formulas.html">Patsy</a>, imitating the programming language R.</p>
<table>
<thead><tr>
<th>description</th>
<th>pandas style</th>
<th>formula style</th>
</tr>
</thead>
<tbody>
<tr>
<td>Multiply column</td>
<td><code>df.colname * 100</code></td>
<td><code>np.multiply(colname, 100)</code></td>
</tr>
<tr>
<td>Divide columns</td>
<td><code>df.loan_amount / df.income</code></td>
<td><code>np.divide(loan_amount, income)</code></td>
</tr>
<tr>
<td>Percentage</td>
<td><code>df.pop_black / pop_total * 100</code></td>
<td><code>np.multiply(pop_black / pop_total, 100)</code></td>
</tr>
<tr>
<td>Calculate log</td>
<td><code>np.log(income)</code></td>
<td><code>np.log(income)</code></td>
</tr>
<tr>
<td>One-hot encoding</td>
<td><code>pd.get_dummies(df.agency_code).drop('FDIC', axis=1)</code></td>
<td><code>C(agency_code, Treatment('FDIC')</code></td>
</tr>
</tbody>
</table>
<blockquote><p>If you haven't heard of one-hot encoding before, I recommend reading the longer version of this notebook! Or looking at what happens down below and thinking it through.</p>
</blockquote>
<p>If we follow Reveal's methodology, we have a nice long list of features to include in our formula. Turning them all into a statsmodel/Patsy formula, the result looks like this:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">logit</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    loan_denied ~ </span>
<span class="s2">        tract_to_msa_income_percent</span>
<span class="s2">        + np.log(income)</span>
<span class="s2">        + np.log(loan_amount)</span>
<span class="s2">        + np.divide(loan_amount, income)</span>
<span class="s2">        + C(co_applicant, Treatment(&#39;no&#39;))</span>
<span class="s2">        + C(applicant_sex, Treatment(&#39;female&#39;))</span>
<span class="s2">        + C(applicant_race, Treatment(&#39;white&#39;))</span>
<span class="s2">        + C(agency_code, Treatment(&#39;FDIC&#39;))</span>
<span class="s2">        + np.multiply(pop_hispanic / pop_total, 100)</span>
<span class="s2">        + np.multiply(pop_black / pop_total, 100)</span>
<span class="s2">        + np.multiply(pop_amer_indian / pop_total, 100)</span>
<span class="s2">        + np.multiply(pop_asian / pop_total, 100)</span>
<span class="s2">        + np.multiply(pop_pac_islander / pop_total, 100)</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">merged</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization terminated successfully.
         Current function value: 0.334016
         Iterations 7
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<table class="simpletable">
<caption>Logit Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>      <td>loan_denied</td>   <th>  No. Observations:  </th>   <td> 10107</td>  
</tr>
<tr>
  <th>Model:</th>                 <td>Logit</td>      <th>  Df Residuals:      </th>   <td> 10082</td>  
</tr>
<tr>
  <th>Method:</th>                 <td>MLE</td>       <th>  Df Model:          </th>   <td>    24</td>  
</tr>
<tr>
  <th>Date:</th>            <td>Tue, 05 Nov 2019</td> <th>  Pseudo R-squ.:     </th>   <td>0.09749</td> 
</tr>
<tr>
  <th>Time:</th>                <td>12:37:44</td>     <th>  Log-Likelihood:    </th>  <td> -3375.9</td> 
</tr>
<tr>
  <th>converged:</th>             <td>True</td>       <th>  LL-Null:           </th>  <td> -3740.6</td> 
</tr>
<tr>
  <th>Covariance Type:</th>     <td>nonrobust</td>    <th>  LLR p-value:       </th> <td>1.629e-138</td>
</tr>
</table>
<table class="simpletable">
<tr>
                            <td></td>                              <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>                                            <td>   -0.6024</td> <td>    0.306</td> <td>   -1.971</td> <td> 0.049</td> <td>   -1.202</td> <td>   -0.003</td>
</tr>
<tr>
  <th>C(co_applicant, Treatment('no'))[T.unknown]</th>          <td>    0.3957</td> <td>    0.207</td> <td>    1.914</td> <td> 0.056</td> <td>   -0.010</td> <td>    0.801</td>
</tr>
<tr>
  <th>C(co_applicant, Treatment('no'))[T.yes]</th>              <td>   -0.0958</td> <td>    0.078</td> <td>   -1.222</td> <td> 0.222</td> <td>   -0.249</td> <td>    0.058</td>
</tr>
<tr>
  <th>C(applicant_sex, Treatment('female'))[T.male]</th>        <td>    0.1213</td> <td>    0.070</td> <td>    1.722</td> <td> 0.085</td> <td>   -0.017</td> <td>    0.259</td>
</tr>
<tr>
  <th>C(applicant_sex, Treatment('female'))[T.na]</th>          <td>   -0.1091</td> <td>    0.176</td> <td>   -0.618</td> <td> 0.537</td> <td>   -0.455</td> <td>    0.237</td>
</tr>
<tr>
  <th>C(applicant_race, Treatment('white'))[T.asian]</th>       <td>    0.3783</td> <td>    0.105</td> <td>    3.595</td> <td> 0.000</td> <td>    0.172</td> <td>    0.584</td>
</tr>
<tr>
  <th>C(applicant_race, Treatment('white'))[T.black]</th>       <td>    0.7496</td> <td>    0.115</td> <td>    6.506</td> <td> 0.000</td> <td>    0.524</td> <td>    0.975</td>
</tr>
<tr>
  <th>C(applicant_race, Treatment('white'))[T.hawaiian]</th>    <td>    1.0989</td> <td>    0.464</td> <td>    2.368</td> <td> 0.018</td> <td>    0.189</td> <td>    2.008</td>
</tr>
<tr>
  <th>C(applicant_race, Treatment('white'))[T.latino]</th>      <td>    0.3232</td> <td>    0.164</td> <td>    1.970</td> <td> 0.049</td> <td>    0.002</td> <td>    0.645</td>
</tr>
<tr>
  <th>C(applicant_race, Treatment('white'))[T.na]</th>          <td>    0.4511</td> <td>    0.119</td> <td>    3.798</td> <td> 0.000</td> <td>    0.218</td> <td>    0.684</td>
</tr>
<tr>
  <th>C(applicant_race, Treatment('white'))[T.native_amer]</th> <td>    1.0546</td> <td>    0.591</td> <td>    1.785</td> <td> 0.074</td> <td>   -0.103</td> <td>    2.213</td>
</tr>
<tr>
  <th>C(agency_code, Treatment('FDIC'))[T.CFPB]</th>            <td>    1.1066</td> <td>    0.136</td> <td>    8.158</td> <td> 0.000</td> <td>    0.841</td> <td>    1.372</td>
</tr>
<tr>
  <th>C(agency_code, Treatment('FDIC'))[T.FRS]</th>             <td>   -0.1133</td> <td>    0.221</td> <td>   -0.513</td> <td> 0.608</td> <td>   -0.546</td> <td>    0.319</td>
</tr>
<tr>
  <th>C(agency_code, Treatment('FDIC'))[T.HUD]</th>             <td>    0.1170</td> <td>    0.140</td> <td>    0.837</td> <td> 0.402</td> <td>   -0.157</td> <td>    0.391</td>
</tr>
<tr>
  <th>C(agency_code, Treatment('FDIC'))[T.NCUA]</th>            <td>    1.3009</td> <td>    0.153</td> <td>    8.507</td> <td> 0.000</td> <td>    1.001</td> <td>    1.601</td>
</tr>
<tr>
  <th>C(agency_code, Treatment('FDIC'))[T.OCC]</th>             <td>    0.3160</td> <td>    0.201</td> <td>    1.575</td> <td> 0.115</td> <td>   -0.077</td> <td>    0.709</td>
</tr>
<tr>
  <th>tract_to_msa_income_percent</th>                          <td>    0.0017</td> <td>    0.001</td> <td>    2.627</td> <td> 0.009</td> <td>    0.000</td> <td>    0.003</td>
</tr>
<tr>
  <th>np.log(income)</th>                                       <td>   -0.3555</td> <td>    0.070</td> <td>   -5.104</td> <td> 0.000</td> <td>   -0.492</td> <td>   -0.219</td>
</tr>
<tr>
  <th>np.log(loan_amount)</th>                                  <td>   -0.2283</td> <td>    0.056</td> <td>   -4.060</td> <td> 0.000</td> <td>   -0.338</td> <td>   -0.118</td>
</tr>
<tr>
  <th>np.divide(loan_amount, income)</th>                       <td>    0.0110</td> <td>    0.007</td> <td>    1.476</td> <td> 0.140</td> <td>   -0.004</td> <td>    0.026</td>
</tr>
<tr>
  <th>np.multiply(pop_hispanic / pop_total, 100)</th>           <td>    0.0072</td> <td>    0.004</td> <td>    2.050</td> <td> 0.040</td> <td>    0.000</td> <td>    0.014</td>
</tr>
<tr>
  <th>np.multiply(pop_black / pop_total, 100)</th>              <td>    0.0062</td> <td>    0.002</td> <td>    3.884</td> <td> 0.000</td> <td>    0.003</td> <td>    0.009</td>
</tr>
<tr>
  <th>np.multiply(pop_amer_indian / pop_total, 100)</th>        <td>   -0.2571</td> <td>    0.097</td> <td>   -2.652</td> <td> 0.008</td> <td>   -0.447</td> <td>   -0.067</td>
</tr>
<tr>
  <th>np.multiply(pop_asian / pop_total, 100)</th>              <td>    0.0107</td> <td>    0.004</td> <td>    2.427</td> <td> 0.015</td> <td>    0.002</td> <td>    0.019</td>
</tr>
<tr>
  <th>np.multiply(pop_pac_islander / pop_total, 100)</th>       <td>    0.0904</td> <td>    0.159</td> <td>    0.568</td> <td> 0.570</td> <td>   -0.221</td> <td>    0.402</td>
</tr>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It's beautiful! It's amazing! We just wrote our formulas inside of the statsmodel formula, and <strong>it did all the work for us.</strong></p>
<p><em>I'm not crying, you're crying.</em></p>
<h2 id="Sorting-by-odds-ratio">Sorting by odds ratio<a class="anchor-link" href="#Sorting-by-odds-ratio">#</a></h2><p>Since we're interested in the odds ratio, it makes sense to reformat our results, add an <strong>odds ratio</strong> column, and sort the output.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">feature_names</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">index</span>
<span class="n">coefficients</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">values</span>

<span class="n">coefs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;coef&#39;</span><span class="p">:</span> <span class="n">coefficients</span><span class="p">,</span>
    <span class="s1">&#39;odds ratio&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
    <span class="s1">&#39;pvalue&#39;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">pvalues</span>
<span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;odds ratio&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">coefs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>coef</th>
      <th>odds ratio</th>
      <th>pvalue</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C(agency_code, Treatment('FDIC'))[T.NCUA]</th>
      <td>1.30091</td>
      <td>3.67262</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>C(agency_code, Treatment('FDIC'))[T.CFPB]</th>
      <td>1.10661</td>
      <td>3.02410</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>C(applicant_race, Treatment('white'))[T.hawaiian]</th>
      <td>1.09891</td>
      <td>3.00090</td>
      <td>0.01787</td>
    </tr>
    <tr>
      <th>C(applicant_race, Treatment('white'))[T.native_amer]</th>
      <td>1.05461</td>
      <td>2.87087</td>
      <td>0.07426</td>
    </tr>
    <tr>
      <th>C(applicant_race, Treatment('white'))[T.black]</th>
      <td>0.74963</td>
      <td>2.11622</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>C(applicant_race, Treatment('white'))[T.na]</th>
      <td>0.45112</td>
      <td>1.57007</td>
      <td>0.00015</td>
    </tr>
    <tr>
      <th>C(co_applicant, Treatment('no'))[T.unknown]</th>
      <td>0.39570</td>
      <td>1.48543</td>
      <td>0.05568</td>
    </tr>
    <tr>
      <th>C(applicant_race, Treatment('white'))[T.asian]</th>
      <td>0.37826</td>
      <td>1.45974</td>
      <td>0.00032</td>
    </tr>
    <tr>
      <th>C(applicant_race, Treatment('white'))[T.latino]</th>
      <td>0.32318</td>
      <td>1.38151</td>
      <td>0.04881</td>
    </tr>
    <tr>
      <th>C(agency_code, Treatment('FDIC'))[T.OCC]</th>
      <td>0.31598</td>
      <td>1.37160</td>
      <td>0.11521</td>
    </tr>
    <tr>
      <th>C(applicant_sex, Treatment('female'))[T.male]</th>
      <td>0.12133</td>
      <td>1.12900</td>
      <td>0.08514</td>
    </tr>
    <tr>
      <th>C(agency_code, Treatment('FDIC'))[T.HUD]</th>
      <td>0.11701</td>
      <td>1.12413</td>
      <td>0.40245</td>
    </tr>
    <tr>
      <th>np.multiply(pop_pac_islander / pop_total, 100)</th>
      <td>0.09038</td>
      <td>1.09459</td>
      <td>0.56988</td>
    </tr>
    <tr>
      <th>np.divide(loan_amount, income)</th>
      <td>0.01096</td>
      <td>1.01102</td>
      <td>0.13984</td>
    </tr>
    <tr>
      <th>np.multiply(pop_asian / pop_total, 100)</th>
      <td>0.01069</td>
      <td>1.01074</td>
      <td>0.01522</td>
    </tr>
    <tr>
      <th>np.multiply(pop_hispanic / pop_total, 100)</th>
      <td>0.00719</td>
      <td>1.00721</td>
      <td>0.04041</td>
    </tr>
    <tr>
      <th>np.multiply(pop_black / pop_total, 100)</th>
      <td>0.00623</td>
      <td>1.00625</td>
      <td>0.00010</td>
    </tr>
    <tr>
      <th>tract_to_msa_income_percent</th>
      <td>0.00175</td>
      <td>1.00175</td>
      <td>0.00862</td>
    </tr>
    <tr>
      <th>C(co_applicant, Treatment('no'))[T.yes]</th>
      <td>-0.09583</td>
      <td>0.90862</td>
      <td>0.22154</td>
    </tr>
    <tr>
      <th>C(applicant_sex, Treatment('female'))[T.na]</th>
      <td>-0.10905</td>
      <td>0.89668</td>
      <td>0.53657</td>
    </tr>
    <tr>
      <th>C(agency_code, Treatment('FDIC'))[T.FRS]</th>
      <td>-0.11333</td>
      <td>0.89285</td>
      <td>0.60766</td>
    </tr>
    <tr>
      <th>np.log(loan_amount)</th>
      <td>-0.22825</td>
      <td>0.79592</td>
      <td>0.00005</td>
    </tr>
    <tr>
      <th>np.multiply(pop_amer_indian / pop_total, 100)</th>
      <td>-0.25706</td>
      <td>0.77332</td>
      <td>0.00801</td>
    </tr>
    <tr>
      <th>np.log(income)</th>
      <td>-0.35546</td>
      <td>0.70085</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>Intercept</th>
      <td>-0.60242</td>
      <td>0.54748</td>
      <td>0.04874</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And there we go! Except, of course, it's <strong>very ugly</strong>.</p>
<p>While writing the formula was a lot nicer and less error-prone (I think) than building a dataframe of our features, <strong>the output is horrendous</strong>. Those features names are <strong>terrible!</strong> It looks <em>so so so bad.</em></p>
<p>We thought we had a beautiful world ahead of us in terms of writing nice precise formulas instead of wrangling new columns, but it looks like it won't be quite so simple.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Renaming-our-output-fields">Renaming our output fields<a class="anchor-link" href="#Renaming-our-output-fields">#</a></h1><p>But don't worry: even if we love the formula method, <strong>we don't have to suffer through those results.</strong></p>
<p>Yes, we can understand the columns, but it's a lot of work to really read what's going on. Life would be much nicer if <code>C(applicant_race, Treatment('white'))[T.latino]</code> were just <code>applicant_race_latino</code>. You'd have to remember what the reference category is, but if we think we can handle it, let's head onward.</p>
<p>While statsmodels doesn't make it easy, it's definitely possible to reach in and rename our features. <strong>We do it like this:</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Copy the names to a pd.Series for easy search/replace</span>
<span class="c1"># We&#39;ll also keep a safe copy to make double-checking easy later</span>
<span class="n">names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">xnames</span><span class="p">)</span>
<span class="n">originals</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">names</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

<span class="c1"># Reformat &#39;C(agency_code, Treatment(&#39;FDIC&#39;))[T.FRS]&#39; as &#39;agency_code_FRS&#39;</span>
<span class="n">names</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;, ?Treatment\(.*\)&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">names</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;C\(([\w]+)&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;\1_&quot;</span><span class="p">)</span>
<span class="n">names</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\[T.(.*)\]&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;\1&quot;</span><span class="p">)</span>

<span class="c1"># Manually replace other ones</span>
<span class="n">names</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span>
    <span class="s1">&#39;np.multiply(pop_hispanic / pop_total, 100)&#39;</span><span class="p">:</span> <span class="s1">&#39;pop_hispanic&#39;</span><span class="p">,</span>
    <span class="s1">&#39;np.multiply(pop_black / pop_total, 100)&#39;</span><span class="p">:</span> <span class="s1">&#39;pop_black&#39;</span><span class="p">,</span>
    <span class="s1">&#39;np.multiply(pop_amer_indian / pop_total, 100)&#39;</span><span class="p">:</span> <span class="s1">&#39;pop_amer_indian&#39;</span><span class="p">,</span>
    <span class="s1">&#39;np.multiply(pop_asian / pop_total, 100)&#39;</span><span class="p">:</span> <span class="s1">&#39;pct_asian&#39;</span><span class="p">,</span>
    <span class="s1">&#39;np.multiply(pop_pac_islander / pop_total, 100)&#39;</span><span class="p">:</span> <span class="s1">&#39;pop_pac_islander&#39;</span><span class="p">,</span>
    <span class="s1">&#39;np.log(income)&#39;</span><span class="p">:</span> <span class="s1">&#39;log_income&#39;</span><span class="p">,</span>
    <span class="s1">&#39;np.log(loan_amount)&#39;</span><span class="p">:</span> <span class="s1">&#39;log_loan&#39;</span><span class="p">,</span>
    <span class="s1">&#39;np.divide(loan_amount, income)&#39;</span><span class="p">:</span> <span class="s1">&#39;loan_income_ratio&#39;</span><span class="p">,</span>    
<span class="p">})</span>

<span class="n">original_names</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">xnames</span>
<span class="c1"># Assign back into the model for display</span>
<span class="n">model</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">xnames</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>

<span class="c1"># Redo our summary, and we get nice output!</span>
<span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<table class="simpletable">
<caption>Logit Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>      <td>loan_denied</td>   <th>  No. Observations:  </th>   <td> 10107</td>  
</tr>
<tr>
  <th>Model:</th>                 <td>Logit</td>      <th>  Df Residuals:      </th>   <td> 10082</td>  
</tr>
<tr>
  <th>Method:</th>                 <td>MLE</td>       <th>  Df Model:          </th>   <td>    24</td>  
</tr>
<tr>
  <th>Date:</th>            <td>Tue, 05 Nov 2019</td> <th>  Pseudo R-squ.:     </th>   <td>0.09749</td> 
</tr>
<tr>
  <th>Time:</th>                <td>12:39:26</td>     <th>  Log-Likelihood:    </th>  <td> -3375.9</td> 
</tr>
<tr>
  <th>converged:</th>             <td>True</td>       <th>  LL-Null:           </th>  <td> -3740.6</td> 
</tr>
<tr>
  <th>Covariance Type:</th>     <td>nonrobust</td>    <th>  LLR p-value:       </th> <td>1.629e-138</td>
</tr>
</table>
<table class="simpletable">
<tr>
               <td></td>                  <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>                   <td>   -0.6024</td> <td>    0.306</td> <td>   -1.971</td> <td> 0.049</td> <td>   -1.202</td> <td>   -0.003</td>
</tr>
<tr>
  <th>co_applicant_unknown</th>        <td>    0.3957</td> <td>    0.207</td> <td>    1.914</td> <td> 0.056</td> <td>   -0.010</td> <td>    0.801</td>
</tr>
<tr>
  <th>co_applicant_yes</th>            <td>   -0.0958</td> <td>    0.078</td> <td>   -1.222</td> <td> 0.222</td> <td>   -0.249</td> <td>    0.058</td>
</tr>
<tr>
  <th>applicant_sex_male</th>          <td>    0.1213</td> <td>    0.070</td> <td>    1.722</td> <td> 0.085</td> <td>   -0.017</td> <td>    0.259</td>
</tr>
<tr>
  <th>applicant_sex_na</th>            <td>   -0.1091</td> <td>    0.176</td> <td>   -0.618</td> <td> 0.537</td> <td>   -0.455</td> <td>    0.237</td>
</tr>
<tr>
  <th>applicant_race_asian</th>        <td>    0.3783</td> <td>    0.105</td> <td>    3.595</td> <td> 0.000</td> <td>    0.172</td> <td>    0.584</td>
</tr>
<tr>
  <th>applicant_race_black</th>        <td>    0.7496</td> <td>    0.115</td> <td>    6.506</td> <td> 0.000</td> <td>    0.524</td> <td>    0.975</td>
</tr>
<tr>
  <th>applicant_race_hawaiian</th>     <td>    1.0989</td> <td>    0.464</td> <td>    2.368</td> <td> 0.018</td> <td>    0.189</td> <td>    2.008</td>
</tr>
<tr>
  <th>applicant_race_latino</th>       <td>    0.3232</td> <td>    0.164</td> <td>    1.970</td> <td> 0.049</td> <td>    0.002</td> <td>    0.645</td>
</tr>
<tr>
  <th>applicant_race_na</th>           <td>    0.4511</td> <td>    0.119</td> <td>    3.798</td> <td> 0.000</td> <td>    0.218</td> <td>    0.684</td>
</tr>
<tr>
  <th>applicant_race_native_amer</th>  <td>    1.0546</td> <td>    0.591</td> <td>    1.785</td> <td> 0.074</td> <td>   -0.103</td> <td>    2.213</td>
</tr>
<tr>
  <th>agency_code_CFPB</th>            <td>    1.1066</td> <td>    0.136</td> <td>    8.158</td> <td> 0.000</td> <td>    0.841</td> <td>    1.372</td>
</tr>
<tr>
  <th>agency_code_FRS</th>             <td>   -0.1133</td> <td>    0.221</td> <td>   -0.513</td> <td> 0.608</td> <td>   -0.546</td> <td>    0.319</td>
</tr>
<tr>
  <th>agency_code_HUD</th>             <td>    0.1170</td> <td>    0.140</td> <td>    0.837</td> <td> 0.402</td> <td>   -0.157</td> <td>    0.391</td>
</tr>
<tr>
  <th>agency_code_NCUA</th>            <td>    1.3009</td> <td>    0.153</td> <td>    8.507</td> <td> 0.000</td> <td>    1.001</td> <td>    1.601</td>
</tr>
<tr>
  <th>agency_code_OCC</th>             <td>    0.3160</td> <td>    0.201</td> <td>    1.575</td> <td> 0.115</td> <td>   -0.077</td> <td>    0.709</td>
</tr>
<tr>
  <th>tract_to_msa_income_percent</th> <td>    0.0017</td> <td>    0.001</td> <td>    2.627</td> <td> 0.009</td> <td>    0.000</td> <td>    0.003</td>
</tr>
<tr>
  <th>log_income</th>                  <td>   -0.3555</td> <td>    0.070</td> <td>   -5.104</td> <td> 0.000</td> <td>   -0.492</td> <td>   -0.219</td>
</tr>
<tr>
  <th>log_loan</th>                    <td>   -0.2283</td> <td>    0.056</td> <td>   -4.060</td> <td> 0.000</td> <td>   -0.338</td> <td>   -0.118</td>
</tr>
<tr>
  <th>loan_income_ratio</th>           <td>    0.0110</td> <td>    0.007</td> <td>    1.476</td> <td> 0.140</td> <td>   -0.004</td> <td>    0.026</td>
</tr>
<tr>
  <th>pop_hispanic</th>                <td>    0.0072</td> <td>    0.004</td> <td>    2.050</td> <td> 0.040</td> <td>    0.000</td> <td>    0.014</td>
</tr>
<tr>
  <th>pop_black</th>                   <td>    0.0062</td> <td>    0.002</td> <td>    3.884</td> <td> 0.000</td> <td>    0.003</td> <td>    0.009</td>
</tr>
<tr>
  <th>pop_amer_indian</th>             <td>   -0.2571</td> <td>    0.097</td> <td>   -2.652</td> <td> 0.008</td> <td>   -0.447</td> <td>   -0.067</td>
</tr>
<tr>
  <th>pct_asian</th>                   <td>    0.0107</td> <td>    0.004</td> <td>    2.427</td> <td> 0.015</td> <td>    0.002</td> <td>    0.019</td>
</tr>
<tr>
  <th>pop_pac_islander</th>            <td>    0.0904</td> <td>    0.159</td> <td>    0.568</td> <td> 0.570</td> <td>   -0.221</td> <td>    0.402</td>
</tr>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Everything still works great! We can rebuild our coefficient/odds ratio/p-value situation without any trouble at all.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">feature_names</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">index</span>
<span class="n">coefficients</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">values</span>

<span class="n">coefs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;coef&#39;</span><span class="p">:</span> <span class="n">coefficients</span><span class="p">,</span>
    <span class="s1">&#39;odds ratio&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
    <span class="s1">&#39;pvalue&#39;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">pvalues</span><span class="p">,</span>
    <span class="s1">&#39;original&#39;</span><span class="p">:</span> <span class="n">originals</span>
<span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;odds ratio&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">coefs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>coef</th>
      <th>odds ratio</th>
      <th>pvalue</th>
      <th>original</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>agency_code_NCUA</th>
      <td>1.30091</td>
      <td>3.67262</td>
      <td>0.00000</td>
      <td>C(agency_code, Treatment('FDIC'))[T.NCUA]</td>
    </tr>
    <tr>
      <th>agency_code_CFPB</th>
      <td>1.10661</td>
      <td>3.02410</td>
      <td>0.00000</td>
      <td>C(agency_code, Treatment('FDIC'))[T.CFPB]</td>
    </tr>
    <tr>
      <th>applicant_race_hawaiian</th>
      <td>1.09891</td>
      <td>3.00090</td>
      <td>0.01787</td>
      <td>C(applicant_race, Treatment('white'))[T.hawaiian]</td>
    </tr>
    <tr>
      <th>applicant_race_native_amer</th>
      <td>1.05461</td>
      <td>2.87087</td>
      <td>0.07426</td>
      <td>C(applicant_race, Treatment('white'))[T.native...</td>
    </tr>
    <tr>
      <th>applicant_race_black</th>
      <td>0.74963</td>
      <td>2.11622</td>
      <td>0.00000</td>
      <td>C(applicant_race, Treatment('white'))[T.black]</td>
    </tr>
    <tr>
      <th>applicant_race_na</th>
      <td>0.45112</td>
      <td>1.57007</td>
      <td>0.00015</td>
      <td>C(applicant_race, Treatment('white'))[T.na]</td>
    </tr>
    <tr>
      <th>co_applicant_unknown</th>
      <td>0.39570</td>
      <td>1.48543</td>
      <td>0.05568</td>
      <td>C(co_applicant, Treatment('no'))[T.unknown]</td>
    </tr>
    <tr>
      <th>applicant_race_asian</th>
      <td>0.37826</td>
      <td>1.45974</td>
      <td>0.00032</td>
      <td>C(applicant_race, Treatment('white'))[T.asian]</td>
    </tr>
    <tr>
      <th>applicant_race_latino</th>
      <td>0.32318</td>
      <td>1.38151</td>
      <td>0.04881</td>
      <td>C(applicant_race, Treatment('white'))[T.latino]</td>
    </tr>
    <tr>
      <th>agency_code_OCC</th>
      <td>0.31598</td>
      <td>1.37160</td>
      <td>0.11521</td>
      <td>C(agency_code, Treatment('FDIC'))[T.OCC]</td>
    </tr>
    <tr>
      <th>applicant_sex_male</th>
      <td>0.12133</td>
      <td>1.12900</td>
      <td>0.08514</td>
      <td>C(applicant_sex, Treatment('female'))[T.male]</td>
    </tr>
    <tr>
      <th>agency_code_HUD</th>
      <td>0.11701</td>
      <td>1.12413</td>
      <td>0.40245</td>
      <td>C(agency_code, Treatment('FDIC'))[T.HUD]</td>
    </tr>
    <tr>
      <th>pop_pac_islander</th>
      <td>0.09038</td>
      <td>1.09459</td>
      <td>0.56988</td>
      <td>np.multiply(pop_pac_islander / pop_total, 100)</td>
    </tr>
    <tr>
      <th>loan_income_ratio</th>
      <td>0.01096</td>
      <td>1.01102</td>
      <td>0.13984</td>
      <td>np.divide(loan_amount, income)</td>
    </tr>
    <tr>
      <th>pct_asian</th>
      <td>0.01069</td>
      <td>1.01074</td>
      <td>0.01522</td>
      <td>np.multiply(pop_asian / pop_total, 100)</td>
    </tr>
    <tr>
      <th>pop_hispanic</th>
      <td>0.00719</td>
      <td>1.00721</td>
      <td>0.04041</td>
      <td>np.multiply(pop_hispanic / pop_total, 100)</td>
    </tr>
    <tr>
      <th>pop_black</th>
      <td>0.00623</td>
      <td>1.00625</td>
      <td>0.00010</td>
      <td>np.multiply(pop_black / pop_total, 100)</td>
    </tr>
    <tr>
      <th>tract_to_msa_income_percent</th>
      <td>0.00175</td>
      <td>1.00175</td>
      <td>0.00862</td>
      <td>tract_to_msa_income_percent</td>
    </tr>
    <tr>
      <th>co_applicant_yes</th>
      <td>-0.09583</td>
      <td>0.90862</td>
      <td>0.22154</td>
      <td>C(co_applicant, Treatment('no'))[T.yes]</td>
    </tr>
    <tr>
      <th>applicant_sex_na</th>
      <td>-0.10905</td>
      <td>0.89668</td>
      <td>0.53657</td>
      <td>C(applicant_sex, Treatment('female'))[T.na]</td>
    </tr>
    <tr>
      <th>agency_code_FRS</th>
      <td>-0.11333</td>
      <td>0.89285</td>
      <td>0.60766</td>
      <td>C(agency_code, Treatment('FDIC'))[T.FRS]</td>
    </tr>
    <tr>
      <th>log_loan</th>
      <td>-0.22825</td>
      <td>0.79592</td>
      <td>0.00005</td>
      <td>np.log(loan_amount)</td>
    </tr>
    <tr>
      <th>pop_amer_indian</th>
      <td>-0.25706</td>
      <td>0.77332</td>
      <td>0.00801</td>
      <td>np.multiply(pop_amer_indian / pop_total, 100)</td>
    </tr>
    <tr>
      <th>log_income</th>
      <td>-0.35546</td>
      <td>0.70085</td>
      <td>0.00000</td>
      <td>np.log(income)</td>
    </tr>
    <tr>
      <th>Intercept</th>
      <td>-0.60242</td>
      <td>0.54748</td>
      <td>0.04874</td>
      <td>Intercept</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Interpreting-and-thinking-about-the-analysis">Interpreting and thinking about the analysis<a class="anchor-link" href="#Interpreting-and-thinking-about-the-analysis">#</a></h1><h3 id="Question-1">Question 1<a class="anchor-link" href="#Question-1">#</a></h3><p>Our results aren't exactly the same as Reveal's, as I pulled a slightly different number of rows from the database and I'm not sure what exact dataset they used for census information. How are we feeling about this reproduction? <strong>You might want check their 2015 results in the whitepaper.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># I mean come on it&#39;s pretty close</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Question-2">Question 2<a class="anchor-link" href="#Question-2">#</a></h3><p>In the opening paragraph to the flagship piece, <a href="https://www.revealnews.org/article/for-people-of-color-banks-are-shutting-the-door-to-homeownership/">Aaron and Emmanuel write</a>:</p>
<blockquote><p>Fifty years after the federal Fair Housing Act banned racial discrimination in lending, African Americans and Latinos continue to be routinely denied conventional mortgage loans at rates far higher than their white counterparts.</p>
</blockquote>
<p>If you look at the results, Hawaiians/Pacific Islanders (and maybe Native Americans) have an even higher odds ratio. <strong>Why do they choose to talk about African Americans and Latinos instead?</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Not nearly as many of those two groups</span>
<span class="c1"># And I mean like REALLY not that many</span>
<span class="n">train_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s2">&quot;pct_hispanic&quot;</span><span class="p">:</span><span class="s2">&quot;pct_pac_islander&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>pct_hispanic        3.831509
pct_black           7.453754
pct_amer_indian     0.000000
pct_asian           5.071502
pct_pac_islander    0.000000
dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Question-3">Question 3<a class="anchor-link" href="#Question-3">#</a></h3><p>Write a sentence expressing the meaning of the <strong>odds ratio</strong> statistic for Black mortgage applicants. Find a line in <a href="https://www.revealnews.org/article/for-people-of-color-banks-are-shutting-the-door-to-homeownership/">the Reveal piece</a> where they use the odds ratio.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># “I had a fair amount of savings and still had so much trouble just left and</span>
<span class="c1"># right,” said Rachelle Faroul, a 33-year-old black woman who was rejected twice</span>
<span class="c1"># by lenders when she tried to buy a brick row house close to Malcolm X Park in</span>
<span class="c1"># Philadelphia, where Reveal found African Americans were 2.7 times as likely as</span>
<span class="c1"># whites to be denied a conventional mortgage.</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Question-4">Question 4<a class="anchor-link" href="#Question-4">#</a></h3><p>Write a similar sentence about men.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Men are 12% more likely to be denied a conventional mortgage</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Question-5">Question 5<a class="anchor-link" href="#Question-5">#</a></h3><p>Why did Aaron and Emmanuel choose to include the loan-to-income ratio statistic? <strong>You might want to read the whitepaper.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Loan-to-income ratio: Looking at the raw numbers of an applicant’s income and</span>
<span class="c1"># loan amount doesn’t tell the whole picture. We needed to look at how much money</span>
<span class="c1"># applicants wanted to take out in relation to their income. This provides a proxy</span>
<span class="c1"># for whether or not the loan amount was manageable compared with the applicant’s income.</span>
<span class="c1"># Experts agreed that this variable should be included.</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Question-6">Question 6<a class="anchor-link" href="#Question-6">#</a></h3><p>Credit score is a common reason why loans are denied. Why are credit scores not included in our analysis? <strong>You might want to read the whitepaper.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># They aren&#39;t available!</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Question-7">Question 7<a class="anchor-link" href="#Question-7">#</a></h3><p>This data was just sitting out there for anyone to look at, they didn't even need to FOIA it. Why do you think this issue had not come up before Reveal's analysis?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># This is just an opinion! but I asked them:</span>
<span class="c1"># emmanuel - the data is just so big</span>
<span class="c1"># aaron - it&#39;s a blind spot of journalism, business press only writes about profit</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Question-8">Question 8<a class="anchor-link" href="#Question-8">#</a></h3><p>As a result of this series, <a href="https://www.revealnews.org/blog/we-exposed-modern-day-redlining-in-61-cities-find-out-whats-happened-since/">a lot has happened</a>, although <a href="https://www.revealnews.org/blog/cfpb-moves-to-limit-home-loan-data/">recent changes don't look so good</a>. If you were reporting this story, what groups of people would you want to talk to in order to make sure you're getting the story right?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># aaron and emmanuel talked to experts in research, along with enforcement officers and others at CFPB</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Question-9">Question 9<a class="anchor-link" href="#Question-9">#</a></h3><p>When they were consulting experts, Aaron and Emmanuel received a lot of conflicting accounts about whether they should include the "N/A" values for race (they ended up including it). If the experts disagreed about something like that, why do you think they went forward with their analysis?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Experts will rarely agree, it eventually comes down to editorial judgment. There&#39;s not always</span>
<span class="c1"># a very clear delineation of right/wrong</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Question-10">Question 10<a class="anchor-link" href="#Question-10">#</a></h3><p>What if we were working on this story, and our logistic regression or input dataset were flawed? What would be the repercussions?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># We would be making pretty big claims that weren&#39;t backed up - it wouldn&#39;t just be us having</span>
<span class="c1"># to research more, it would be us actually staking our credibility on the line</span>
</pre></div>

    </div>
</div>
</div>

</div>
 


    </div>
  </div>
</div>

<script>
  [...document.querySelectorAll(".code_cell")].filter(cell => cell.innerText.trim().length === 0).forEach(cell => cell.remove())
</script>

  <div class="footer bg-secondary">
  <div class="content">
    <div class="columns">
      <div class="column col-6 col-sm-12">
        <p><strong>Hi, welcome to Data Science for Journalism!</strong></p>
        <p>There's been a lot of buzz about machine learning and "artificial intelligence" being used in stories over
          the past few years. It's mostly not that complicated - a little stats, a classifier here or there - but it's
          hard to know where to start without a little help.</p>
        <p>Hopefully this site can be that help! <a href="/ds4j/about">Learn more about this project here.</a></p>
      </div>
      <div class="column col-3 col-sm-6">
        <p><strong>Quick links</strong></p>
        <!-- <p><a href="#">Something here</a></p>
        <p><a href="#">Something here</a></p>
        <p><a href="#">Something here</a></p> -->
      </div>
      <div class="column col-3 col-sm6">
        <p><strong>Contact</strong></p>
        <p><a href="mailto:hello@littlecolumns.com">hello@littlecolumns.com</a></p>
      </div>
    </div>
  </div>
</div>
  <script src="/ds4j/js/tocbot.js"></script>

  <script>
    try {
      let toc = document.createElement("div")
      toc.setAttribute('class', 'js-toc')
      document.querySelector(".reading-options").parentNode.appendChild(toc)
    } catch (err) {

    }

    tocbot.init({
      // Where to render the table of contents.
      tocSelector: '.js-toc',
      // Where to grab the headings to build the table of contents.
      contentSelector: '.notebook',
      // Which headings to grab inside of the contentSelector element.
      headingSelector: 'h1, h2, h3, h4',
      activeLinkClass: 'active',
      listClass: 'nav',
      listItemClass: 'nav-item',
      headingLabelCallback: function (label) {
        return label.replace("#", "")
      }
    });
  </script>

</body>

</html>